(function(t){function e(e){for(var i,a,r=e[0],l=e[1],c=e[2],d=0,u=[];d<r.length;d++)a=r[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&u.push(o[a][0]),o[a]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);h&&h(e);while(u.length)u.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],i=!0,a=1;a<n.length;a++){var r=n[a];0!==o[r]&&(i=!1)}i&&(s.splice(e--,1),t=l(l.s=n[0]))}return t}var i={},a={app:0},o={app:0},s=[];function r(t){return l.p+"static/js/"+({}[t]||t)+"."+{"chunk-2d22d746":"3e7dac2f","chunk-928ee46e":"d1a3115f"}[t]+".js"}function l(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.e=function(t){var e=[],n={"chunk-928ee46e":1};a[t]?e.push(a[t]):0!==a[t]&&n[t]&&e.push(a[t]=new Promise((function(e,n){for(var i="static/css/"+({}[t]||t)+"."+{"chunk-2d22d746":"31d6cfe0","chunk-928ee46e":"d1417cf6"}[t]+".css",o=l.p+i,s=document.getElementsByTagName("link"),r=0;r<s.length;r++){var c=s[r],d=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(d===i||d===o))return e()}var u=document.getElementsByTagName("style");for(r=0;r<u.length;r++){c=u[r],d=c.getAttribute("data-href");if(d===i||d===o)return e()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=e,h.onerror=function(e){var i=e&&e.target&&e.target.src||o,s=new Error("Loading CSS chunk "+t+" failed.\n("+i+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=i,delete a[t],h.parentNode.removeChild(h),n(s)},h.href=o;var v=document.getElementsByTagName("head")[0];v.appendChild(h)})).then((function(){a[t]=0})));var i=o[t];if(0!==i)if(i)e.push(i[2]);else{var s=new Promise((function(e,n){i=o[t]=[e,n]}));e.push(i[2]=s);var c,d=document.createElement("script");d.charset="utf-8",d.timeout=120,l.nc&&d.setAttribute("nonce",l.nc),d.src=r(t);var u=new Error;c=function(e){d.onerror=d.onload=null,clearTimeout(h);var n=o[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",u.name="ChunkLoadError",u.type=i,u.request=a,n[1](u)}o[t]=void 0}};var h=setTimeout((function(){c({type:"timeout",target:d})}),12e4);d.onerror=d.onload=c,document.head.appendChild(d)}return Promise.all(e)},l.m=t,l.c=i,l.d=function(t,e,n){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)l.d(n,i,function(e){return t[e]}.bind(null,i));return n},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/",l.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],d=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var h=d;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"167a":function(t,e,n){"use strict";n("6c7b"),n("ac6a"),n("7f7f"),n("6762"),n("2fdb"),n("c7c6");var i=n("aa78"),a=n.n(i),o=function(t,e){var n=this.instance;switch(t){case"keyDown":32===e.keyCode&&(this.drawer_panning=!0,n.set_canvas_pan(!0),null!=n.currently_drawing&&(n.currently_drawing._enabled=!1));break;case"keyUp":13===e.keyCode&&(n.set_canvas_pan(!0),n.currently_drawing.points=r(n.currently_drawing.points),n.callback.onFinishNewDrawing(n.currently_drawing),n.currently_drawing=null,n.stateRestorer.cancel()),32===e.keyCode&&(this.drawer_panning=!1,n.set_canvas_pan(!1)),27===e.keyCode&&(r(n.currently_drawing.points),n.currently_drawing=null,n.stateRestorer.cancel(),n.set_canvas_pan(!0));break}},s=function(t,e,n){var i=(e.y-t.y)/(e.x-t.x),a=(n.y-e.y)/(n.x-e.x),o=t.x*i-t.y,s=n.x*a-n.y;return[{slope:i,b:o},{slope:a,b:s}]},r=function(t){var e=[];do{console.log("New iteration"),e=[];for(var n=1;n<t.length-1;n++){var i=t[n-1],a=t[n],o=t[n+1],r=s(i,a,o);r[0].slope===r[1].slope&&r[0].b===r[1].b&&e.push(n)}for(var l=1;l<t.length;l++){var c=t[l-1],d=t[l],u=Math.hypot(c.x-d.x,c.y-d.y);u<3&&e.push(l)}console.log(e.length,"points removed from",t.length,"("+e.length/t.length*100+"%)"),console.log("Size (before): ",t.length),t=t.filter((function(t,n){return!e.includes(n)})),console.log("Size (after): ",t.length)}while(0!==e.length);return t},l={name:"None",mouseEvent:function(t,e){},keyboardEvent:function(t,e){},init:function(t){return this}},c={name:"polygon",instance:null,info:function(){for(var t=[],e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.includes("start")&&t.push("[db-Click] To put the first point"),n.includes("start-2")&&t.push("[db-Click] To put the second point"),n.includes("save")&&t.push("[Enter] To save annotation"),n.includes("undo")&&t.push("[Esc] To undo"),n.includes("continue")&&t.push("[Click] To continue dragging"),n.includes("point")&&t.push("[db-Click] To add a point"),n.includes("cancel")&&t.push("[Esc] To cancel"),this.instance.callback.onInfoUpdate(t)},mouseEvent:function(t,e){var n=this.instance,i=n._mousePointToImagePoint(e.position);switch(t){case"dblClick":null==n.currently_drawing?(n.currently_drawing={type:"polygon",points:[i,i],is_hover:!1,path:null,color:n.drawing_color},n.stateRestorer=g.init(n,n.currently_drawing),this.info("start-2","cancel")):(n.currently_drawing.points.push(i),n.stateRestorer.addRestorePoint("point"),this.info("save","undo","point"));break;case"move":null!=n.currently_drawing&&(n.currently_drawing.points[n.currently_drawing.points.length-1]=i,n.update());break}},keyboardEvent:function(t,e){var n=this.instance;if(null!=n.currently_drawing)switch(t){case"keyUp":13===e.keyCode&&(n.currently_drawing.points.pop(),n.callback.onFinishNewDrawing(n.currently_drawing),n.currently_drawing=null,n.stateRestorer.cancel(),this.info("")),27===e.keyCode&&(n.currently_drawing.points.length>3?(n.currently_drawing.points.splice(n.currently_drawing.points.length-2,1),this.info("save","point",n.currently_drawing.points.length>3?"undo":"cancel")):(n.currently_drawing=null,n.stateRestorer.cancel(),this.info("")),n.update());break}},init:function(t){return this.instance=t,this.info("start"),this}},d={name:"rect",instance:null,info:function(){for(var t=[],e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.includes("start")&&t.push("[db-Click] To start rect"),n.includes("save")&&t.push("[db-Click] To finish and save"),n.includes("cancel")&&t.push("[Esc] To cancel"),this.instance.callback.onInfoUpdate(t)},mouseEvent:function(t,e){var n=this.instance,i=n._mousePointToImagePoint(e.position);switch(t){case"dblClick":null==n.currently_drawing?(n.currently_drawing={type:this.name,points:[i,i],is_hover:!1,color:n.drawing_color},this.info("save","cancel")):(["x","y"].map((function(t){if(n.currently_drawing.points[0][t]>n.currently_drawing.points[1][t]){var e=n.currently_drawing.points[0][t];n.currently_drawing.points[0][t]=n.currently_drawing.points[1][t],n.currently_drawing.points[1][t]=e}})),n.callback.onFinishNewDrawing(n.currently_drawing),n.currently_drawing=null,n.stateRestorer.cancel(),this.info("start")),n.update();break;case"move":null!=n.currently_drawing&&(n.currently_drawing.points[1]=i,n.update());break}},keyboardEvent:function(t,e){var n=this.instance;switch(t){case"keyUp":27===e.keyCode&&(n.currently_drawing=null,n.update(),this.info("start"));break}},init:function(t){return this.instance=t,this.info("start"),this}},u={name:"free",instance:null,drawer_panning:!1,info:function(){for(var t=[],e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.includes("pan")&&t.push("[Space] To drag the image"),n.includes("start")&&t.push("[Click] To start drawing"),n.includes("save")&&t.push("[Enter] To save annotation"),n.includes("continue")&&t.push("[Click] To continue drawing"),n.includes("cancel")&&t.push("[Esc] To cancel"),this.instance.callback.onInfoUpdate(t)},mouseEvent:function(t,e){var n=this.instance,i=n._mousePointToImagePoint(e.position);switch(t){case"press":n.set_canvas_pan(!1),this.drawer_panning||(null==n.currently_drawing?(n.currently_drawing={type:"polygon",points:[i],is_hover:!1,path:null,color:n.drawing_color,_enabled:!0},n.stateRestorer=g.init(n,n.currently_drawing)):n.currently_drawing._enabled=!0,this.info("pan"));break;case"move":!this.drawer_panning&&null!=n.currently_drawing&&n.currently_drawing._enabled&&(n.currently_drawing.points.push(i),n.stateRestorer.addRestorePoint("point"));break;case"release":null!=n.currently_drawing&&(n.currently_drawing._enabled=!1),this.info("continue","pan","save","cancel");break}n.update()},keyboardEvent:o,init:function(t){return this.instance=t,t.set_canvas_pan(!1),this.info("start","pan"),this}},h={name:"brush",instance:null,size:500,drawer_panning:!1,mouseEvent:function(t,e){var n=this.instance,i=n._mousePointToImagePoint(e.position);switch(t){case"press":if(this.drawer_panning)return;n.set_canvas_pan(!1),null==n.currently_drawing&&(n.currently_drawing={type:"brush",size:this.size,is_hover:!1,points:[i],color:n.drawing_color,_enabled:!0});break;case"move":!this.drawer_panning&&null!=n.currently_drawing&&n.currently_drawing._enabled&&n.currently_drawing.points.push(i);break;case"release":null!=n.currently_drawing&&(n.currently_drawing._enabled=!1),n.set_canvas_pan(!0);break}n.update()},keyboardEvent:o,init:function(t){return this.instance=t,t.set_canvas_pan(!1),this}},v={editor:null,active:!1,mouseEvent:function(t,e){var n=this.editor,i=n.instance;switch(t){case"press":this.active=!0,i.set_canvas_pan(!1);break;case"release":this.active=!1,i.set_canvas_pan(!0);break;case"move":if(!0===this.active){var a=i._mousePointToImagePoint(e.position);n.controls.some((function(t){if(n.intersectsControl(a,t.point)){var e=n.element.points.indexOf(t.point);return n.element.points.splice(e,1),n.controls.splice(e,1),n.addRestorePoint("erased"),!0}})),i.update()}break}},init:function(t){return this.editor=t,this}},p={editor:null,control:null,mouseEvent:function(t,e){var n=this,i=this.editor,a=i.instance;switch(t){case"press":var o=a._mousePointToImagePoint(e.position);i.controls.forEach((function(t){var e=t.point,s=i.intersectsControl(o,e);s&&(n.control=t,a.set_canvas_pan(!1))}));break;case"release":this.control=null,a.set_canvas_pan(!0),i.addRestorePoint("moved");break;case"move":if(null!=this.control){var s=a._mousePointToImagePoint(e.position);this.control.point.x=s.x,this.control.point.y=s.y,a.update()}break}},init:function(t){return this.editor=t,this}},f={editor:null,cursor:null,instance:null,checkPathCreation:function(t){for(var e=this.editor.element.points,n=1;n<e.length;n++){var i=e[n-1],a=e[n],o=Math.min(i.x,a.x)-10,s=Math.max(i.x,a.x)+10,r=Math.min(i.y,a.y)-10,l=Math.max(i.y,a.y)+10;if(o<t.x&&t.x<s&&r<t.y&&t.y<l)return n}return null},mouseEvent:function(t,e){var n=this.editor,i=n.instance,a=i._mousePointToImagePoint(e.position);switch(t){case"move":if(i.ctx.isPointInPath(n.element.path,e.position.x,e.position.y)){var o=this.checkPathCreation(a);this.cursor=null!=o?{position:a,index:o}:null,i.update()}else null!=this.cursor&&(this.cursor=null,i.update());break;case"click":if(i.ctx.isPointInPath(n.element.path,e.position.x,e.position.y)){var s=n.element.points,r=this.checkPathCreation(a);null!=r&&(n.addRestorePoint("created"),s.splice(r,0,a)),console.log("Ended"),n.create_controls(),i.update()}break}},draw:function(t){var e=this.instance;if(t.beginPath(),null!=this.cursor){var n=this.editor.element.points,i=e._imagePointToCanvasPoint(this.cursor.position.x,this.cursor.position.y);t.ellipse(i.x,i.y,5,5,0,2*Math.PI,0,!1);var a=e._imagePointToCanvasPoint(n[this.cursor.index-1].x,n[this.cursor.index-1].y),o=e._imagePointToCanvasPoint(n[this.cursor.index].x,n[this.cursor.index].y);t.moveTo(a.x,a.y),t.lineTo(i.x,i.y),t.lineTo(o.x,o.y),t.fill(),t.stroke()}},init:function(t){return this.editor=t,this.instance=t.instance,this}},_={currently_drawing:null,current_path:null,editor:null,editing:!1,panning:!1,mouseEvent:function(t,e){var n=this.editor,i=(n.element,n.instance),a=n.instance._mousePointToImagePoint(e.position);switch(t){case"press":null==this.currently_drawing?n.instance.ctx.isPointInPath(n.element.path,e.position.x,e.position.y)&&(this.currently_drawing=[],this.editing=!0,i.set_canvas_pan(!1)):(this.editing=!0,i.set_canvas_pan(!1));break;case"move":if(this.panning)return;null!=this.currently_drawing&&this.editing&&(this.currently_drawing.push(a),n.instance.update());break;case"release":this.editing=!1,i.set_canvas_pan(!0);break}},polygonOrientation:function(t){for(var e=0,n=t.length,i=1;i<n;i++)e+=(t[i].x-t[i-1].x)*(t[i].y+t[i-1].y);return e+=(t[n-1].x-t[n-2].x)*(t[n-1].y+t[n-2].y),e>0},keyboardEvent:function(t,e){var n=this,i=this.editor.instance;switch(t){case"keyUp":if(32===e.keyCode)i.set_canvas_pan(!1),this.panning=!1;else if(27===e.keyCode)i.set_canvas_pan(!0),this.currently_drawing=null,i.update();else if(13===e.keyCode){i.set_canvas_pan(!0);var a=function(t,e){var n=i._imagePointToCanvasPoint(e.x,e.y);return i.ctx.isPointInPath(t,n.x,n.y,"nonzero")},o=this.editor.element.points.map((function(t,e){if(a(n.current_path,t))return e})).filter((function(t){return null!=t})),s=this.currently_drawing.map((function(t,e){if(a(n.editor.element.path,t))return e})).filter((function(t){return null!=t}));console.log("Original To Remove",o,s);var l=this.editor.element.points.filter((function(t,e){return!o.includes(e)})),c=this.currently_drawing.filter((function(t,e){return!s.includes(e)}));console.log("newOriginalPath:",l),console.log("newAdditionPath:",c);var d=this.polygonOrientation(l),u=this.polygonOrientation(c);console.log("Order:",d,u),u!==d&&console.log("Reversing array");var h=1,v=0,p=[l[0]];do{var f=p[p.length-1],_=l[h],m=c[v],g=h<l.length?Math.hypot(f.x-_.x,f.y-_.y):-1,b=v<c.length?Math.hypot(f.x-m.x,f.y-m.y):-1;if(console.log("Iteration | ",f,h,v,"|",g,b),-1===g&&-1===b)break;-1===b||-1!==g&&g<b?(p.push(_),h++):(-1===g||-1!==b&&g>b)&&(p.push(m),v++)}while(h<l.length||v<c.length);return this.editor.element.points=r(p),this.editor.instance.update(),!1}break;case"keyDown":32===e.keyCode&&(i.set_canvas_pan(!0),this.panning=!0);break}return!0},draw:function(t){var e=this,n=this.currently_drawing;if(null!=n){var i=new Path2D,a=this.editor.instance._imagePointToCanvasPoint(n[0].x,n[0].y);t.beginPath(),i.moveTo(a.x,a.y),n.forEach((function(t){var n=e.editor.instance._imagePointToCanvasPoint(t.x,t.y);i.lineTo(n.x,n.y)})),i.closePath(),this.current_path=i,t.stroke(i)}},init:function(t){return this.editor=t,this.currently_drawing=null,this}},m={element:null,controls:[],instance:null,mode:null,current_history_point:0,history:[],addRestorePoint:function(t){this.history.length>0&&this.current_history_point!==this.history.length-1&&(console.log("clearing future:",this.history.length),this.history.splice(this.current_history_point,this.history.length-this.current_history_point),console.log("clearing future:",this.history.length)),this.history.push({type:t,points:this.element.points.map((function(t){return{x:t.x,y:t.y}}))}),this.current_history_point=this.history.length-1,this.instance.callback.onEditingEvent()},restoreState:function(t){console.log("restoreState",t,this.history),this.element.points=this.history[t].points,this.create_controls(),this.instance.update(),this.current_history_point=t},intersectsControl:function(t,e){var n=this.instance,i=(n._viewportLocation.max.y-n._viewportLocation.min.y)/n.canvas.clientWidth*25;return t.x>e.x-i&&t.x<e.x+i&&t.y>e.y-i&&t.y<e.y+i},mouseEvent:function(t,e){this.mode.mouseEvent(t,e)},keyboardEvent:function(t,e){var n=this.instance;if("function"!==typeof this.mode.keyboardEvent||!this.mode.keyboardEvent(t,e))switch(console.log(t,e),t){case"keyUp":27===e.keyCode?(this.element.points=this.original_points,this.element.color=this.original_color,n.callback.onFinishedEditing(!1,this.element),n.currently_editing=null,n.update()):13===e.keyCode&&(n.callback.onFinishedEditing(!0,this.element),n.currently_editing=null,n.update());break}},cancel:function(){var t=this.instance;this.element.points=this.original_points,this.element.color=this.original_color,t.callback.onFinishedEditing(!1,this.element),t.currently_editing=null,t.update()},draw:function(t){var e=this.instance;t.lineWidth=1,this.controls.forEach((function(n){t.beginPath();var i=e._imagePointToCanvasPoint(n.point.x,n.point.y);t.ellipse(i.x,i.y,5,5,0,2*Math.PI,0,!1),t.fillStyle="rgb(255,255,255)",t.fill(),t.strokeStyle="black",t.stroke(),n._canvas_pos=i})),"function"===typeof this.mode.draw&&this.mode.draw(t)},create_controls:function(){this.controls=this.element.points.map((function(t){return{point:t}}))},create_mode:function(t){"eraser"===t?this.mode=v.init(this):"mover"===t?this.mode=p.init(this):"creator"===t?this.mode=f.init(this):"free"===t&&(this.mode=_.init(this))},init:function(t,e,n){return this.instance=t,this.original_points=e.points.map((function(t){return{x:t.x,y:t.y}})),this.original_color=e.color.map((function(t){return t})),this.element=e,this.create_controls(),this.create_mode(n),this.history=[],this}},g={instance:null,element:null,states:[],current_state_point:0,addRestorePoint:function(t){this.states.length>0&&this.current_state_point!==this.states.length-1&&(this.states.splice(this.current_state_point,this.states.length-this.current_state_point),console.log("clearing future:",this.states.length)),this.states.push({type:t,points:this.element.points.map((function(t){return{x:t.x,y:t.y}}))}),this.current_state_point=this.states.length-1,this.instance.callback.onStateRestorerEvent(this)},restoreToPoint:function(t){console.log("restoreToPoint",t),this.element.points=this.states[t].points,this.instance.update(),this.current_state_point=t,this.instance.callback.onStateRestorerEvent(this)},cancel:function(){this.instance.stateRestorer=null,this.states=null,this.instance.callback.onStateRestorerEvent(null)},init:function(t,e){return this.instance=t,this.element=e,this.states=[],t.callback.onStateRestorerEvent(this),this}};e["a"]={elements:[],enabled:!0,elementsOnScreen:[],stateRestorer:null,set tool(t){this.new_tool=this.tools[t](),console.log("tool: ",t,this.new_tool,this.tools),this.set_canvas_pan(!0),this.viewer.canvas.focus()},get tool(){return null!=this.new_tool?this.new_tool.name:"none"},set editorMode(t){this.currently_editing.create_mode(t),this.viewer.canvas.focus()},get editorMode(){return""},tools:{},default_opacity:.3,filtering:{},currently_editing:null,new_tool:null,currently_drawing:null,drawing_color:[5,173,240],_lastUpdate:0,_viewportLocation:{min:[],max:[]},editElement:function(t){this.currently_editing=m.init(this,t,"mover"),this.update(),this.currently_editing.addRestorePoint("editing")},concludeEdit:function(){console.log("concludeEdit:",this.currently_editing.element),this.callback.onFinishedEditing(!0,this.currently_editing.element),this.currently_editing=null,this.update()},cancelEdit:function(){this.currently_editing.cancel(),this.currently_editing=null,this.update()},resize:function(){this.canvas.width=this.viewer.canvas.clientWidth,this.canvas.height=this.viewer.canvas.clientHeight},_mousePointToImagePoint:function(t){var e=this.viewer.viewport.pointFromPixel(t),n=this.viewer.viewport.viewportToImageCoordinates(e.x,e.y);return{x:n.x,y:n.y}},_imagePointToCanvasPoint:function(t,e){var n=new a.a.Point(t,e);return this.viewer.viewport.imageToViewerElementCoordinates(n)},update:function(){var t=this;if(null!=this.ctx){var e=this.ctx;if(!(this._lastUpdate>Date.now()-this.elementsOnScreen.length/5)&&(e.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),null!=this.elements)){var n=this._viewportLocation.min,i=this._viewportLocation.max;this.elementsOnScreen=[],this.elements.forEach((function(e){if(t.filtering[e.label.name]&&null!=e.data){var a=e.data.points[0];a.x>n.x&&a.x<i.x&&a.y>n.y&&a.y<i.y&&(t._draw_element(e.data),t.elementsOnScreen.push(e))}})),null!=this.currently_drawing&&this._draw_element(this.currently_drawing),null!=this.currently_editing&&this.currently_editing.draw(e),this._lastUpdate=Date.now()}}},_draw_element:function(t){switch(t.type){case"polygon":this._update_polygon(t);break;case"rect":this._update_rect(t);break;case"brush":this._update_brush(t);break}},_update_polygon:function(t){var e=this.ctx,n=t.points,i="".concat(t.color[0],", ").concat(t.color[1],", ").concat(t.color[2]),a=this._update_path(n),o=this._imagePointToCanvasPoint(n[0].x,n[0].y);a.lineTo(o.x,o.y),t.path=a,e.fillStyle="rgba(".concat(i,", ").concat(t.is_hover?"0.6":this.default_opacity,")"),e.fill(a)},_update_rect:function(t){var e=this.ctx,n=this._imagePointToCanvasPoint(t.points[0].x,t.points[0].y),i=this._imagePointToCanvasPoint(t.points[1].x,t.points[1].y),a="".concat(t.color[0],", ").concat(t.color[1],", ").concat(t.color[2]);e.beginPath(),e.rect(n.x,n.y,i.x-n.x,i.y-n.y),t._canvas_points=[n,i],e.fillStyle="rgba(".concat(a,", ").concat(t.is_hover?"0.6":this.default_opacity,")"),e.fill()},_update_path:function(t){var e=this,n=new Path2D,i=this._imagePointToCanvasPoint(t[0].x,t[0].y);return n.moveTo(i.x,i.y),t.forEach((function(t){var i=e._imagePointToCanvasPoint(t.x,t.y);n.lineTo(i.x,i.y)})),n},_update_brush:function(t){var e=this.ctx,n=t.points,i="".concat(t.color[0],", ").concat(t.color[1],", ").concat(t.color[2]);e.lineWidth=this._imagePointToCanvasPoint(t.size,0).x-this._imagePointToCanvasPoint(0,0).x,e.lineCap="round",e.lineJoin="round",e.strokeStyle="rgba(".concat(i,", ").concat(t.is_hover?"0.6":this.default_opacity,")");var a=this._update_path(n);t.path=a,e.stroke(a)},_check_intersects:function(t,e){if("rect"===t.type){var n=t._canvas_points[0],i=t._canvas_points[1];return e.x>n.x&&e.x<i.x&&e.y>n.y&&e.y<i.y}if("polygon"===t.type||"brush"===t.type)return this.ctx.isPointInPath(t.path,e.x,e.y,"nonzero")},set_canvas_pan:function(t){this.viewer.panHorizontal=t,this.viewer.panVertical=t},init:function(t,e){var n=this,i=document.createElement("canvas");i.style.position="absolute",i.style.left=0,i.style.top=0,i.style.width="100%",i.style.height="100%",t.canvas.appendChild(i),this.viewer=t,this.canvas=i,this.callback=e,this.ctx=i.getContext("2d"),this.viewer.addHandler("update-viewport",(function(){var t=n.ctx,e=n.viewer.viewport.windowToImageCoordinates(new a.a.Point(0,0)),i=n.viewer.viewport.windowToImageCoordinates(new a.a.Point(t.canvas.width,t.canvas.height));e.x===n._viewportLocation.min.x&&e.y===n._viewportLocation.min.y&&i.x===n._viewportLocation.max.x&&i.y===n._viewportLocation.max.y||n.update(),n._viewportLocation.max=i,n._viewportLocation.min=e})),this.viewer.addHandler("resize",(function(){n.resize()})),new a.a.MouseTracker({element:this.viewer.canvas,nonPrimaryReleaseHandler:function(t){},releaseHandler:function(t){null==n.currently_editing?n.new_tool.mouseEvent("release",t):n.currently_editing.mouseEvent("release",t)},pressHandler:function(t){null==n.currently_editing?n.new_tool.mouseEvent("press",t):n.currently_editing.mouseEvent("press",t)},clickHandler:function(t){null!=n.currently_editing?n.currently_editing.mouseEvent("click",t):n.elementsOnScreen.forEach((function(t){t.data.is_hover&&n.callback.onClick(t)}))},dblClickHandler:function(t){n.new_tool.mouseEvent("dblClick",t)},moveHandler:function(t){if(null==n.currently_editing){if(n.new_tool.mouseEvent("move",t))return}else if(n.currently_editing.mouseEvent("move",t))return;if(null==n.currently_editing){var i=!1;n.elementsOnScreen.forEach((function(a){var o=a.data,s=n._check_intersects(a.data,t.position),r=o.is_hover!==s;i=i||s&&r||r,r&&(s?e.onHover(a):e.onLeave(a)),o.is_hover=s})),i&&(n.viewer.canvas.style.cursor="hand",n.update())}},keyDownHandler:function(t){null==n.currently_editing?n.new_tool.keyboardEvent("keyDown",t):n.currently_editing.keyboardEvent("keyDown",t)},keyUpHandler:function(t){null==n.currently_editing?n.new_tool.keyboardEvent("keyUp",t):n.currently_editing.keyboardEvent("keyUp",t)}}),this.tools={polygon:function(){return c.init(n)},free:function(){return u.init(n)},rect:function(){return d.init(n)},brush:function(){return h.init(n)},none:function(){return l.init(n)}},this.tool=this.enabled?"polygon":"none",this.resize(t.canvas.width,t.canvas.height)}}},3346:function(t,e,n){},"515a":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{attrs:{id:"seadragon-viewer"}}),t.drawer?n("div",{staticClass:"drawing-tool-container"},[n("div",{staticClass:"tool-item"},[0===t.task_type?n("div",{staticClass:"zoom-shortcuts"},[n("v-menu",{attrs:{top:"","close-on-click":!0,"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({attrs:{text:""}},"v-btn",a,!1),i),[n("v-avatar",{staticClass:"mr-2",attrs:{color:"rgb("+t.selected_label.color[0]+","+t.selected_label.color[1]+","+t.selected_label.color[2]+")",size:"26"}}),t._v("\n              "+t._s(t.selected_label.name)+"\n            ")],1)]}}],null,!1,3417091346)},[n("v-list",t._l(t.labels,(function(e,i){return n("v-list-item",{key:i,on:{click:function(n){t.selected_label=e}}},[n("v-list-item-avatar",[n("v-avatar",{attrs:{color:"rgb("+e.color[0]+","+e.color[1]+","+e.color[2]+")",size:"26"}})],1),n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(e.name))])],1)],1)})),1)],1)],1):t._e(),n("v-divider"),0===t.task_type&&null==t.editing.element?n("div",{staticClass:"zoom-shortcuts"},[n("v-btn",{attrs:{text:"",icon:"",color:"polygon"===this.selected_tool?"primary":"grey"},on:{click:function(e){t.selected_tool="polygon"}}},[n("v-icon",[t._v("mdi-vector-polygon")])],1),n("v-btn",{attrs:{text:"",icon:"",color:"rect"===this.selected_tool?"primary":"grey"},on:{click:function(e){t.selected_tool="rect"}}},[n("v-icon",[t._v("mdi-vector-rectangle")])],1),n("v-btn",{attrs:{text:"",icon:"",color:"free"===this.selected_tool?"primary":"grey"},on:{click:function(e){t.selected_tool="free"}}},[n("v-icon",[t._v("mdi-lead-pencil")])],1),n("v-btn",{attrs:{text:"",icon:"",color:"brush"===this.selected_tool?"primary":"grey"},on:{click:function(e){t.selected_tool="brush"}}},[n("v-icon",[t._v("mdi-brush")])],1)],1):t._e(),null!=t.editing.element?n("div",{staticClass:"zoom-shortcuts"},[n("v-btn",{attrs:{text:"",icon:"",color:"mover"===t.editing.mode?"primary":"grey"},on:{click:function(e){t.editing.mode="mover"}}},[n("v-icon",[t._v("mdi-vector-polyline-edit")])],1),n("v-btn",{attrs:{text:"",icon:"",color:"eraser"===t.editing.mode?"primary":"grey"},on:{click:function(e){t.editing.mode="eraser"}}},[n("v-icon",[t._v("mdi-vector-polyline-minus")])],1),n("v-btn",{attrs:{text:"",icon:"",color:"creator"===t.editing.mode?"primary":"grey"},on:{click:function(e){t.editing.mode="creator"}}},[n("v-icon",[t._v("mdi-vector-polyline-plus")])],1),n("v-btn",{attrs:{text:"",icon:"",color:"free"===t.editing.mode?"primary":"grey"},on:{click:function(e){t.editing.mode="free"}}},[n("v-icon",[t._v("mdi-lead-pencil")])],1)],1):t._e()],1),t.state_restorer.showing?n("div",{staticClass:"tool-item"},[n("v-slider",{attrs:{step:"1",dense:"","hide-details":"",max:t.state_restorer.max_undo,label:"Undo"},model:{value:t.state_restorer.undo,callback:function(e){t.$set(t.state_restorer,"undo",e)},expression:"state_restorer.undo"}})],1):t._e(),t.info.length>0?n("div",{staticClass:"tool-item"},t._l(t.info,(function(e){return n("p",{staticClass:"instruction-item"},[t._v(t._s(e))])})),0):t._e()]):t._e(),n("div",{staticClass:"toolbox navigation-toolbox"},[n("v-slider",{attrs:{"hide-details":"","thumb-label":"",dense:"",max:40,min:"0.5",step:"0"},scopedSlots:t._u([{key:"thumb-label",fn:function(e){var n=e.value;return[t._v("\n        "+t._s(n.toFixed(2))+"\n      ")]}}]),model:{value:t.zoom,callback:function(e){t.zoom=e},expression:"zoom"}}),n("div",{staticClass:"zoom-shortcuts"},[n("v-btn",{attrs:{text:"",icon:""},on:{click:function(e){t.zoom=1}}},[t._v("1x")]),n("v-btn",{attrs:{text:"",icon:""},on:{click:function(e){t.zoom=2}}},[t._v("2x")]),n("v-btn",{attrs:{text:"",icon:""},on:{click:function(e){t.zoom=10}}},[t._v("10x")]),n("v-btn",{attrs:{text:"",icon:""},on:{click:function(e){t.zoom=20}}},[t._v("20x")]),n("v-btn",{attrs:{text:"",icon:""},on:{click:function(e){t.zoom=40}}},[t._v("40x")])],1)],1)])},a=[],o=(n("8e6e"),n("ac6a"),n("456d"),n("c5f6"),n("ade3")),s=n("aa78"),r=n.n(s),l=n("167a");function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(o["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var u={name:"SliceViewer",computed:{task_type:function(){return this.$store.state.session.type}},data:function(){return{selected_label:null,labeled_regions:[],selected_tool:"polygon",editor_tool:"",zoom:0,editing:{element:null,mode:"mover"},state_restorer:{showing:!1,undo:0,max_undo:0},info:[]}},watch:{value:{immediate:!0,handler:function(t){this.labeled_regions=t,l["a"].elements=t,l["a"].update()}},task_type:{immediate:!0,handler:function(t){console.log("task_type",t),l["a"].enabled=0===t}},labels:{immediate:!0,handler:function(t){this.selected_label=t[0]}},labelsVisibility:{immediate:!0,deep:!0,handler:function(t){l["a"].filtering=t,l["a"].update()}},selected_label:{immediate:!0,handler:function(t){l["a"].drawing_color=t.color,null!=this.editing.element&&(this.editing.element.data.color=t.color,l["a"].update())}},selected_tool:function(t){l["a"].tool=t},zoom:function(t){var e=this.viewer;null==e||this.no_model_action||e.viewport.zoomTo(t),this.no_model_action=!1},regionOpacity:function(t){l["a"].default_opacity=t,l["a"].update()},"editing.mode":function(t){l["a"].editorMode=t},"state_restorer.undo":function(t){this.no_model_action||l["a"].stateRestorer.restoreToPoint(t),this.no_model_action=!1},tileSources:function(t){console.log("tileSources: ",t),this.viewer.open(t)}},methods:{editElement:function(t){console.log("editElement",t),this.editing.element=t,this.no_model_action=!0,l["a"].editElement(t.data)},saveEdition:function(t){l["a"].concludeEdit()},cancelEdit:function(){l["a"].cancelEdit()}},mounted:function(){var t=this;console.log("drawEvents:",this.drawEvents),this.$nextTick((function(){var e=r()({id:"seadragon-viewer",tileSources:t.tileSources,showNavigator:!0,navigatorPosition:"BOTTOM_RIGHT",navigatorRight:"16px",navigatorBottom:"16px",navigatorHeight:"120px",navigatorWidth:"145px",showNavigationControl:!1,gestureSettingsMouse:{clickToZoom:!1}}),n=function(t){if(null!=t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];t.apply(void 0,n)}};t.viewer=e,l["a"].init(e,{onHover:function(e){console.log("onHover: ",e),console.log("drawEvents: ",t.drawEvents),n(t.drawEvents.onHover,e)},onLeave:function(e){console.log("onLeave: ",e),n(t.drawEvents.onLeave,e)},onClick:function(e){n(t.drawEvents.onClick,e)},onStateRestorerEvent:function(e){t.no_model_action=!0,null!=e?(t.state_restorer.showing=!0,t.state_restorer.max_undo=e.states.length-1,t.state_restorer.undo=e.current_state_point):t.state_restorer.showing=!1,n(t.drawEvents.onStateRestorerEvent,e)},onEditingEvent:function(){t.no_model_action=!0;var e=l["a"].currently_editing.history.length-1;t.editing.max_undo=e,t.editing.undo=e,n(t.drawEvents.onEditingEvent)},onFinishNewDrawing:function(e){t.$emit("new-draw",{label:t.selected_label,data:e})},onInfoUpdate:function(e){t.info=e},onFinishedEditing:function(e,i){e&&(console.log("data",d(d({},t.editing.element),{},{data:i})),t.$emit("edit-draw",d(d({},t.editing.element),{},{data:i}))),t.editing.element=null,n(t.drawEvents.onFinishedEditing,e,i)}}),t.viewer.addHandler("zoom",(function(e){t.no_model_action=!0,t.zoom=e.zoom})),t.no_model_action=!1}))},props:{drawer:{type:Boolean,default:!0},labels:{type:Array},value:{type:Array},tileSources:{type:String},labelsVisibility:{type:Object},regionOpacity:{type:Number},drawEvents:{}}},h=u,v=(n("e8a8"),n("2877")),p=n("6544"),f=n.n(p),_=n("8212"),m=n("8336"),g=n("ce7e"),b=n("132d"),y=n("8860"),k=n("da13"),w=n("8270"),x=n("5d23"),C=n("e449"),j=n("ba0d"),E=Object(v["a"])(h,i,a,!1,null,"2708342b",null);e["a"]=E.exports;f()(E,{VAvatar:_["a"],VBtn:m["a"],VDivider:g["a"],VIcon:b["a"],VList:y["a"],VListItem:k["a"],VListItemAvatar:w["a"],VListItemContent:x["a"],VListItemTitle:x["b"],VMenu:C["a"],VSlider:j["a"]})},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d"),n("bf40");var i=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("router-view",{attrs:{name:"app_bar"}}),n("v-main",[n("router-view")],1)],1)},o=[],s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",[i("v-row",{staticClass:"text-center"},[i("v-col",{attrs:{cols:"12"}},[i("v-img",{staticClass:"my-3",attrs:{src:n("9b19"),contain:"",height:"200"}})],1),i("v-col",{staticClass:"mb-4"},[i("h1",{staticClass:"display-2 font-weight-bold mb-3"},[t._v("\n        Welcome to Vuetify\n      ")]),i("p",{staticClass:"subheading font-weight-regular"},[t._v("\n        For help and collaboration with other Vuetify developers,\n        "),i("br"),t._v("please join our online\n        "),i("a",{attrs:{href:"https://community.vuetifyjs.com",target:"_blank"}},[t._v("Discord Community")])])]),i("v-col",{staticClass:"mb-5",attrs:{cols:"12"}},[i("h2",{staticClass:"headline font-weight-bold mb-3"},[t._v("\n        What's next?\n      ")]),i("v-row",{attrs:{justify:"center"}},t._l(t.whatsNext,(function(e,n){return i("a",{key:n,staticClass:"subheading mx-3",attrs:{href:e.href,target:"_blank"}},[t._v("\n          "+t._s(e.text)+"\n        ")])})),0)],1),i("v-col",{staticClass:"mb-5",attrs:{cols:"12"}},[i("h2",{staticClass:"headline font-weight-bold mb-3"},[t._v("\n        Important Links\n      ")]),i("v-row",{attrs:{justify:"center"}},t._l(t.importantLinks,(function(e,n){return i("a",{key:n,staticClass:"subheading mx-3",attrs:{href:e.href,target:"_blank"}},[t._v("\n          "+t._s(e.text)+"\n        ")])})),0)],1),i("v-col",{staticClass:"mb-5",attrs:{cols:"12"}},[i("h2",{staticClass:"headline font-weight-bold mb-3"},[t._v("\n        Ecosystem\n      ")]),i("v-row",{attrs:{justify:"center"}},t._l(t.ecosystem,(function(e,n){return i("a",{key:n,staticClass:"subheading mx-3",attrs:{href:e.href,target:"_blank"}},[t._v("\n          "+t._s(e.text)+"\n        ")])})),0)],1)],1)],1)},r=[],l={name:"HelloWorld",data:function(){return{ecosystem:[{text:"vuetify-loader",href:"https://github.com/vuetifyjs/vuetify-loader"},{text:"github",href:"https://github.com/vuetifyjs/vuetify"},{text:"awesome-vuetify",href:"https://github.com/vuetifyjs/awesome-vuetify"}],importantLinks:[{text:"Documentation",href:"https://vuetifyjs.com"},{text:"Chat",href:"https://community.vuetifyjs.com"},{text:"Made with Vuetify",href:"https://madewithvuejs.com/vuetify"},{text:"Twitter",href:"https://twitter.com/vuetifyjs"},{text:"Articles",href:"https://medium.com/vuetify"}],whatsNext:[{text:"Explore components",href:"https://vuetifyjs.com/components/api-explorer"},{text:"Select a layout",href:"https://vuetifyjs.com/getting-started/pre-made-layouts"},{text:"Frequently Asked Questions",href:"https://vuetifyjs.com/getting-started/frequently-asked-questions"}]}}},c=l,d=n("2877"),u=n("6544"),h=n.n(u),v=n("62ad"),p=n("a523"),f=n("adda"),_=n("0fd9"),m=Object(d["a"])(c,s,r,!1,null,null,null),g=m.exports;h()(m,{VCol:v["a"],VContainer:p["a"],VImg:f["a"],VRow:_["a"]});var b={name:"App",components:{HelloWorld:g},data:function(){return{}}},y=b,k=n("7496"),w=n("f6c4"),x=Object(d["a"])(y,a,o,!1,null,null,null),C=x.exports;h()(x,{VApp:k["a"],VMain:w["a"]});var j=n("8c4f"),E=n("2f62");i["a"].use(E["a"]);var V=new E["a"].Store({state:{session:null,user:null,token:null},mutations:{set_session:function(t,e){t.session=e},login:function(t,e){t.token=e.token,t.user=e.user}},actions:{}}),P=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"home"},[i("img",{attrs:{alt:"Vue logo",src:n("cf05")}}),i("HelloWorld",{attrs:{msg:"Welcome to Your Vue.js App"}})],1)},T=[],$={name:"home",components:{HelloWorld:g}},S=$,R=Object(d["a"])(S,P,T,!1,null,null,null),O=(R.exports,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",[n("h4",[t._v("Annotations")]),n("v-layout",{attrs:{row:"",wrap:""}},t._l(t.tasks.annotations,(function(e,i){return n("v-flex",{attrs:{cols:"12",sm:"12",md:"6"}},[n("v-card",{staticClass:"ma-2"},[n("v-card-text",[n("div",[t._v(t._s(e.project.name))]),null!=e.name&&""!==e.name?n("div",[n("p",{staticClass:"text-h5 text--primary ma-0"},[e.completed?n("v-icon",[t._v("mdi-check")]):t._e(),t._v("\n              "+t._s(e.name)+"\n            ")],1),n("p",[t._v(t._s(t.task_types[e.type]))])]):n("div",[n("p",{staticClass:"text-h5 text--primary"},[e.completed?n("v-icon",[t._v("mdi-check")]):t._e(),t._v("\n              "+t._s(t.task_types[e.type])+"\n            ")],1)]),n("div",[n("v-chip-group",t._l(e.slides,(function(e){return n("v-chip",{staticStyle:{"pointer-events":"none"}},[t._v(t._s(e.id))])})),1)],1)]),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:"",block:"",color:"primary accent-3"},on:{click:function(n){return t.start_task(e)}}},[t._v("\n            Continue\n          ")])],1)],1)],1)})),1),n("h4",[t._v("Revisions")]),n("v-layout",{attrs:{row:"",wrap:""}},t._l(t.tasks.review,(function(e,i){return n("v-flex",{attrs:{cols:"12",sm:"12",md:"6"}},[n("v-card",{staticClass:"ma-2"},[n("v-card-text",[n("div",[t._v(t._s(e.project.name))]),null!=e.name&&""!==e.name?n("div",[n("p",{staticClass:"text-h5 text--primary ma-0"},[e.completed?n("v-icon",[t._v("mdi-check")]):t._e(),t._v("\n              "+t._s(e.name)+"\n            ")],1),n("p",[t._v(t._s(t.task_types[e.type]))])]):n("div",[n("p",{staticClass:"text-h5 text--primary"},[e.completed?n("v-icon",[t._v("mdi-check")]):t._e(),t._v("\n              "+t._s(t.task_types[e.type])+"\n            ")],1)]),n("div",[n("v-chip-group",t._l(e.slides,(function(e){return n("v-chip",{staticStyle:{"pointer-events":"none"}},[t._v(t._s(e.id))])})),1)],1)]),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:"",block:"",color:"primary accent-3"},on:{click:function(n){return t.start_task(e)}}},[t._v("\n            Continue\n          ")])],1)],1)],1)})),1)],1)}),I=[],L={name:"Tasks",data:function(){return{tasks:{},task_types:["Annotate images","Review annotations"]}},methods:{start_task:function(t){var e=this;this.$post("session/create",t).then((function(t){e.$store.commit("set_session",t),e.$router.push("/session/"+t.id)})).catch((function(t){return alert(t)}))},loadTasks:function(){var t=this;this.$get("task/list").then((function(e){return t.tasks=e})).catch((function(t){return alert(t)}))}},mounted:function(){this.loadTasks()}},A=L,z=n("8336"),D=n("b0af"),U=n("99d9"),F=n("cc20"),N=n("ef9a"),H=n("ce7e"),W=n("0e8f"),B=n("132d"),M=n("a722"),q=n("2fa4"),G=Object(d["a"])(A,O,I,!1,null,"373df35e",null),J=G.exports;h()(G,{VBtn:z["a"],VCard:D["a"],VCardActions:U["a"],VCardText:U["b"],VChip:F["a"],VChipGroup:N["a"],VContainer:p["a"],VDivider:H["a"],VFlex:W["a"],VIcon:B["a"],VLayout:M["a"],VSpacer:q["a"]});var X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{staticStyle:{overflow:"hidden"}},[n("slice-viewer",{ref:"slice_viewer",attrs:{drawer:!t.session.completed,"tile-sources":t.tile_sources,labels:t.project_labels,"labels-visibility":t.labels_visible,"region-opacity":t.region_opacity,"draw-events":t.draw_events},on:{"region-clicked":t.regionClicked,"new-draw":t.onNewRegionDraw,"edit-draw":t.onEditRegionDraw},model:{value:t.labelled[t.current_slide],callback:function(e){t.$set(t.labelled,t.current_slide,e)},expression:"labelled[current_slide]"}}),n("side-window",[n("v-toolbar",{attrs:{dense:"",fixed:"",color:"grey lighten-4"},scopedSlots:t._u([{key:"extension",fn:function(){return[n("v-tabs",{model:{value:t.selected_tab,callback:function(e){t.selected_tab=e},expression:"selected_tab"}},[n("v-tab",[t._v("View")]),n("v-tab",[t._v("Regions")])],1)]},proxy:!0}])},[n("v-toolbar-title",[t._v(t._s(0===t.task_type?"Labelling task":"Review task"))])],1),n("v-tabs-items",{model:{value:t.selected_tab,callback:function(e){t.selected_tab=e},expression:"selected_tab"}},[n("v-tab-item",[n("v-container",{attrs:{fluid:"","grid-list-md":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{cols:"12",sm:"12",md:"6"}},[n("v-card",[n("v-card-title",[t._v("Region visibility by label")]),n("div",{staticClass:"pl-3 pr-3 pb-3"},t._l(t.project_labels,(function(e){return n("v-switch",{key:e.id,staticClass:"mt-0",attrs:{"hide-details":"",dense:"",label:e.name,color:t.genColor(e.color)},model:{value:t.labels_visible[e.name],callback:function(n){t.$set(t.labels_visible,e.name,n)},expression:"labels_visible[label.name]"}})})),1),n("v-divider"),n("v-slider",{staticClass:"pl-2 pr-2",attrs:{"hide-details":"","prepend-icon":"mdi-circle-opacity",step:"0","thumb-label":"",min:"0.1",max:"1"},scopedSlots:t._u([{key:"thumb-label",fn:function(e){var n=e.value;return[t._v("\n                    "+t._s(n.toFixed(2))+"\n                  ")]}}]),model:{value:t.region_opacity,callback:function(e){t.region_opacity=e},expression:"region_opacity"}})],1)],1),t.slides.length>1?n("v-flex",{attrs:{cols:"12",sm:"12",md:"6"}},[n("v-card",[n("div",{staticClass:"pa-3 pb-0 text-h6 text--primary"},[t._v("Task slides")]),n("div",{staticClass:"pl-3 pr-3 text-center font-weight-thin card-description"},[t._v("There is more than one slide\n                  associated with this task. Select the slide you want to work with below.\n                ")]),n("div",{staticClass:"pl-3 pr-3 pb-3"},[n("v-radio-group",{attrs:{"hide-details":""},model:{value:t.current_slide,callback:function(e){t.current_slide=e},expression:"current_slide"}},t._l(t.slides,(function(t){return n("v-radio",{attrs:{value:t.id,label:t.id}})})),1)],1)])],1):t._e(),n("v-flex",{attrs:{cols:"12",sm:"12",md:"6"}},[n("v-card",[n("div",{staticClass:"pa-3 pb-0 text-h6 text--primary"},[t._v("Task status")]),n("div",{staticClass:"pl-3 pr-3 text-center font-weight-thin card-description"},[t._v("Once you feel you are done with\n                  task you may mark it as completed.\n                ")]),n("div",{staticClass:"pl-3 pr-3 pb-3"},[n("v-switch",{attrs:{label:"Task completed"},model:{value:t.session.completed,callback:function(e){t.$set(t.session,"completed",e)},expression:"session.completed"}})],1)])],1),1===t.task_type?n("v-flex",{attrs:{cols:"12",sm:"12",md:"6"}},[n("v-card",[n("div",{staticClass:"pa-3 pb-0 text-h6 text--primary"},[t._v("Annotations to review")]),n("div",{staticClass:"pl-3 pr-3 text-center font-weight-thin card-description"},[t._v("List of user's annotations for\n                  this task that must be reviewed. Select the user's annotations you want to review at this time.\n                ")]),n("div",{staticClass:"pl-3 pr-3 pb-3"},t._l(t.revisions,(function(e){return n("v-switch",{attrs:{label:e.user},model:{value:t.revision_enabled[e.id],callback:function(n){t.$set(t.revision_enabled,e.id,n)},expression:"revision_enabled[item.id]"}})})),1)])],1):t._e()],1)],1)],1),n("v-tab-item",[n("v-container",{attrs:{fluid:"","grid-list-md":""}},[n("v-layout",{attrs:{row:"",wrap:""}},t._l(t.labelled[t.current_slide],(function(e,i){return n("v-flex",{attrs:{cols:"12",sm:"12",md:"6"}},[n("annotation-card",{key:i,attrs:{editing:t.editing},on:{"save-region":t.saveEdition,"edit-region":t.editRegion,"cancel-edit":t.cancelEdit,"annotation-feedback":t.annotationFeedback},model:{value:t.labelled[t.current_slide][i],callback:function(e){t.$set(t.labelled[t.current_slide],i,e)},expression:"labelled[current_slide][idx]"}})],1)})),1)],1)],1)],1)],1),t.feedback_dialog?n("v-dialog",{attrs:{width:"500"},model:{value:t.feedback_dialog,callback:function(e){t.feedback_dialog=e},expression:"feedback_dialog"}},[n("v-card",[n("v-card-title",{staticClass:"text-h5 grey lighten-2"},[t._v("\n        Annotation label feedback\n      ")]),n("v-card-text",[n("div",{staticClass:"text-center font-weight-light"},[t._v("What is the correct label?")]),n("v-chip-group",{attrs:{mandatory:""},model:{value:t.editing.feedback.label_id,callback:function(e){t.$set(t.editing.feedback,"label_id",e)},expression:"editing.feedback.label_id"}},t._l(t.project_labels,(function(e){return n("v-chip",{attrs:{filter:"",value:e.id}},[t._v(t._s(e.name))])})),1)],1),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:t.relabelScreenContinue}},[t._v("Continue")])],1)],1)],1):t._e()],1)},Y=[],K=n("3835"),Q=(n("ffc1"),n("ac6a"),n("7f7f"),n("515a")),Z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-navigation-drawer",{ref:"side_window",attrs:{app:"",right:"",width:t.width},model:{value:t.shown,callback:function(e){t.shown=e},expression:"shown"}},[t._t("default")],2)},tt=[],et={name:"SideWindow",data:function(){return{width:300,shown:!0,borderSize:3}},methods:{setBorderWidth:function(){var t=this.$refs.side_window.$el.querySelector(".v-navigation-drawer__border");t.style.width=this.borderSize+"px",t.style.cursor="ew-resize"},setEvents:function(){var t=this.borderSize+300,e=this.$refs.side_window.$el,n=e.querySelector(".v-navigation-drawer__border"),i=this,a=e.classList.contains("v-navigation-drawer--right")?"right":"left";function o(t){document.body.style.cursor="ew-resize";var n="right"===a?document.body.scrollWidth-t.clientX:t.clientX;e.style.width=n+"px"}n.addEventListener("mousedown",(function(n){n.offsetX<t&&(e.style.transition="initial",document.addEventListener("mousemove",o,!1))}),!1),document.addEventListener("mouseup",(function(){e.style.transition="",i.width=e.style.width,document.body.style.cursor="",document.removeEventListener("mousemove",o,!1)}),!1)}},mounted:function(){this.setBorderWidth(),this.setEvents()}},nt=et,it=(n("659f"),n("f774")),at=Object(d["a"])(nt,Z,tt,!1,null,"a324ad62",null),ot=at.exports;h()(at,{VNavigationDrawer:it["a"]});var st=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{attrs:{id:"region-"+t.value.id,"min-width":"200",outlined:""}},[n("v-card-title",[n("v-avatar",{staticClass:"mr-2",attrs:{size:"16",color:t.genColor(t.value.label.color)}}),t._v("\n    "+t._s(t.value.label.name)+"\n  ")],1),1===t.task_type&&null!=t.value.feedback.id?n("v-card-text",[0===t.value.feedback.feedback?n("div",[n("v-icon",[t._v("mdi-check")]),t._v("\n      Correct annotation\n    ")],1):n("div",[n("p",{staticClass:"ma-0"},[n("v-icon",[t._v("mdi-check")]),t._v("\n        "+t._s(t.feedback[t.value.feedback.feedback])+"\n      ")],1),n("p",{staticClass:"ma-0"},[t._v("Correct label:\n        "),n("v-avatar",{staticClass:"mr-2",attrs:{size:"16",color:t.genColor(t.project_labels[t.value.feedback.label_id].color)}}),t._v("\n        "+t._s(t.project_labels[t.value.feedback.label_id].name)+"\n      ")],1),null==t.value.feedback.data||t.undoing_feedback?t._e():n("p",{staticClass:"ma-0"},[n("a",{on:{click:t.swapDrawings}},[t._v("Checkout\n        "+t._s(t.drawing_swapped?"original":"expected")+" region")])])])]):t._e(),n("v-divider"),0===t.task_type?n("v-card-actions",[n("v-spacer"),t.editing!==t.value?n("v-btn",{attrs:{text:""},on:{click:function(e){return t.editRegion(t.value)}}},[t._v("Edit")]):t.editing===t.value?n("div",[n("v-btn",{attrs:{text:""},on:{click:t.cancelEdit}},[t._v("Cancel")]),n("v-btn",{attrs:{text:""},on:{click:function(e){return t.saveRegion(t.value)}}},[t._v("Save")])],1):t._e()],1):1===t.task_type?n("v-card-actions",[n("v-spacer"),null==t.value.feedback.id&&t.editing!==t.value||t.undoing_feedback?n("div",[n("v-menu",{scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({attrs:{text:""}},"v-btn",a,!1),i),[t._v("Incorrect")])]}}],null,!1,4214225949)},[n("v-list",t._l(t.incorrect_options,(function(e,i){return n("v-list-item",{key:i,on:{click:e.func}},[n("v-list-item-title",[t._v(t._s(e.text))])],1)})),1)],1),n("v-btn",{attrs:{text:""},on:{click:t.feedbackCorrect}},[t._v("Correct")])],1):t.editing===t.value?n("div",[n("v-btn",{attrs:{text:""},on:{click:t.cancelEdit}},[t._v("Cancel")]),n("v-btn",{attrs:{text:""},on:{click:function(e){return t.saveRegion(t.value)}}},[t._v("Save")])],1):null!=t.value.feedback.id?n("div",[n("v-btn",{attrs:{text:""},on:{click:t.undo}},[t._v("Undo")])],1):t._e()],1):t._e()],1)},rt=[],lt=n("167a"),ct={name:"AnnotationCard",computed:{task_type:function(){return this.$store.state.session.type},project_labels:function(){for(var t={},e=this.$store.state.session.task.project.labels,n=0;n<e.length;n++)t[e[n].id]=e[n];return t}},data:function(){return{drawing_swapped:!1,originalRegion:null,undoing_feedback:!1,incorrect_options:[{text:"Wrong label",func:this.feedbackWrongLabel},{text:"Wrong region",func:this.feedbackWrongRegion}],feedback:["Correct","Wrong label","Wrong region"]}},methods:{undo:function(){this.drawing_swapped&&this.swapDrawings(),this.undoing_feedback=!0},swapDrawings:function(){console.log("swaping"),this.drawing_swapped?this.value.data=this.originalRegion:(this.originalRegion=this.value.data,this.value.data=this.value.feedback.data),this.drawing_swapped=!this.drawing_swapped,lt["a"].update()},genColor:function(t){return"rgb(".concat(t[0],",").concat(t[1],",").concat(t[2],")")},feedbackWrongLabel:function(){console.log("The label is wrong"),this.undoing_feedback=!1,this.$emit("annotation-feedback","wrong-label",this.value)},feedbackWrongRegion:function(){this.drawing_swapped&&(this.value.data=this.originalRegion,this.drawing_swapped=!1),this.$emit("annotation-feedback","wrong-region",this.value),this.undoing_feedback=!1},feedbackCorrect:function(){this.$emit("annotation-feedback","correct",this.value),this.undoing_feedback=!1},editRegion:function(t){this.$emit("edit-region",t)},saveRegion:function(t){this.$emit("save-region",t)},cancelEdit:function(){this.$emit("cancel-edit")}},props:["editing","value"]},dt=ct,ut=n("8212"),ht=n("8860"),vt=n("da13"),pt=n("5d23"),ft=n("e449"),_t=Object(d["a"])(dt,st,rt,!1,null,"3fb83769",null),mt=_t.exports;h()(_t,{VAvatar:ut["a"],VBtn:z["a"],VCard:D["a"],VCardActions:U["a"],VCardText:U["b"],VCardTitle:U["c"],VDivider:H["a"],VIcon:B["a"],VList:ht["a"],VListItem:vt["a"],VListItemTitle:pt["b"],VMenu:ft["a"],VSpacer:q["a"]});var gt={name:"Session",computed:{session_id:function(){return this.$route.params.session_id},tile_sources:function(){return"http://localhost:2000/api/session/"+this.session_id+"/"+this.current_slide+".dzi"},project_labels:function(){return this.$store.state.session.task.project.labels},session:function(){return this.$store.state.session},slides:function(){var t=this.$store.state.session;return console.log(t),0===t.type?t.task.slides:t.task.task.slides},revisions:function(){for(var t=[],e=this.$store.state.session.task.revisions,n=this.$store.state.session.revision,i=0;i<e.length;i++)t.push({id:e[i].id,user:e[i].user.name,annotations:n[e[i].id],selected:!1});return t},task_type:function(){return this.$store.state.session.type}},watch:{session:{immediate:!0,handler:function(t){0===t.task.type?(this.labelled=t.labelled,this.current_slide=t.task.slides[0].id):(this.labelled=[],this.current_slide=t.task.task.slides[0].id)}},project_labels:{immediate:!0,deep:!0,handler:function(t){console.log("project_labels watcher",t);for(var e=0;e<t.length;e++)this.$set(this.labels_visible,t[e].name,!0)}},labels_visible:{deep:!0,handler:function(t){console.log("labels_visible watcher:",t)}},"session.completed":function(t){var e=this;this.$get("task/completed?id=".concat(this.session.id,"&completed=").concat(t)).catch((function(t){e.session.completed=!e.session.completed,alert(t)}))},revision_enabled:{deep:!0,handler:function(t){var e=this,n={};this.slides.forEach((function(t){return n[t]={}})),Object.entries(t).forEach((function(t){var i=Object(K["a"])(t,2),a=i[0],o=i[1];if(o){var s=e.$store.state.session.revision[a];Object.entries(s).forEach((function(t){var e=Object(K["a"])(t,2),i=e[0],a=e[1];return n[i]=a}))}})),this.labelled=n}}},data:function(){var t=this;return{current_slide:null,labelled:{},selected_tab:0,labels_visible:{},region_opacity:.3,editing:null,revision_enabled:{},feedback_dialog:!1,draw_events:{onHover:t.onRegionHover,onLeave:t.onRegionLeave,onClick:t.regionClicked,onFinishedEditing:function(e,n){t.editing=null}}}},methods:{relabelScreenContinue:function(){2!==this.editing.feedback.feedback?this.saveFeedback():(this.feedback_dialog=!1,this.editRegion(this.editing))},saveFeedback:function(){var t=this;this.$post("session/".concat(this.session_id,"/annotation_feedback"),this.editing).then((function(e){console.log(e),t.editing.feedback.id=e.feedback.id,t.feedback_dialog=!1,t.editing=null})).catch((function(t){return alert(t)}))},onRegionHover:function(t){var e=document.getElementById("region-".concat(t.id));null!=e&&(this.selected_tab=1,e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("hovered"))},onRegionLeave:function(t){var e=document.getElementById("region-".concat(t.id));null!=e&&e.classList.remove("hovered")},genColor:function(t){return"rgb(".concat(t[0],",").concat(t[1],",").concat(t[2],")")},onNewRegionDraw:function(t){var e=this;t.slide_id=this.current_slide,this.$post("session/"+this.session_id+"/add_region",t).then((function(t){e.labelled[e.current_slide].push(t)})).catch((function(t){alert("Error while saving region: "+t)}))},onEditRegionDraw:function(t){var e=this;if(0===this.task_type)this.editing=null,this.$post("session/"+this.session_id+"/edit_region",t).then((function(t){console.log(t)})).catch((function(t){alert("Error while saving region: "+t)}));else if(1===this.task_type){console.log("editing before request: ",this.editing,this.original_data);var n=this.editing,i=this.original_data;n.feedback.data=t.data,this.$post("session/".concat(this.session_id,"/annotation_feedback"),this.editing).then((function(t){console.log("editing",n,"original_data",i),console.log("resp:",t),n.data=t.data,n.feedback.id=t.feedback.id,e.feedback_dialog=!1,lt["a"].update()})).catch((function(t){return alert(t)}))}},regionClicked:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("regionClicked",t);var n=document.getElementById("region-".concat(t.id));this.selected_tab=1,n.scrollIntoView({behavior:"smooth",block:"center"}),n.classList.add("highlighted"),e&&n.classList.add("short"),setTimeout((function(){n.classList.remove("highlighted"),n.classList.remove("short")}),e?250:3e3)},editRegion:function(t){console.log("editRegion session"),this.$refs.slice_viewer.editElement(t),this.editing=t},saveEdition:function(t){this.$refs.slice_viewer.saveEdition(t)},cancelEdit:function(){this.$refs.slice_viewer.cancelEdit(),this.editing=null},annotationFeedback:function(t,e){switch(console.log(t,e),this.editing=e,t){case"correct":this.editing.feedback.feedback=0,this.editing.feedback.data=null,this.editing.feedback.label_id=null,this.saveFeedback();break;case"wrong-label":this.editing.feedback.feedback=1,this.editing.feedback.data=null,this.feedback_dialog=!0;break;case"wrong-region":this.editing.feedback.feedback=2,this.feedback_dialog=!0,this.original_data=e.data;break}}},components:{AnnotationCard:mt,SideWindow:ot,SliceViewer:Q["a"]}},bt=gt,yt=(n("f6ad"),n("169a")),kt=n("67b6"),wt=n("43a6"),xt=n("ba0d"),Ct=n("b73d"),jt=n("71a3"),Et=n("c671"),Vt=n("fe57"),Pt=n("aac8"),Tt=n("71d9"),$t=n("2a7f"),St=Object(d["a"])(bt,X,Y,!1,null,"4f1523da",null),Rt=St.exports;h()(St,{VBtn:z["a"],VCard:D["a"],VCardActions:U["a"],VCardText:U["b"],VCardTitle:U["c"],VChip:F["a"],VChipGroup:N["a"],VContainer:p["a"],VDialog:yt["a"],VDivider:H["a"],VFlex:W["a"],VLayout:M["a"],VRadio:kt["a"],VRadioGroup:wt["a"],VSlider:xt["a"],VSpacer:q["a"],VSwitch:Ct["a"],VTab:jt["a"],VTabItem:Et["a"],VTabs:Vt["a"],VTabsItems:Pt["a"],VToolbar:Tt["a"],VToolbarTitle:$t["a"]});var Ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",[n("v-expansion-panels",{attrs:{multiple:""}},[n("v-row",[n("v-col",{attrs:{sm:"12"}},[n("v-expansion-panel",[n("v-expansion-panel-header",[n("v-toolbar-title",{staticClass:"title"},[t._v("Tasks")])],1),n("v-expansion-panel-content",[n("v-tabs",{model:{value:t.task_type,callback:function(e){t.task_type=e},expression:"task_type"}},[n("v-tab",[t._v("Annotations")]),n("v-tab",[t._v("Revisions")])],1),n("v-data-table",{attrs:{headers:t.config.task_headers[t.task_type],items:t.tasks[t.task_type],"items-per-page":5},scopedSlots:t._u([{key:"item.slides",fn:function(e){var i=e.item;return[n("v-chip-group",t._l(i.slides,(function(e){return n("v-chip",{staticStyle:{"pointer-events":"none"},attrs:{outlined:"",readonly:!0}},[t._v("\n                    "+t._s(e.id)+"\n                  ")])})),1)]}},{key:"item.assigned",fn:function(e){var i=e.item;return[n("v-chip-group",{attrs:{"active-class":"primary--text"}},t._l(i.assigned,(function(e){return n("v-chip",{staticStyle:{"pointer-events":"none"},attrs:{readonly:!0,dark:""}},[t._v("\n                    "+t._s(e.name)+"\n                  ")])})),1)]}},{key:"item.revisions",fn:function(e){var i=e.item;return[n("v-chip-group",{attrs:{"active-class":"primary--text"}},t._l(i.revisions,(function(e){return n("v-chip",{staticStyle:{"pointer-events":"none"},attrs:{readonly:!0,dark:""}},[t._v("\n                    "+t._s(e.user.name)+"\n                  ")])})),1)]}},{key:"item.actions",fn:function(e){var i=e.item;return[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.edit_task(i)}}},[t._v(" mdi-pencil")]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[n("v-icon",t._g(t._b({attrs:{small:""},on:{click:function(t){}}},"v-icon",a,!1),i),[t._v(" mdi-delete")])]}}],null,!0)},[n("span",[t._v("Not implemented")])])]}}])}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:t.new_task}},[t._v("New task")])],1)],1)],1)],1),n("v-col",{attrs:{sm:"12"}},[n("v-expansion-panel",[n("v-expansion-panel-header",[n("v-toolbar-title",{staticClass:"title"},[t._v("Users")])],1),n("v-expansion-panel-content",[n("v-data-table",{attrs:{headers:t.config.user_headers,items:t.users,"items-per-page":5},scopedSlots:t._u([{key:"item.actions",fn:function(e){var i=e.item;return[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.edit_user(i)}}},[t._v("\n                  mdi-pencil\n                ")]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[n("v-icon",t._g(t._b({attrs:{small:""},on:{click:function(t){}}},"v-icon",a,!1),i),[t._v(" mdi-delete")])]}}],null,!0)},[n("span",[t._v("Not implemented")])])]}}])}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:t.new_user}},[t._v("New user")])],1)],1)],1)],1),n("v-col",{attrs:{sm:"12"}},[n("v-expansion-panel",[n("v-expansion-panel-header",[n("v-toolbar-title",{staticClass:"title"},[t._v("Projects")])],1),n("v-expansion-panel-content",[n("v-data-table",{attrs:{headers:t.config.project_header,items:t.projects,"items-per-page":5},scopedSlots:t._u([{key:"item.labels",fn:function(e){var i=e.item;return[n("v-chip-group",t._l(i.labels,(function(e){return n("v-chip",{staticStyle:{"pointer-events":"none"},attrs:{outlined:"",color:"rgb("+e.color[0]+", "+e.color[1]+","+e.color[2]+")",readonly:!0,dark:""}},[t._v("\n                    "+t._s(e.name)+"\n                  ")])})),1)]}},{key:"item.actions",fn:function(e){var i=e.item;return[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.edit_project(i)}}},[t._v("\n                  mdi-pencil\n                ")]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[n("v-icon",t._g(t._b({attrs:{small:""},on:{click:function(t){}}},"v-icon",a,!1),i),[t._v(" mdi-delete")])]}}],null,!0)},[n("span",[t._v("Not implemented")])])]}}])}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:t.new_project}},[t._v("New project")])],1)],1)],1)],1)],1)],1),n("v-navigation-drawer",{attrs:{app:"",temporary:"",right:"",width:"500px"},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[n("v-toolbar",[n("v-toolbar-title",[t._v("Information editor")])],1),n("v-container",["user"===t.mode?n("user-editor",{on:{done:t.done},model:{value:t.editing,callback:function(e){t.editing=e},expression:"editing"}}):"project"===t.mode?n("project-editor",{on:{done:t.done},model:{value:t.editing,callback:function(e){t.editing=e},expression:"editing"}}):"task"===t.mode?n("task-editor",{on:{done:t.done},model:{value:t.editing,callback:function(e){t.editing=e},expression:"editing"}}):t._e()],1)],1)],1)},It=[],Lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-text-field",{attrs:{label:"Name"},model:{value:t.user.name,callback:function(e){t.$set(t.user,"name",e)},expression:"user.name"}}),n("v-text-field",{attrs:{label:"Username"},model:{value:t.user.username,callback:function(e){t.$set(t.user,"username",e)},expression:"user.username"}}),n("v-text-field",{attrs:{label:"Password",type:"password"},model:{value:t.user.password,callback:function(e){t.$set(t.user,"password",e)},expression:"user.password"}}),n("v-checkbox",{attrs:{label:"Is user admin?"},model:{value:t.user.is_admin,callback:function(e){t.$set(t.user,"is_admin",e)},expression:"user.is_admin"}}),n("v-btn",{staticStyle:{position:"absolute",right:"16px"},attrs:{outlined:""},on:{click:t.save}},[t._v("Save")])],1)},At=[],zt={name:"UserEditor",watch:{value:{immediate:!0,handler:function(t){this.user=t}},user:{deep:!0,handler:function(t){this.$emit("input",t)}}},data:function(){return{user:null}},methods:{save:function(){var t=this;null!=this.user.id?this.$post("user/edit",this.user).then((function(e){t.user=e,t.$emit("input",t.user),t.$emit("done","user")})).catch((function(t){alert(t)})):this.$post("user/new",this.user).then((function(e){t.user=e,t.$emit("input",t.user),t.$emit("done","user")})).catch((function(t){alert(t)}))}},props:["value"]},Dt=zt,Ut=n("ac7c"),Ft=n("8654"),Nt=Object(d["a"])(Dt,Lt,At,!1,null,"4e37295a",null),Ht=Nt.exports;h()(Nt,{VBtn:z["a"],VCheckbox:Ut["a"],VTextField:Ft["a"]});var Wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-text-field",{attrs:{label:"Project name"},model:{value:t.project.name,callback:function(e){t.$set(t.project,"name",e)},expression:"project.name"}}),n("v-textarea",{attrs:{label:"Project description"},model:{value:t.project.description,callback:function(e){t.$set(t.project,"description",e)},expression:"project.description"}}),n("v-text-field",{attrs:{label:"Files location","error-messages":t.path_errors},on:{input:t.check_path},model:{value:t.project.folder,callback:function(e){t.$set(t.project,"folder",e)},expression:"project.folder"}}),n("v-data-table",{attrs:{headers:t.header,items:t.project.labels,"items-per-page":5},scopedSlots:t._u([{key:"item.color",fn:function(e){var i=e.item;e.idx;return[n("v-menu",{attrs:{"offset-y":"","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,o=e.attrs;return[n("div",t._g(t._b({staticClass:"color-box",style:t.gen_color(i),on:{click:function(e){return t.change_color(i)}}},"div",o,!1),a))]}}],null,!0),model:{value:t.color_menu[i.name],callback:function(e){t.$set(t.color_menu,i.name,e)},expression:"color_menu[item.name]"}},[n("v-card",[n("v-color-picker",{attrs:{"hide-inputs":"","swatches-max-height":100,"show-swatches":""},model:{value:t.color_picked,callback:function(e){t.color_picked=e},expression:"color_picked"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.color_menu[i.name]=!1}}},[t._v("Done")])],1)],1)],1)]}},{key:"item.actions",fn:function(e){var i=e.item;return[n("v-icon",{attrs:{small:""},on:{click:function(e){return t.remove_label(i)}}},[t._v("\n        mdi-delete\n      ")])]}}])}),n("v-text-field",{attrs:{filled:"",label:"New label","append-outer-icon":"add"},on:{"click:append-outer":t.add_label},model:{value:t.new_label,callback:function(e){t.new_label=e},expression:"new_label"}}),n("v-btn",{staticStyle:{position:"absolute",right:"16px"},attrs:{outlined:""},on:{click:t.save}},[t._v("Save")])],1)},Bt=[],Mt={name:"ProjectEditor",watch:{value:{immediate:!0,handler:function(t){this.project=t}},color_picked:function(t){this.editing_label.color=[t.rgba.r,t.rgba.g,t.rgba.b]}},data:function(){return{project:null,color_picked:null,color_menu:[],header:[{text:"Label",value:"name"},{text:"Color",value:"color",sortable:!1},{text:"Actions",value:"actions"}],path_errors:[],editing_label:null,new_label:null}},methods:{check_path:function(t){var e=this;""===t?this.path_errors=["Path required"]:this.$post("project/valid_path",{path:t}).then((function(t){t.valid_path?e.path_errors=[]:e.path_errors=["Path not found on environment"]})).catch((function(t){return alert(t)}))},add_label:function(){null==this.project&&(this.project={labels:[]}),null==this.project.labels&&(this.project.labels=[]),this.project.labels.push({name:this.new_label,color:[255,255,255]}),this.new_label=""},change_color:function(t){this.editing_label=t},gen_color:function(t){var e=t.color;return"background-color: rgba(".concat(e[0],",").concat(e[1],",").concat(e[2],", 1)")},save:function(){var t=this;this.path_errors.length>0?alert("You need to fix the project's path before continuing."):confirm("Are you sure you want to continue?")&&(null==this.project.id?this.$post("/project/new",this.project).then((function(e){t.project=e,t.$emit("input",t.project),t.$emit("done","project")})).catch((function(t){alert(t)})):this.$post("/project/edit",this.project).then((function(e){t.project=e,t.$emit("input",t.project),t.$emit("done","project")})).catch((function(t){alert(t)})))},remove_label:function(t){var e=this;null==t.id?this.project.labels=this.project.labels.filter((function(e){return e!==t})):this.$post("/project/remove_label",t).then((function(n){e.project.labels=e.project.labels.filter((function(e){return e.id!==t.id})),e.$emit("input",e.project)})).catch((function(t){return alert(t)}))}},mounted:function(){},props:["value"]},qt=Mt,Gt=(n("63f9"),n("03a4")),Jt=n("8fea"),Xt=n("a844"),Yt=Object(d["a"])(qt,Wt,Bt,!1,null,"789ca490",null),Kt=Yt.exports;h()(Yt,{VBtn:z["a"],VCard:D["a"],VCardActions:U["a"],VColorPicker:Gt["a"],VDataTable:Jt["a"],VIcon:B["a"],VMenu:ft["a"],VSpacer:q["a"],VTextField:Ft["a"],VTextarea:Xt["a"]});var Qt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-text-field",{attrs:{label:"Task name"},model:{value:t.task.name,callback:function(e){t.$set(t.task,"name",e)},expression:"task.name"}}),n("v-select",{attrs:{label:"Project",chips:"",items:t.projects,"item-text":"name","item-value":"id"},model:{value:t.task.project_id,callback:function(e){t.$set(t.task,"project_id",e)},expression:"task.project_id"}}),n("v-tabs",{model:{value:t.task.type,callback:function(e){t.$set(t.task,"type",e)},expression:"task.type"}},[n("v-tab",{attrs:{disabled:null!=t.task.id}},[n("v-simple-checkbox",{attrs:{disabled:"",value:0===t.task.type}}),t._v("\n      Annotate\n    ")],1),n("v-tab",{attrs:{disabled:null!=t.task.id}},[n("v-simple-checkbox",{attrs:{disabled:"",value:1===t.task.type}}),t._v("\n      Review\n    ")],1)],1),null==t.task.id?n("v-tabs-items",{model:{value:t.task.type,callback:function(e){t.$set(t.task,"type",e)},expression:"task.type"}},[n("v-tab-item",[n("v-select",{attrs:{label:"File to analyze "+(null!=t.current_folder?"(from "+t.current_folder+")":""),items:t.files,readonly:null==t.task.project_id,"item-text":"id",multiple:"",chips:"","deletable-chips":"","return-object":""},model:{value:t.task.slides,callback:function(e){t.$set(t.task,"slides",e)},expression:"task.slides"}})],1),n("v-tab-item",[n("v-select",{attrs:{label:"Tasks",items:t.review_task_list,"item-value":"id","item-text":"name","return-object":""},model:{value:t.review_task,callback:function(e){t.review_task=e},expression:"review_task"}}),null!=t.task.task_id?n("v-select",{attrs:{label:"Users",items:t.review_task.user_tasks,"item-value":"id","item-text":"user.name",multiple:""},model:{value:t.task.revision,callback:function(e){t.$set(t.task,"revision",e)},expression:"task.revision"}}):t._e()],1)],1):t._e(),n("v-select",{attrs:{label:"Users assigned",chips:"",multiple:"",items:t.users,"item-text":"username","return-object":""},model:{value:t.task.assigned,callback:function(e){t.$set(t.task,"assigned",e)},expression:"task.assigned"}}),n("v-btn",{staticStyle:{position:"absolute",right:"16px"},attrs:{outlined:""},on:{click:t.save}},[t._v("Continue")])],1)},Zt=[],te={name:"TaskEditor",watch:{value:{immediate:!0,handler:function(t){this.task=Object.assign(t)}},color_picked:function(t){this.editing_label.color=[t.rgba.r,t.rgba.g,t.rgba.b]},"task.project_id":function(t){null!=t&&this.load_files(t)},"task.type":function(t){1===t&&null==this.review_task_list&&this.load_review_tasks()},review_task:function(t){this.task.task_id=t.id}},computed:{current_folder:function(){if(null!=this.task){if(null!=this.task.project)return console.log(this.task.project),this.task.project.folder;if(null!=this.task.project_id&&0===this.projects.length){var t=this.task.project_id;return this.projects.filter((function(e){return e.id===t}))[0].folder}}}},data:function(){return{task:null,editing_label:null,new_label:null,users:[],projects:[],files:[],review_task_list:null,review_task:[]}},methods:{load_users:function(){var t=this;this.$get("user/list").then((function(e){return t.users=e})).catch((function(t){return alert(t)}))},load_projects:function(){var t=this;this.$get("project/list").then((function(e){return t.projects=e})).catch((function(t){return alert(t)}))},load_review_tasks:function(){var t=this;this.$get("project/tasks").then((function(e){return t.review_task_list=e})).catch((function(t){return alert(t)}))},save:function(){var t=this;null==this.task.id?this.$post("task/new",this.task).then((function(e){t.task=e,t.$emit("input",e),t.$emit("done","task")})).catch((function(t){alert(t)})):this.$post("task/edit",this.task).then((function(e){t.task=e,t.$emit("input",e),t.$emit("done","task")})).catch((function(t){alert(t)}))},load_files:function(t){var e=this;this.$get("task/files?project_id="+t).then((function(t){e.files=t})).catch((function(t){alert("Unable to locate the project's folder. Make sure the project is properly setup for the current environment.")}))}},mounted:function(){this.load_users(),this.load_projects(),null!=this.task.project&&this.load_files(this.task.project.id)},props:["value"]},ee=te,ne=(n("5d53"),n("b974")),ie=n("9e88"),ae=Object(d["a"])(ee,Qt,Zt,!1,null,"96c6c85e",null),oe=ae.exports;h()(ae,{VBtn:z["a"],VSelect:ne["a"],VSimpleCheckbox:ie["a"],VTab:jt["a"],VTabItem:Et["a"],VTabs:Vt["a"],VTabsItems:Pt["a"],VTextField:Ft["a"]});var se={name:"Admin",components:{TaskEditor:oe,ProjectEditor:Kt,UserEditor:Ht},watch:{editing:function(t,e){}},data:function(){return{drawer:!1,mode:"user",is_editing:!1,editing:null,users:[],projects:[],tasks:[],task_type:"annotations",config:{task_headers:{0:[{text:"id",align:"start",sortable:!1,value:"id"},{text:"Slides",value:"slides"},{text:"Project",value:"project.name"},{text:"Users",value:"assigned"},{text:"Actions",value:"actions"}],1:[{text:"id",align:"start",sortable:!1,value:"id"},{text:"Project",value:"project.name"},{text:"To review",value:"revisions"},{text:"Users",value:"assigned"},{text:"Actions",value:"actions"}]},user_headers:[{text:"id",align:"start",sortable:!1,value:"id"},{text:"Name",value:"name"},{text:"Username (login)",value:"username"},{text:"Is admin?",value:"is_admin"},{text:"Actions",value:"actions"}],project_header:[{text:"Project name",align:"start",sortable:!1,value:"name"},{text:"Description",value:"description"},{text:"Labels",value:"labels"},{text:"Actions",value:"actions"}]}}},methods:{done:function(t){switch(this.drawer=!1,this.editing=null,t){case"user":this.load_users();break;case"project":this.load_projects();break;case"task":this.load_tasks();break}},new_user:function(){this.editing={username:"",is_admin:!1},this.mode="user",this.drawer=!0},edit_user:function(t){this.is_editing=!0,this.editing=t,this.mode="user",this.drawer=!0},new_project:function(){this.editing={name:"",description:"",folder:"",labels:[]},this.mode="project",this.drawer=!0},edit_project:function(t){this.is_editing=!0,this.editing=t,this.mode="project",this.drawer=!0},new_task:function(){this.editing={name:"",type:0,slides:[],assigned:[]},this.mode="task",this.drawer=!0},edit_task:function(t){this.is_editing=!0,this.editing=t,this.mode="task",this.drawer=!0},load_users:function(){var t=this;this.$get("user/list").then((function(e){console.log(e),t.users=e})).catch((function(t){alert(t)}))},load_projects:function(){var t=this;this.$get("project/list").then((function(e){console.log(e),t.projects=e})).catch((function(t){alert(t)}))},load_tasks:function(){var t=this;this.$get("task/list").then((function(e){console.log(e),t.tasks=e})).catch((function(t){return alert(t)}))}},mounted:function(){this.load_users(),this.load_projects(),this.load_tasks()}},re=se,le=n("cd55"),ce=n("49e2"),de=n("c865"),ue=n("0393"),he=n("3a2f"),ve=Object(d["a"])(re,Ot,It,!1,null,"70d0d785",null),pe=ve.exports;h()(ve,{VBtn:z["a"],VCardActions:U["a"],VChip:F["a"],VChipGroup:N["a"],VCol:v["a"],VContainer:p["a"],VDataTable:Jt["a"],VExpansionPanel:le["a"],VExpansionPanelContent:ce["a"],VExpansionPanelHeader:de["a"],VExpansionPanels:ue["a"],VIcon:B["a"],VNavigationDrawer:it["a"],VRow:_["a"],VSpacer:q["a"],VTab:jt["a"],VTabs:Vt["a"],VToolbar:Tt["a"],VToolbarTitle:$t["a"],VTooltip:he["a"]});var fe=n("dd38"),_e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app-bar",{attrs:{app:"",color:"primary",dark:"","shrink-on-scroll":""}},[n("div",{staticClass:"d-flex align-center"},[n("v-img",{staticClass:"shrink mr-2",attrs:{alt:"Vuetify Logo",contain:"",src:"",transition:"scale-transition",width:"40"}}),n("v-toolbar-title",[t._v("med-img-label")])],1),n("v-spacer")],1)},me=[],ge={name:"AppBar"},be=ge,ye=n("40dc"),ke=Object(d["a"])(be,_e,me,!1,null,"7223d993",null),we=ke.exports;h()(ke,{VAppBar:ye["a"],VImg:f["a"],VSpacer:q["a"],VToolbarTitle:$t["a"]}),i["a"].use(j["a"]);var xe=new j["a"]({routes:[{path:"/",name:"home",component:function(){return n.e("chunk-928ee46e").then(n.bind(null,"a55b"))}},{path:"/tasks",name:"tasks",components:{default:J,app_bar:fe["a"]},meta:{auth:!0}},{path:"/session/:session_id",name:"session",components:{default:Rt,app_bar:fe["a"]},meta:{auth:!0}},{path:"/admin",name:"admin",components:{default:pe,app_bar:we},meta:{auth:!0,is_admin:!0}},{path:"/login",name:"login",component:function(){return n.e("chunk-928ee46e").then(n.bind(null,"a55b"))}},{path:"/about",name:"about",component:function(){return n.e("chunk-2d22d746").then(n.bind(null,"f820"))}}]});xe.beforeEach((function(t,e,n){t.matched.some((function(t){return t.meta.auth}))?null==V.state.token?n({path:"/login",params:{nextUrl:t.fullPath}}):t.matched.some((function(t){return t.meta.is_admin}))?V.state.user.is_admin?n():n({name:"login"}):n():n()}));var Ce=xe,je=n("f309"),Ee=n("fcf4");n("5363");i["a"].use(je["a"]);var Ve=new je["a"]({theme:{icons:{iconfont:"mdi"},themes:{light:{primary:Ee["a"].blueGrey.darken3,secondary:Ee["a"].grey.darken1,accent:Ee["a"].shades.black,error:Ee["a"].red.accent3},dark:{primary:Ee["a"].blue.lighten3}}}}),Pe=n("0987"),Te=n("bc3a"),$e=n.n(Te);i["a"].use(Pe["a"],{axios:$e.a,config:{baseURL:"/api"},interceptors:{beforeRequest:function(t,e){if(null!=V.state.token){var n=V.state.token;n&&(t.headers.Authorization="Bearer ".concat(n))}return t},beforeResponse:function(t,e){},beforeResponseError:function(t,e){t.statusCode}}});var Se=$e.a,Re=n("9b40"),Oe=n.n(Re);i["a"].use(Oe.a);var Ie=Oe.a;i["a"].config.productionTip=!1,new i["a"]({router:Ce,store:V,vuetify:Ve,axios:Se,split:Ie,render:function(t){return t(C)}}).$mount("#app")},"5d53":function(t,e,n){"use strict";n("8c2b")},"63f9":function(t,e,n){"use strict";n("3346")},"659f":function(t,e,n){"use strict";n("d8bc")},"7b53":function(t,e,n){},"8c2b":function(t,e,n){},9297:function(t,e,n){},"9b19":function(t,e,n){t.exports=n.p+"static/img/logo.63a7d78d.svg"},cf05:function(t,e,n){t.exports=n.p+"static/img/logo.82b9c7a5.png"},d8bc:function(t,e,n){},dd38:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app-bar",{attrs:{app:"",color:"primary",dark:"",dense:""}},["session"===t.$route.name?n("v-btn",{staticClass:"hidden-xs-only",attrs:{icon:""},on:{click:function(e){return t.$router.go(-1)}}},[n("v-icon",[t._v("mdi-arrow-left")])],1):t._e(),n("div",{staticClass:"d-flex align-center"},[n("v-img",{staticClass:"shrink mr-2",attrs:{alt:"Vuetify Logo",contain:"",src:"",transition:"scale-transition",width:"40"}}),n("v-toolbar-title",[t._v("med-img-label")])],1),n("v-spacer"),n("v-btn",{attrs:{text:""}},[n("span",{staticClass:"mr-2"},[t._v("Export")]),n("v-icon",[t._v("mdi-open-in-new")])],1)],1)},a=[],o={name:"AppBar"},s=o,r=n("2877"),l=n("6544"),c=n.n(l),d=n("40dc"),u=n("8336"),h=n("132d"),v=n("adda"),p=n("2fa4"),f=n("2a7f"),_=Object(r["a"])(s,i,a,!1,null,"2116e655",null);e["a"]=_.exports;c()(_,{VAppBar:d["a"],VBtn:u["a"],VIcon:h["a"],VImg:v["a"],VSpacer:p["a"],VToolbarTitle:f["a"]})},e8a8:function(t,e,n){"use strict";n("9297")},f6ad:function(t,e,n){"use strict";n("7b53")}});
//# sourceMappingURL=app.9a8e854c.js.map