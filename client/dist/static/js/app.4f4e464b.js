(function(t){function e(e){for(var a,i,r=e[0],l=e[1],c=e[2],u=0,d=[];u<r.length;u++)i=r[u],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);h&&h(e);while(d.length)d.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],a=!0,i=1;i<n.length;i++){var r=n[i];0!==o[r]&&(a=!1)}a&&(s.splice(e--,1),t=l(l.s=n[0]))}return t}var a={},i={app:0},o={app:0},s=[];function r(t){return l.p+"static/js/"+({}[t]||t)+"."+{"chunk-3ea9ad1b":"78d679e8","chunk-47ab8f2f":"eb053ffe","chunk-4e90b011":"f8e6fc67","chunk-81d5d9f4":"fb6c8fcb"}[t]+".js"}function l(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.e=function(t){var e=[],n={"chunk-3ea9ad1b":1,"chunk-47ab8f2f":1,"chunk-4e90b011":1,"chunk-81d5d9f4":1};i[t]?e.push(i[t]):0!==i[t]&&n[t]&&e.push(i[t]=new Promise((function(e,n){for(var a="static/css/"+({}[t]||t)+"."+{"chunk-3ea9ad1b":"69f3eaeb","chunk-47ab8f2f":"fea34622","chunk-4e90b011":"95d28b00","chunk-81d5d9f4":"76a811a3"}[t]+".css",o=l.p+a,s=document.getElementsByTagName("link"),r=0;r<s.length;r++){var c=s[r],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===a||u===o))return e()}var d=document.getElementsByTagName("style");for(r=0;r<d.length;r++){c=d[r],u=c.getAttribute("data-href");if(u===a||u===o)return e()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=e,h.onerror=function(e){var a=e&&e.target&&e.target.src||o,s=new Error("Loading CSS chunk "+t+" failed.\n("+a+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=a,delete i[t],h.parentNode.removeChild(h),n(s)},h.href=o;var v=document.getElementsByTagName("head")[0];v.appendChild(h)})).then((function(){i[t]=0})));var a=o[t];if(0!==a)if(a)e.push(a[2]);else{var s=new Promise((function(e,n){a=o[t]=[e,n]}));e.push(a[2]=s);var c,u=document.createElement("script");u.charset="utf-8",u.timeout=120,l.nc&&u.setAttribute("nonce",l.nc),u.src=r(t);var d=new Error;c=function(e){u.onerror=u.onload=null,clearTimeout(h);var n=o[t];if(0!==n){if(n){var a=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+a+": "+i+")",d.name="ChunkLoadError",d.type=a,d.request=i,n[1](d)}o[t]=void 0}};var h=setTimeout((function(){c({type:"timeout",target:u})}),12e4);u.onerror=u.onload=c,document.head.appendChild(u)}return Promise.all(e)},l.m=t,l.c=a,l.d=function(t,e,n){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)l.d(n,a,function(e){return t[e]}.bind(null,a));return n},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/",l.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=e,c=c.slice();for(var d=0;d<c.length;d++)e(c[d]);var h=u;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0eec":function(t,e,n){"use strict";n("4249")},"167a":function(t,e,n){"use strict";n.d(e,"b",(function(){return A})),n.d(e,"a",(function(){return C})),n.d(e,"c",(function(){return g})),n.d(e,"e",(function(){return b})),n.d(e,"d",(function(){return P}));n("2397"),n("d92a");var a=n("45eb"),i=n("262e"),o=n("99de"),s=n("7e84"),r=(n("c5f6"),n("6d67"),n("6c7b"),n("8615"),n("7f7f"),n("3835")),l=(n("ffc1"),n("ac6a"),n("f3e2"),n("d4ec")),c=n("bee2"),u=(n("6762"),n("2fdb"),n("d25f"),n("c7c6"),n("aa78")),d=n.n(u),h=n("2ef0"),v=n.n(h);function p(t){var e=f();return function(){var n,a=Object(s["a"])(t);if(e){var i=Object(s["a"])(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return Object(o["a"])(this,n)}}function f(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function m(t,e,n){var a=(e.y-t.y)/(e.x-t.x),i=(n.y-e.y)/(n.x-e.x),o=t.x*a-t.y,s=n.x*i-n.y;return[{slope:a,b:o},{slope:i,b:s}]}function b(t){var e=[];do{e=[];for(var n=1;n<t.length-1;n+=1){var a=t[n-1],i=t[n],o=t[n+1],s=m(a,i,o);s[0].slope===s[1].slope&&s[0].b===s[1].b&&e.push(n)}for(var r=1;r<t.length;r+=1){var l=t[r-1],c=t[r],u=Math.hypot(l.x-c.x,l.y-c.y);u<5&&e.push(r)}t=t.filter((function(t,n){return!e.includes(n)}))}while(0!==e.length);return t}var g=function(){function t(){Object(l["a"])(this,t),this.instance=null,this.delegate={}}return Object(c["a"])(t,[{key:"register",value:function(t,e){var n=this;console.log(e),Object.entries(e).forEach((function(e){var a=Object(r["a"])(e,2),i=a[0],o=a[1];console.log(i,o),i in n.delegate||(n.delegate[i]={}),n.delegate[i][t]=o}))}},{key:"unregister",value:function(t){Object.entries(this.delegate).forEach((function(e,n){t in n&&delete n[t]}))}},{key:"annotationHover",value:function(t){this.notify("annotationHover",t)}},{key:"annotationLeave",value:function(t){this.notify("annotationLeave",t)}},{key:"annotationClicked",value:function(t){this.notify("annotationClicked",t)}},{key:"viewportChanged",value:function(t){this.notify("viewportChanged",t)}},{key:"createNewAnnotation",value:function(t){this.notify("newAnnotation",t)}},{key:"savingNewAnnotation",value:function(t){this.notify("savingNewAnnotation",t)}},{key:"savingAnnotationEdit",value:function(t){this.notify("savingAnnotationEdit",t)}},{key:"stateRestorerEvent",value:function(t){this.notify("stateRestorerEvent",t)}},{key:"peepAnnotation",value:function(t){this.notify("peepAnnotation",t)}},{key:"editAnnotation",value:function(t){this.notify("editAnnotation",t)}},{key:"notify",value:function(t,e){t in this.delegate&&Object.values(this.delegate[t]).forEach((function(t){t(e)}))}}],[{key:"getInstance",value:function(){return null==t.instance&&(t.instance=new t),t.instance}}]),t}(),k=function(){function t(e){Object(l["a"])(this,t),this.name="circle",this.drawer=e,this.newAnnotation=null,this.dragging=!1,this.drawer.setPanningEnabled(!1)}return Object(c["a"])(t,[{key:"mouseEvent",value:function(t,e){var n=this.drawer;switch(t){case"press":if(!1===this.dragging){var a=this.drawer.currentLabel;this.newAnnotation=new S(this.drawer,{state:"creating",geometry:{type:"circle",points:[this.drawer.mousePointToImagePoint(e.position),this.drawer.mousePointToImagePoint(e.position)]},label:a}),this.dragging=!0,this.drawer.update()}break;case"move":if(null!=this.newAnnotation&&this.dragging){var i=n.mousePointToImagePoint(e.position);this.newAnnotation.geometry.points[1].x=i.x,this.newAnnotation.geometry.points[1].y=i.y,n.update()}break;case"release":this.dragging=!1;break;default:break}}},{key:"keyboardEvent",value:function(t,e){switch(t){case"keyUp":13===e.keyCode?(this.newAnnotation.state="idle",this.newAnnotation.updateImageLocation(),this.drawer.callback.onFinishNewDrawing(this.newAnnotation),this.newAnnotation=null,this.drawer.refresh()):27===e.keyCode&&(this.newAnnotation=null,this.drawer.refresh());break;default:break}}},{key:"destroy",value:function(){this.newAnnotation=null,this.drawer.setPanningEnabled(!0)}},{key:"draw",value:function(){null!=this.newAnnotation&&this.newAnnotation.draw()}}]),t}(),w=function(){function t(e){Object(l["a"])(this,t),this.drawer=e,this.name="ruler",this.startingPoint=null,this.endingPoint=null,this.active=!1,this.perpendicular=0}return Object(c["a"])(t,[{key:"perpendicularLine",value:function(t,e){var n=(e.y-t.y)/(e.x-t.x),a=t.x*n-t.y;return{slope:-1/n,b:-1/a}}},{key:"mouseEvent",value:function(t,e){var n=this.drawer;switch(t){case"dblClick":this.active||null==this.startingPoint||null==this.endingPoint?null==this.startingPoint?(this.startingPoint=this.drawer.mousePointToImagePoint(e.position),this.active=!0):(this.endingPoint=this.drawer.mousePointToImagePoint(e.position),this.perpendicular=this.perpendicularLine(this.startingPoint,this.endingPoint),this.active=!1):(this.active=!1,this.startingPoint=null,this.endingPoint=null),n.refresh();break;case"move":this.active&&(this.endingPoint=this.drawer.mousePointToImagePoint(e.position),this.perpendicular=this.perpendicularLine(this.startingPoint,this.endingPoint),n.refresh());break;default:break}}},{key:"keyboardEvent",value:function(t,e){"keyUp"===t&&27===e.keyCode&&(this.active=!1,this.startingPoint=null,this.endingPoint=null,this.drawer.refresh())}},{key:"destroy",value:function(){}},{key:"draw",value:function(){var t=this.drawer.ctx;if(null!=this.startingPoint&&null!=this.endingPoint){var e=this.drawer,n=e.imagePointToCanvasPoint(this.startingPoint.x,this.startingPoint.y),a=e.imagePointToCanvasPoint(this.endingPoint.x,this.endingPoint.y),i=Math.hypot(this.startingPoint.x-this.endingPoint.x,this.startingPoint.y-this.endingPoint.y),o=new Path2D;o.moveTo(n.x,n.y),o.lineTo(a.x,a.y),t.lineWidth=3,t.setLineDash([5,5]),t.strokeStyle="black",t.lineCap="round",t.stroke(o),t.setLineDash([]),t.lineWidth=1,t.strokeStyle="white",t.font="30px Arial",t.fillStyle="black";var s="".concat((i*this.drawer.pixelWidth).toFixed(2),"Âµm");t.fillText(s,30+n.x+(a.x-n.x)/2,n.y+(a.y-n.y)/2),t.strokeText(s,30+n.x+(a.x-n.x)/2,n.y+(a.y-n.y)/2)}}}]),t}(),y=function(){function t(e){Object(l["a"])(this,t),this.name="polygon",this.drawer=e,this.newAnnotation=null,this.dragging=!1,e.setPanningEnabled(!1),this.info("start","pan")}return Object(c["a"])(t,[{key:"info",value:function(){for(var t=[],e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];n.includes("pan")&&t.push("[Space] To drag the image"),n.includes("start")&&t.push("[Click] To start drawing"),n.includes("save")&&t.push("[Enter] To save annotation"),n.includes("continue")&&t.push("[Click] To continue drawing"),n.includes("cancel")&&t.push("[Esc] To cancel"),this.drawer.callback.onInfoUpdate(t)}},{key:"destroy",value:function(){this.drawer.setPanningEnabled(!0),this.stateRestorer.cancel(),this.newAnnotation=null}},{key:"mouseEvent",value:function(t,e){var n=this.drawer.mousePointToImagePoint(e.position);switch(t){case"press":if(this.dragging=!0,null==this.newAnnotation){var a=this.drawer.currentLabel;this.newAnnotation=new j(this.drawer,{state:"creating",geometry:{type:"polygon",points:[n,{x:n.x,y:n.y}]},label:a}),this.stateRestorer=new x(this.drawer,this.newAnnotation)}else this.newAnnotation.geometry.points.push(n),this.stateRestorer.addRestorePoint("Added point");this.drawer.refresh();break;case"move":this.dragging&&null!=this.newAnnotation&&(this.newAnnotation.geometry.points.push(n),this.stateRestorer.addRestorePoint("Added point"),this.drawer.refresh());break;case"release":this.dragging=!1,this.info("continue","pan","save","cancel");break;default:break}}},{key:"keyboardEvent",value:function(t,e){"keyUp"===t&&(13===e.keyCode?null!=this.newAnnotation&&(this.newAnnotation.state="idle",this.newAnnotation.geometry.points=b(this.newAnnotation.geometry.points),this.newAnnotation.update(),this.drawer.callback.onFinishNewDrawing(this.newAnnotation),this.newAnnotation=null,this.drawer.update()):27===e.keyCode&&(this.newAnnotation=null,this.drawer.refresh(),this.stateRestorer.cancel()))}},{key:"draw",value:function(){null!=this.newAnnotation&&this.newAnnotation.draw()}}]),t}(),_=function(){function t(e,n){Object(l["a"])(this,t),this.drawer=n,this.annotation=e,this.originalAnnotation=v.a.cloneDeep(e),"feedback"===this.annotation.state?(this.annotation.state="feedback-editing",this.annotation.drawFeedback=!0):this.annotation.state="editing",this.controls=[],this.control=null,this.mode=null,this.dragging=!1,this.hasMoved=!1,this.createControls()}return Object(c["a"])(t,[{key:"intersectsControl",value:function(t,e){var n=this.drawer,a=(n.currentViewport.bottom-n.currentViewport.top)/n.canvas.clientWidth*25;return t.x>e.x-a&&t.x<e.x+a&&t.y>e.y-a&&t.y<e.y+a}},{key:"getIntersectingControl",value:function(t){var e=this,n=null;return this.controls.forEach((function(a){e.intersectsControl(t,a.point)&&(n=a)})),n}},{key:"mouseEvent",value:function(t,e){if(null!=this.annotation){var n="feedback-editing"===this.annotation.state?this.annotation.feedback.geometry:this.annotation.geometry.points;if("press"===t){if(this.hasMoved=!1,this.drawer.setPanningEnabled(!1),this.dragging=!0,this.control=this.getIntersectingControl(this.drawer.mousePointToImagePoint(e.position)),null==this.control&&this.annotation instanceof j&&this.annotation.intersects(e.position)){var a=this.drawer.mousePointToImagePoint(e.position),i=this.checkPathCreation(a);null!=i&&(n.splice(i,0,a),this.createControls(),this.control=this.controls[i],this.drawer.refresh())}}else if("release"===t)!1===this.hasMoved&&null!=this.control&&(n.splice(this.control.index,1),this.createControls(),this.annotation.update(),this.drawer.refresh()),this.dragging=!1,this.control=null,this.drawer.isPanningEnabled||this.drawer.setPanningEnabled(!0);else if("move"===t&&(this.hasMoved=!0,this.dragging&&null!=this.control)){var o=this.drawer.mousePointToImagePoint(e.position);this.control.point.x=o.x,this.control.point.y=o.y,this.annotation instanceof V&&this.annotation.updateImageLocation(),this.drawer.update()}}}},{key:"keyboardEvent",value:function(t,e){"keyUp"===t&&(27===e.keyCode?this.cancel():13===e.keyCode&&this.conclude())}},{key:"checkPathCreation",value:function(t){for(var e=this.annotation.geometry.points,n=1;n<e.length;n+=1){var a=e[n-1],i=e[n],o=Math.min(a.x,i.x)-10,s=Math.max(a.x,i.x)+10,r=Math.min(a.y,i.y)-10,l=Math.max(a.y,i.y)+10;if(o<t.x&&t.x<s&&r<t.y&&t.y<l)return n}return null}},{key:"cancel",value:function(){var t=this.drawer;"editing"===this.annotation.state?(this.annotation.state="idle",this.annotation.geometry=this.originalAnnotation.geometry,this.annotation.label=this.originalAnnotation.label):(this.annotation.state="feedback",this.annotation.feedback.geometry=this.originalAnnotation.geometry.points),this.annotation.title=this.originalAnnotation.title,this.annotation.description=this.originalAnnotation.description,t.callback.onFinishedEditing(!1,this.annotation),this.annotation=null,t.update(),this.controls=[]}},{key:"conclude",value:function(){"editing"===this.annotation.state?this.annotation.state="idle":this.annotation.state="feedback",this.annotation.updateViewport(),this.controls=[],this.drawer.callback.onFinishedEditing(!0,this.annotation),this.drawer.update(),this.annotation=null}},{key:"destroy",value:function(){null!=this.annotation&&"idle"!==this.annotation.state&&"feedback"!==this.annotation.state&&this.cancel(),this.drawer.update()}},{key:"draw",value:function(){var t=this;this.drawer.ctx.lineWidth=1,this.controls.forEach((function(e){t.drawer.ctx.beginPath();var n=t.drawer.imagePointToCanvasPoint(e.point.x,e.point.y);t.drawer.ctx.ellipse(n.x,n.y,5,5,0,2*Math.PI,0,!1),t.drawer.ctx.setLineDash([]),t.drawer.ctx.fillStyle="rgb(255,255,255)",t.drawer.ctx.fill(),t.drawer.ctx.strokeStyle="black",t.drawer.ctx.stroke(),e.canvasPosition=n}))}},{key:"createControls",value:function(){"feedback-editing"===this.annotation.state?(null==this.annotation.feedback.geometry&&(this.annotation.feedback.geometry=this.annotation.geometry.points.map((function(t){return{x:t.x,y:t.y}}))),this.controls=this.annotation.feedback.geometry.map((function(t,e){return{canvasPosition:null,index:e,point:t}}))):this.controls=this.annotation.geometry.points.map((function(t,e){return{canvasPosition:null,index:e,point:t}}))}}]),t}(),x=function(){function t(e,n){Object(l["a"])(this,t),this.instance=e,this.annotation=n,this.states=[],this.currentStatePoint=0,this.instance.callback.onStateRestorerEvent(this)}return Object(c["a"])(t,[{key:"addRestorePoint",value:function(t){this.states.length>0&&this.currentStatePoint!==this.states.length-1&&this.states.splice(this.currentStatePoint,this.states.length-this.currentStatePoint),this.states.push({type:t,points:this.annotation.geometry.points.map((function(t){return{x:t.x,y:t.y}}))}),this.currentStatePoint=this.states.length-1,this.instance.callback.onStateRestorerEvent(this)}},{key:"restoreToPoint",value:function(t){this.annotation.geometry.points=this.states[t].points,this.instance.update(),this.currentStatePoint=t,this.instance.callback.onStateRestorerEvent(this)}},{key:"cancel",value:function(){this.instance.stateRestorer=null,this.states=null,this.instance.callback.onStateRestorerEvent(null)}}]),t}(),C=function(){function t(e,n){Object(l["a"])(this,t),this.drawer=e,this.id=n.id,this.geometry=n.geometry,this.label=n.label,this.slideId=n.slide_id,this.title=null==n.title?null:n.title,this.description=null==n.description?null:n.description,this.properties=null==n.properties?null:n.properties,this.currentlyImporting=!1,this.layer=null==n.layer?0:n.layer,this.feedback=null,this.drawFeedback=!1,null!=n.feedback?(this.feedback=n.feedback,this.state="feedback"):this.state=null==n.state?"idle":n.state,this.isHovering=!1,this.currentViewport={top:0,left:0,bottom:0,right:0},this.imageLocation={top:Number.MAX_VALUE,left:Number.MAX_VALUE,bottom:0,right:0}}return Object(c["a"])(t,[{key:"setHovering",value:function(t){this.isHovering=t}},{key:"shouldBeVisible",value:function(t){var e=this.imageLocation.bottom<t.top||this.imageLocation.right<t.left||this.imageLocation.left>t.right||this.imageLocation.top>t.bottom,n=this.drawer.filtering,a=n[this.label.name]||"importing"===this.state||"overlay"===this.state;return!e&&a}},{key:"intersects",value:function(t){}},{key:"serialize",value:function(){var t=this.geometry,e=this.label,n=this.slideId,a=this.title,i=this.description,o=this.properties,s=this.feedback,r=this.id;return{geometry:t,label:e,id:r,feedback:s,properties:o,slide_id:n,title:a,description:i}}},{key:"getColor",value:function(){var t=this.drawer.style[this.layer],e=this.label.color;return{color:"".concat(e[0],",").concat(e[1],",").concat(e[2]),opacity:this.isHovering?t.hoverOpacity:t.fillOpacity}}},{key:"update",value:function(){}},{key:"updateViewport",value:function(){var t=this.drawer.imagePointToCanvasPoint(this.imageLocation.left,this.imageLocation.top),e=this.drawer.imagePointToCanvasPoint(this.imageLocation.right,this.imageLocation.bottom);this.currentViewport.left=t.x,this.currentViewport.top=t.y,this.currentViewport.bottom=e.y,this.currentViewport.right=e.x}},{key:"draw",value:function(){throw Error("Failed to implement Annotation.draw()")}}]),t}(),V=function(t){Object(i["a"])(n,t);var e=p(n);function n(t,a){var i;return Object(l["a"])(this,n),i=e.call(this,t,a),i.updateImageLocation(),i}return Object(c["a"])(n,[{key:"updateImageLocation",value:function(){var t=this.geometry.points;this.imageLocation.top=t[0].y,this.imageLocation.left=t[0].x,this.imageLocation.right=t[1].x,this.imageLocation.bottom=t[1].y}},{key:"intersects",value:function(t){return t.y>this.currentViewport.top&&t.y<this.currentViewport.bottom&&t.x>this.currentViewport.left&&t.x<this.currentViewport.right}},{key:"draw",value:function(){var t=Object(a["a"])(Object(s["a"])(n.prototype),"getColor",this).call(this),e=t.color,i=t.opacity,o=this.drawer.ctx,r=this.drawer.style[this.layer],l=this.drawer.imagePointToCanvasPoint.bind(this.drawer),c=this.drawFeedback?this.feedback.geometry:this.geometry.points,u=l(c[0].x,c[0].y),d=l(c[1].x,c[1].y);o.beginPath(),o.rect(u.x,u.y,d.x-u.x,d.y-u.y),this.drawFeedback?(o.setLineDash([2,2]),o.font="18px Arial",o.fillStyle="black",o.fillText("Feedback version",u.x,u.y)):"editing"===this.state||"feedback-editing"===this.state?(o.setLineDash([10,5]),o.lineWidth=r.lineWidth+2,o.font="30px Arial","creating"===this.state&&o.fillText("Preview, press ENTER to save",u.x,u.y)):"idle"===this.state&&(o.setLineDash([]),o.lineWidth=r.lineWidth),o.fillStyle="rgba(".concat(e,", ").concat(i,")"),o.strokeStyle="rgb(".concat(e,")"),o.fill(),o.stroke()}}]),n}(C),T=function(){function t(e){Object(l["a"])(this,t),this.name="rect",this.drawer=e,this.newAnnotation=null,this.dragging=!1,this.drawer.setPanningEnabled(!1),this.info("start")}return Object(c["a"])(t,[{key:"destroy",value:function(){this.newAnnotation=null,this.drawer.setPanningEnabled(!0)}},{key:"info",value:function(){for(var t=[],e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];n.includes("start")&&t.push("[db-Click] To start rect"),n.includes("save")&&t.push("[db-Click] To finish and save"),n.includes("cancel")&&t.push("[Esc] To cancel"),this.drawer.callback.onInfoUpdate(t)}},{key:"mouseEvent",value:function(t,e){var n=this.drawer.mousePointToImagePoint(e.position);switch(t){case"press":if(!1===this.dragging){var a=this.drawer.currentLabel;this.newAnnotation=new V(this.drawer,{state:"creating",geometry:{type:"rect",points:[this.drawer.mousePointToImagePoint(e.position),this.drawer.mousePointToImagePoint(e.position)]},label:a}),this.info("save","cancel"),this.dragging=!0}else this.info("start");this.drawer.refresh();break;case"move":null!=this.newAnnotation&&this.dragging&&(this.newAnnotation.geometry.points[1]=n,this.drawer.refresh());break;case"release":this.dragging=!1;break;default:break}}},{key:"keyboardEvent",value:function(t,e){var n=this.drawer;switch(t){case"keyUp":if(27===e.keyCode)this.newAnnotation=null,n.update(),this.info("start"),n.setPanningEnabled(!1);else if(13===e.keyCode){if(null!=this.newAnnotation){if(this.newAnnotation.geometry.points[0].x>this.newAnnotation.geometry.points[1].x){var a=this.newAnnotation.geometry.points[0].x;this.newAnnotation.geometry.points[0].x=this.newAnnotation.geometry.points[1].x,this.newAnnotation.geometry.points[1].x=a}if(this.newAnnotation.geometry.points[0].y>this.newAnnotation.geometry.points[1].y){var i=this.newAnnotation.geometry.points[0].y;this.newAnnotation.geometry.points[0].y=this.newAnnotation.geometry.points[1].y,this.newAnnotation.geometry.points[1].y=i}}this.newAnnotation.state="idle",this.newAnnotation.updateImageLocation(),n.update(),n.callback.onFinishNewDrawing(this.newAnnotation),this.newAnnotation=null,this.info("start")}break;default:break}}},{key:"draw",value:function(){null!=this.newAnnotation&&this.newAnnotation.draw()}}]),t}(),S=function(t){Object(i["a"])(n,t);var e=p(n);function n(t,a){var i;return Object(l["a"])(this,n),i=e.call(this,t,a),i.updateImageLocation(),i}return Object(c["a"])(n,[{key:"updateImageLocation",value:function(){var t=this.geometry.points,e=Math.abs(t[0].x-t[1].x),n=Math.abs(t[0].y-t[1].y);this.imageLocation.left=t[0].x-e,this.imageLocation.right=t[0].x+e,this.imageLocation.top=t[0].y-n,this.imageLocation.bottom=t[0].y+n}},{key:"intersects",value:function(t){return t.y>this.currentViewport.top&&t.y<this.currentViewport.bottom&&t.x>this.currentViewport.left&&t.x<this.currentViewport.right}},{key:"draw",value:function(){var t=Object(a["a"])(Object(s["a"])(n.prototype),"getColor",this).call(this),e=t.color,i=t.opacity,o=this.drawer.style[this.layer],r=this.geometry.points,l=this.drawer.imagePointToCanvasPoint(r[0].x,r[0].y),c=this.drawer.imagePointToCanvasPoint(r[1].x,r[1].y),u=Math.abs(l.x-c.x),d=Math.abs(l.y-c.y);this.drawer.ctx.beginPath(),this.drawer.ctx.ellipse(l.x,l.y,u,d,0,2*Math.PI,0,!1),this.drawer.ctx.fillStyle="rgba(".concat(e,", ").concat(i,")"),this.drawer.ctx.strokeStyle="rgb(".concat(e,")"),this.drawer.ctx.lineWidth=o.lineWidth,this.drawer.ctx.fill(),this.drawer.ctx.stroke()}}]),n}(C),j=function(t){Object(i["a"])(n,t);var e=p(n);function n(t,a){var i;return Object(l["a"])(this,n),i=e.call(this,t,a),i.updateImageLocation(),i}return Object(c["a"])(n,[{key:"updateImageLocation",value:function(){var t=this;this.geometry.points.forEach((function(e){t.imageLocation.left>e.x&&(t.imageLocation.left=e.x),t.imageLocation.right<e.x&&(t.imageLocation.right=e.x),t.imageLocation.top>e.y&&(t.imageLocation.top=e.y),t.imageLocation.bottom<e.y&&(t.imageLocation.bottom=e.y)}))}},{key:"intersects",value:function(t){return this.drawer.ctx.isPointInPath(this.path,t.x,t.y,"nonzero")}},{key:"update",value:function(){var t=this,e=this.drawFeedback?this.feedback.geometry:this.geometry.points,n=new Path2D,a=this.drawer.imagePointToCanvasPoint(e[0].x,e[0].y);n.moveTo(a.x,a.y),e.forEach((function(e){var a=t.drawer.imagePointToCanvasPoint(e.x,e.y);n.lineTo(a.x,a.y)})),n.lineTo(a.x,a.y),this.path=n}},{key:"draw",value:function(){var t=this.drawer.style[this.layer],e=Object(a["a"])(Object(s["a"])(n.prototype),"getColor",this).call(this),i=e.color,o=e.opacity;if(null==this.id&&this.update(),this.drawFeedback){var r=this.feedback.geometry,l=this.drawer.imagePointToCanvasPoint(r[0].x,r[0].y);this.drawer.ctx.setLineDash([2,2]),this.drawer.ctx.font="18px Arial",this.drawer.ctx.fillStyle="black",this.drawer.ctx.fillText("Feedback version",l.x,l.y)}else if("editing"===this.state||"feedback-editing"===this.state)this.drawer.ctx.setLineDash([10,5]),this.drawer.ctx.lineWidth=t.lineWidth+2;else if("idle"===this.state)this.drawer.ctx.setLineDash([]),this.drawer.ctx.lineWidth=t.lineWidth;else if("overlay"===this.state&&this.isHovering){this.drawer.ctx.font="40px Arial",this.drawer.ctx.fillStyle="rgba(".concat(i,", 1)");var c=this.drawer.ctx.measureText(this.label.name);this.drawer.ctx.fillText(this.label.name,this.drawer.canvas.width/2-c.width/2,50),this.drawer.ctx.fillStyle="rgba(".concat(i,", 0)")}this.drawer.ctx.fillStyle="rgba(".concat(i,", ").concat(o,")"),this.drawer.ctx.strokeStyle="rgb(".concat(i,")"),this.drawer.ctx.lineWidth=t.lineWidth,this.drawer.ctx.fill(this.path),this.drawer.ctx.stroke(this.path)}}]),n}(C),A=function(){function t(e,n){var a=this;Object(l["a"])(this,t);var i=document.createElement("canvas");i.style.position="absolute",i.style.left=0,i.style.top=0,i.style.width="100%",i.style.height="100%",e.canvas.appendChild(i),this.events=g.getInstance(),this.viewer=e,this.canvas=i,this.callback=n,this.ctx=i.getContext("2d"),this.annotationSet=[[]],this.currentlyDrawing=null,this.currentLabel=null,this.currentTool=null,this.elementsOnScreen=[],this.filtering=[],this.isPanningEnabled=!0,this.isPanningMode=!1,this.isCurrentlyHoveringAnnotation=!1,this.pixelWidth=0,this.isDrawingEnabled=!0,this.style=[{fillOpacity:.6},{fillOpacity:.6}],this.currentViewport={top:0,bottom:0,left:0,right:0},this.events.register("drawer",{editAnnotation:function(t){console.log("Drawer received request for editing"),a.editAnnotation(t)}}),this.viewer.addHandler("update-viewport",v.a.throttle(this.updateViewport.bind(this),50)),this.viewer.addHandler("resize",(function(){a.canvas.width=a.viewer.canvas.clientWidth,a.canvas.height=a.viewer.canvas.clientHeight})),this.mouseTracking=new d.a.MouseTracker({element:this.viewer.canvas,nonPrimaryReleaseHandler:function(){},releaseHandler:function(t){a.isToolUsageEnabled()&&a.currentTool.mouseEvent("release",t)},pressHandler:function(t){a.isToolUsageEnabled()&&a.currentTool.mouseEvent("press",t)},clickHandler:function(t){a.isToolUsageEnabled()?a.currentTool.mouseEvent("click",t):a.elementsOnScreen.forEach((function(t){"overlay"!==t.state&&t.isHovering&&(a.callback.onClick(t),a.events.annotationClicked(t))}))},dblClickHandler:function(t){a.isToolUsageEnabled()&&a.currentTool.mouseEvent("dblClick",t)},moveHandler:function(t){if(!a.isToolUsageEnabled()||!a.currentTool.mouseEvent("move",t)){var e=0,i=!1;a.elementsOnScreen.forEach((function(a){var o=a.intersects(t.position);if("overlay"!==a.state){var s=a.isHovering!==o;i=i||o&&s||s,s&&(o?(n.onHover(a),e+=1):n.onLeave(a))}a.setHovering(o)})),i&&(e>0?(a.canvas.style.cursor="pointer",a.isCurrentlyHoveringAnnotation=!0):(a.canvas.style.cursor="default",a.isCurrentlyHoveringAnnotation=!1),a.refresh())}},keyDownHandler:function(t){if(!a.isPanningEnabled&&32===t.keyCode)return a.viewer.panHorizontal=!0,a.viewer.panVertical=!0,void(a.panningMode=!0);null!=a.currentTool&&a.currentTool.keyboardEvent("keyDown",t)},keyUpHandler:function(t){if(!a.isPanningEnabled&&32===t.keyCode)return a.viewer.panHorizontal=!1,a.viewer.panVertical=!1,void(a.panningMode=!1);null!=a.currentTool&&a.currentTool.keyboardEvent("keyUp",t)}}),this.canvas.width=this.viewer.canvas.clientWidth,this.canvas.height=this.viewer.canvas.clientHeight}return Object(c["a"])(t,[{key:"tool",get:function(){return null!=this.currentTool?this.currentTool.name:"none"},set:function(t){null!=this.currentTool&&this.currentTool.destroy();var e={rect:T,polygon:y,circle:k,ruler:w};this.currentTool=null!=t&&t in e?new e[t](this):null}},{key:"label",set:function(t){null!=this.currentTool&&this.refresh(),this.currentLabel=t}},{key:"panningMode",set:function(t){t?this.canvas.style.cursor="grab":this.isCurrentlyHoveringAnnotation?this.canvas.style.cursor="pointer":this.canvas.style.cursor="default",this.isPanningMode=t}},{key:"editAnnotation",value:function(t){null!=this.currentTool&&this.currentTool.destroy(),this.currentTool=new _(t,this),this.refresh()}},{key:"cancelEdit",value:function(){this.currentTool instanceof _&&(this.tool=null),this.update()}},{key:"concludeEdit",value:function(){this.currentTool instanceof _&&(this.currentTool.conclude(),this.tool=null)}},{key:"loadAnnotations",value:function(t){var e=this;if(null==t)return[];var n={rect:function(t){return new V(e,t)},circle:function(t){return new S(e,t)},polygon:function(t){return new j(e,t)}};return this.annotationSet[0]=t.map((function(t){var e=t.geometry.type;return n[e](t)})),this.update(),this.annotationSet[0]}},{key:"isToolUsageEnabled",value:function(){return!this.isPanningMode&&(null!=this.currentTool&&(this.currentTool instanceof _||!this.isCurrentlyHoveringAnnotation))}},{key:"setPanningEnabled",value:function(t){this.viewer.panHorizontal=t,this.viewer.panVertical=t,this.isPanningEnabled=t,this.panningMode=!1}},{key:"calculateViewport",value:function(){var t=this.ctx,e=this.viewer.viewport.windowToImageCoordinates(new d.a.Point(0,0)),n=this.viewer.viewport.windowToImageCoordinates(new d.a.Point(t.canvas.width,t.canvas.height)),a=e.x!==this.currentViewport.left||e.y!==this.currentViewport.bottom||n.x!==this.currentViewport.right||n.y!==this.currentViewport.top;return this.currentViewport.top=e.y,this.currentViewport.bottom=n.y,this.currentViewport.left=e.x,this.currentViewport.right=n.x,a}},{key:"updateViewport",value:function(){this.calculateViewport()&&(this.callback.onViewportChanged(this.currentViewport),this.update())}},{key:"mousePointToImagePoint",value:function(t){var e=this.viewer.viewport.pointFromPixel(t),n=this.viewer.viewport.viewportToImageCoordinates(e.x,e.y);return{x:n.x,y:n.y}}},{key:"imagePointToCanvasPoint",value:function(t,e){var n=new d.a.Point(t,e);return this.viewer.viewport.imageToViewerElementCoordinates(n)}},{key:"peep",value:function(t){var e=this.viewer,n=t.imageLocation,a=n.right-n.left,i=n.bottom-n.top,o=a/2,s=i/2,r=e.viewport.imageToViewportCoordinates(n.left+o,n.top+s);e.viewport.panTo(r,!1);var l=e.world.getItemAt(0),c=l.source.dimensions.y/i,u=l.source.dimensions.x/a,d=c<u?c:u;e.viewport.zoomTo(d-.5*d,!1)}},{key:"update",value:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);var t=this;t.elementsOnScreen=[],null!=this.annotationSet&&this.annotationSet.forEach((function(e){e.forEach((function(e){e.updateViewport(),e.shouldBeVisible(t.currentViewport)&&(t.filtering[e.label.name]||"overlay"===e.state||"importing"===e.state&&t.style[0].showImporting)&&(e.update(),e.draw(),t.elementsOnScreen.push(e))}))})),null!=this.currentTool&&this.currentTool.draw()}},{key:"refresh",value:function(){var t=this;this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.elementsOnScreen.forEach((function(e){e.shouldBeVisible(t.currentViewport)&&e.draw()})),null!=this.currentTool&&this.currentTool.draw()}}]),t}();function P(t,e){var n={rect:V,circle:S,polygon:j},a=e,i={};return Object.entries(t).forEach((function(t){var e=Object(r["a"])(t,2),o=e[0],s=e[1];i[o]=s.map((function(t){var e=t.geometry.type;return new n[e](a,t)}))})),i}},"1c7c":function(t,e,n){"use strict";n("a2b5")},"282a":function(t,e,n){},"2a1d":function(t,e,n){"use strict";n("282a")},"2c36":function(t,e,n){},"2eea":function(t,e,n){"use strict";n("2c36")},"374d":function(t,e,n){},"3a90":function(t,e,n){"use strict";n("d611")},4249:function(t,e,n){},5310:function(t,e,n){"use strict";n("a522")},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d"),n("bf40");var a=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("router-view",{attrs:{name:"app_bar"}}),n("v-main",[n("router-view")],1)],1)},o=[],s={name:"App",components:{},data:function(){return{}}},r=s,l=n("2877"),c=n("6544"),u=n.n(c),d=n("7496"),h=n("f6c4"),v=Object(l["a"])(r,i,o,!1,null,null,null),p=v.exports;u()(v,{VApp:d["a"],VMain:h["a"]});n("759f");var f=n("8c4f"),m=n("2f62");a["a"].use(m["a"]);var b=new m["a"].Store({state:{session:null,user:null,token:null},mutations:{set_session:function(t,e){t.session=e},login:function(t,e){t.token=e.token,t.user=e.user},logout:function(t){t.token=null,t.user=null}},actions:{}}),g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("loading",{attrs:{"is-loading":t.loading}},[null!=t.tasks?n("v-container",{attrs:{"grid-list-sm":""}},[null!=t.projects?n("v-row",[n("v-col",[n("v-card",[n("v-row",{staticClass:"ma-0 pa-0"},[n("v-col",{attrs:{sm:"12"}},[t._v("Project selection\n            ")]),n("v-col",{staticClass:"ma-0 pa-0",attrs:{md:"12"}},[n("v-chip-group",{staticClass:"mr-2 ml-2",model:{value:t.annotationProjectFilter,callback:function(e){t.annotationProjectFilter=e},expression:"annotationProjectFilter"}},[n("v-chip",{attrs:{filter:"",value:null,color:"orange"}},[t._v("All projects\n                ")]),t._l(t.projects,(function(e){return n("v-chip",{key:e.id,attrs:{filter:"",value:e.name}},[t._v("\n                  "+t._s(e.name)+"\n                ")])}))],2)],1)],1)],1)],1)],1):t._e(),n("v-scale-transition",[null!=t.tasks.annotation_status?n("v-row",[n("v-col",{attrs:{md:"6"}},[n("task-status-overview",{attrs:{status:t.tasks.annotation_status},on:{"start-session":t.startTask}},[t._v("\n            Slide Annotation Progress\n          ")])],1),n("v-col",{attrs:{md:"6"}},[n("task-status-overview",{attrs:{status:t.tasks.review_status},on:{"start-session":t.startTask}},[t._v("\n            Annotation Revision Progress\n          ")])],1)],1):t._e()],1),n("v-row",[n("v-col",[null!=t.tasks.annotations&&t.tasks.annotations.length>0?n("v-card",{attrs:{outlined:""}},[n("v-card-title",[n("span",{staticClass:"text-h4 grey--text text--darken-2"},[t._v("\n              Segmentation and annotation tasks\n            ")])]),n("v-row",[n("v-col",[n("v-data-table",{attrs:{headers:t.annotationHeaders,items:t.tasks.annotations,search:t.annotationTaskFilter,"custom-filter":t.annotationTaskFiltering},scopedSlots:t._u([{key:"top",fn:function(){return[n("v-row",{staticClass:"ma-0 pa-0"},[n("v-col",{staticClass:"ma-0 pa-0",attrs:{md:"10"}},[n("v-text-field",{staticClass:"mx-4",attrs:{label:"Search for slide's name"},model:{value:t.annotationTaskFilter,callback:function(e){t.annotationTaskFilter=e},expression:"annotationTaskFilter"}})],1),n("v-col",{staticClass:"ma-0 pa-0",attrs:{md:"2"}},[n("v-checkbox",{attrs:{label:"Show slide's filename"},model:{value:t.showFileNames,callback:function(e){t.showFileNames=e},expression:"showFileNames"}})],1)],1)]},proxy:!0},{key:"item.slides",fn:function(e){var a=e.item;return[t.showFileNames?n("v-chip-group",{attrs:{column:"","show-arrows":""}},t._l(a.slides,(function(e){return n("v-chip",{key:e.id,staticStyle:{"pointer-events":"none"},attrs:{outlined:"",readonly:!0}},[t._v("\n                      "+t._s(e.name)+"\n                    ")])})),1):n("div",[t._v(t._s(a.slides.length)+" slide(s) task")])]}},{key:"item.assigned",fn:function(e){var a=e.item;return[n("v-chip-group",{attrs:{"active-class":"primary--text",column:"","show-arrows":""}},t._l(a.assigned,(function(e){return n("v-chip",{key:e.id,staticStyle:{"pointer-events":"none"},attrs:{readonly:!0,dark:""}},[t._v("\n                      "+t._s(e.name)+"\n                    ")])})),1)]}},{key:"item.completed",fn:function(e){var a=e.item;return[n("div",{staticStyle:{display:"inline"}},[n("v-simple-checkbox",{staticStyle:{display:"inline-block"},attrs:{ripple:!1,value:a.completed}}),a.completed?t._e():n("v-chip",{staticStyle:{display:"inline-block"},attrs:{outlined:"",color:"red"}},[t._v("\n                      Remaining!\n                    ")])],1)]}},{key:"item.actions",fn:function(e){var a=e.item;return[n("v-btn",{attrs:{text:"",color:a.completed?"primary":"orange accent-4"},on:{click:function(e){return t.startTask(a)}}},[t._v("\n                    Open image\n                  ")])]}}],null,!1,3241430276)})],1)],1)],1):t._e()],1)],1),null!=t.tasks.review&&t.tasks.review.length>0?n("v-row",[n("v-col",[n("v-card",{attrs:{outlined:""}},[n("v-card-title",[n("span",{staticClass:"text-h4 grey--text text--darken-2"},[t._v("\n              Annotation revision tasks\n            ")])]),n("v-data-table",{attrs:{headers:t.review_headers,items:t.tasks.review},scopedSlots:t._u([{key:"item.slides",fn:function(e){var a=e.item;return[t.showFileNames?n("v-chip-group",{attrs:{column:"","show-arrows":""}},t._l(a.task.task.slides,(function(e){return n("v-chip",{key:e.id,staticStyle:{"pointer-events":"none"},attrs:{outlined:"",readonly:!0}},[t._v("\n                  "+t._s(e.name)+"\n                ")])})),1):n("div",[t._v(t._s(a.task.task.slides.length)+" slide(s) task")])]}},{key:"item.revisions",fn:function(e){var a=e.item;return[n("v-chip-group",{attrs:{column:"","show-arrows":""}},t._l(a.revisions,(function(e){return n("v-chip",{key:e.id,staticStyle:{"pointer-events":"none"},attrs:{outlined:"",readonly:!0}},[t._v("\n                  "+t._s(null!=e.user?e.user.name:e.app.name)+"\n                ")])})),1)]}},{key:"item.assigned",fn:function(e){var a=e.item;return[n("v-chip-group",{attrs:{"active-class":"primary--text",column:"","show-arrows":""}},t._l(a.assigned,(function(e){return n("v-chip",{key:e.id,staticStyle:{"pointer-events":"none"},attrs:{readonly:!0,dark:""}},[t._v("\n                  "+t._s(e.name)+"\n                ")])})),1)]}},{key:"item.completed",fn:function(e){var a=e.item;return[n("div",{staticStyle:{display:"inline"}},[n("v-simple-checkbox",{staticStyle:{display:"inline-block"},attrs:{ripple:!1,value:a.completed}}),a.completed?t._e():n("v-chip",{staticStyle:{display:"inline-block"},attrs:{outlined:"",color:"red"}},[t._v("\n                  Remaining!\n                ")])],1)]}},{key:"item.actions",fn:function(e){var a=e.item;return[n("v-btn",{attrs:{text:"",color:a.completed?"primary":"orange accent-4"},on:{click:function(e){return t.startTask(a)}}},[t._v("\n                Open Revision\n              ")])]}}],null,!1,3707425885)})],1)],1)],1):t._e()],1):t._e()],1)},k=[],w=(n("6762"),n("2fdb"),n("2caf"),n("7f7f"),n("ac6a"),n("8615"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{staticClass:"mx-auto"},[n("v-card-text",[n("div",[t._t("default")],2),null==t.status.next||t.taskCompleted?n("div",[n("p",{staticClass:"text-h4 text--primary"},[n("v-icon",{staticClass:"mr-2",attrs:{color:"orange accent-4",size:"42"}},[t._v("mdi-check-all")]),t._v("\n        All tasks completed!\n      ")],1),t.status.total>0?n("div",{staticClass:"text--primary"},[t._v("You completed "+t._s(t.status.done)+" of "+t._s(t.status.total)+" tasks.")]):n("div",{staticClass:"text--primary"},[t._v("No tasks available yet")])]):n("div",[n("p",{staticClass:"text-h5 text--primary"},[t._v("\n        "+t._s(t.status.total-t.status.done)+" remaining! You completed\n        "+t._s(t.status.done)+" of "+t._s(t.status.total)+".\n      ")]),n("p",[n("v-progress-linear",{attrs:{readonly:"",value:t.progress}})],1),t.taskCompleted?n("div",{staticClass:"text--primary"},[t._v("You have completed all the slides. You can continue to review them.\n      ")]):n("div",[t._v("\n        "+t._s(t.status.next.project.name)+"\n      ")])])]),n("v-divider"),null!=t.status.next?n("v-card-actions",[null!=t.status.next?n("v-btn",{attrs:{block:"",text:"",color:"orange accent-4",disabled:t.status.next.completed},on:{click:t.startSession}},[t._v("\n      Continue\n    ")]):t._e()],1):t._e()],1)}),y=[],_={name:"TaskStatusOverview",methods:{startSession:function(){this.$emit("start-session",this.status.next)}},computed:{progress:function(){return this.status.done/this.status.total*100},taskCompleted:function(){return this.status.done===this.status.total}},props:["status"]},x=_,C=n("8336"),V=n("b0af"),T=n("99d9"),S=n("ce7e"),j=n("132d"),A=n("8e36"),P=Object(l["a"])(x,w,y,!1,null,"10d8655b",null),L=P.exports;u()(P,{VBtn:C["a"],VCard:V["a"],VCardActions:T["a"],VCardText:T["b"],VDivider:S["a"],VIcon:j["a"],VProgressLinear:A["a"]});var $=n("9d34"),E={name:"Tasks",components:{Loading:$["a"],TaskStatusOverview:L},computed:{projects:function(){if(null!=this.tasks){var t={};for(var e in Object.values(this.tasks.annotations)){var n=this.tasks.annotations[e].project;n.id in t||(t[n.id]={name:n.name,id:n.id})}return Object.values(t)}return[]},annotationHeaders:function(){var t=this;return[{text:"Slides",align:"start",sortable:!1,value:"slides"},{text:"Completed?",value:"completed"},{text:"Project",value:"project.name",filter:function(e){return null==t.annotationProjectFilter||0===t.annotationProjectFilter||e===t.annotationProjectFilter}},{text:"Actions",value:"actions"}]},review_headers:function(){var t=this;return[{text:"Slides associated",align:"start",sortable:!1,value:"slides"},{text:"Annotations by to review",align:"start",sortable:!1,value:"revisions"},{text:"Completed?",value:"completed"},{text:"Project",value:"project.name",filter:function(e){return null==t.annotationProjectFilter||0===t.annotationProjectFilter||e===t.annotationProjectFilter}},{text:"Actions",value:"actions"}]}},data:function(){return{loading:!0,tasks:null,showFileNames:!0,annotationTaskFilter:"",annotationProjectFilter:0,task_types:["Annotate images","Review annotations"]}},methods:{startTask:function(t){var e=this;this.$post("session/create",t).then((function(t){e.$store.commit("set_session",t),e.$router.push("/session/".concat(t.id))})).catch((function(t){return e.$toast.error("Oops, something went wrong:\n".concat(t.response.data.msg))}))},loadTasks:function(){var t=this;this.loading=!0,this.$get("task/list").then((function(e){t.tasks=e,t.loading=!1})).catch((function(e){alert(e),t.loading=!1}))},annotationTaskFiltering:function(t,e){return null!=t&&null!=e&&Array.isArray(t)&&t.some((function(t){return t.name.includes(e)}))}},mounted:function(){this.loadTasks()}},O=E,I=n("ac7c"),D=n("cc20"),F=n("ef9a"),R=n("62ad"),U=n("a523"),M=n("8fea"),B=n("0fd9"),z=n("0789"),W=n("9e88"),H=n("8654"),N=Object(l["a"])(O,g,k,!1,null,"e4c07452",null),G=N.exports;u()(N,{VBtn:C["a"],VCard:V["a"],VCardTitle:T["c"],VCheckbox:I["a"],VChip:D["a"],VChipGroup:F["a"],VCol:R["a"],VContainer:U["a"],VDataTable:M["a"],VRow:B["a"],VScaleTransition:z["e"],VSimpleCheckbox:W["a"],VTextField:H["a"]});var q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{staticStyle:{overflow:"hidden"}},[n("slice-viewer",{ref:"slice_viewer",attrs:{drawer:!t.session.completed&&0===t.task_type&&t.taskBelongsToUser,"tile-sources":t.tile_sources,labels:t.project_labels,"labels-visibility":t.labelsVisible,"drawing-style":t.drawingStyle,"draw-events":t.draw_events,"slide-properties":t.currentSlide.properties},on:{"region-clicked":t.regionClicked,"new-draw":t.onNewRegionDraw,"edit-draw":t.onEditRegionDraw},model:{value:t.annotations[t.currentSlide.id],callback:function(e){t.$set(t.annotations,t.currentSlide.id,e)},expression:"annotations[currentSlide.id]"}}),n("side-window",[n("v-toolbar",{attrs:{dense:"",fixed:"",color:"grey lighten-4"},scopedSlots:t._u([{key:"extension",fn:function(){return[n("v-tabs",{model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},[n("v-tab",[t._v("View")]),t.annotationTabVisible?n("v-tab",[t._v("\n            Annotations ("+t._s(t.annotations[t.currentSlide.id].length)+")\n          ")]):t._e()],1)]},proxy:!0}])},[n("v-toolbar-title",[t._v(t._s(0===t.task_type?"Annotation task":"Review task"))])],1),n("v-tabs-items",{model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},[n("v-tab-item",[n("v-container",{attrs:{fluid:"","grid-list-md":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[0===t.task_type?n("v-flex",{attrs:{cols:"12",sm:"12",md:"6"}},[n("session-class-balance",{ref:"classBalance",attrs:{"session-id":t.session_id,"slide-id":t.currentSlide.id}})],1):t._e(),n("v-flex",{attrs:{cols:"12",sm:"12",md:"6"}},[n("v-card",[n("v-card-title",[t._v("Annotation visibility")]),n("div",{staticClass:"pl-3 pr-3 pb-3",staticStyle:{"max-height":"200px","overflow-y":"auto"}},[t._l(t.project_labels,(function(e){return n("v-switch",{key:e.id,staticClass:"mt-0",attrs:{"hide-details":"",dense:"",label:e.name,color:t.genColor(e.color)},model:{value:t.labelsVisible[e.name],callback:function(n){t.$set(t.labelsVisible,e.name,n)},expression:"labelsVisible[label.name]"}})})),n("v-switch",{staticClass:"mt-0",attrs:{"hide-details":"",dense:"",label:"Show importing"},model:{value:t.drawingStyle[0].showImporting,callback:function(e){t.$set(t.drawingStyle[0],"showImporting",e)},expression:"drawingStyle[0].showImporting"}})],2),n("div",{staticStyle:{"text-align":"center"}},[n("a",{staticClass:"link-btn",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.labelAnnotationsVisibility(!0)}}},[t._v("\n                    Select all\n                  ")]),t._v(" |\n                  "),n("a",{staticClass:"link-btn",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.labelAnnotationsVisibility(!1)}}},[t._v("\n                    Unselect all\n                  ")])]),n("v-divider"),n("div",{staticClass:"flex-container"},[n("v-slider",{staticClass:"pl-2 pr-2",staticStyle:{width:"50%"},attrs:{"hide-details":"","prepend-icon":"mdi-circle-opacity",step:"0","thumb-label":"",min:"0.0",max:"1"},scopedSlots:t._u([{key:"thumb-label",fn:function(e){var n=e.value;return[t._v("\n                      "+t._s(n.toFixed(2))+"\n                    ")]}}]),model:{value:t.drawingStyle[0].fillOpacity,callback:function(e){t.$set(t.drawingStyle[0],"fillOpacity",e)},expression:"drawingStyle[0].fillOpacity"}}),n("v-slider",{staticClass:"pl-2 pr-2",staticStyle:{width:"50%"},attrs:{"hide-details":"","prepend-icon":"mdi-gesture-tap",step:"0","thumb-label":"",min:"0.0",max:"1"},scopedSlots:t._u([{key:"thumb-label",fn:function(e){var n=e.value;return[t._v("\n                      "+t._s(n.toFixed(2))+"\n                    ")]}}]),model:{value:t.drawingStyle[0].hoverOpacity,callback:function(e){t.$set(t.drawingStyle[0],"hoverOpacity",e)},expression:"drawingStyle[0].hoverOpacity"}}),n("div",{staticClass:"break"}),n("v-slider",{staticClass:"pl-2 pr-2",staticStyle:{width:"50%"},attrs:{"hide-details":"","prepend-icon":"mdi-format-line-weight",step:"1","thumb-label":"",min:"1",max:"10"},scopedSlots:t._u([{key:"thumb-label",fn:function(e){var n=e.value;return[t._v("\n                      "+t._s(n.toFixed(2))+"\n                    ")]}}]),model:{value:t.drawingStyle[0].lineWidth,callback:function(e){t.$set(t.drawingStyle[0],"lineWidth",e)},expression:"drawingStyle[0].lineWidth"}}),n("v-switch",{staticStyle:{width:"50%",margin:"0"},attrs:{"hide-details":"",label:"Highlight"},model:{value:t.highlightOnTab,callback:function(e){t.highlightOnTab=e},expression:"highlightOnTab"}})],1)],1)],1),n("v-flex",{attrs:{cols:"12",sm:"12",md:"6"}},[n("v-card",[n("div",{staticClass:"pa-3 pb-0 text-h6 text--primary"},[t._v("Task slides")]),n("div",{staticClass:"pl-3 pr-3 text-center font-weight-thin card-description"},[t._v("\n                  Select the slide you want to work with below.\n                ")]),n("div",{staticClass:"pl-3 pr-3 pb-3"},[n("v-list",{staticClass:"slides-list",attrs:{dense:"",shaped:""}},[n("v-list-item-group",{attrs:{color:"orange",mandatory:""},model:{value:t.currentSlide,callback:function(e){t.currentSlide=e},expression:"currentSlide"}},t._l(t.slides,(function(e){return n("v-list-item",{key:e.id,attrs:{"two-line":"",value:e}},[n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:t._s(e.name)}}),n("v-list-item-subtitle",{domProps:{textContent:t._s(e.properties.comment)}})],1)],1)})),1)],1)],1)])],1),n("v-flex",{attrs:{cols:"12",sm:"12",md:"6"}},[n("v-card",[n("div",{staticClass:"pa-3 pb-0 text-h6 text--primary"},[t._v("Task status")]),n("div",{staticClass:"pl-3 pr-3 text-center font-weight-thin card-description"},[t._v("\n                  Once you feel you are done with\n                  task you may mark it as completed.\n                ")]),n("div",{staticClass:"pl-3 pr-3 pb-3"},[n("v-switch",{attrs:{disabled:!t.taskBelongsToUser,label:"Task completed"},model:{value:t.session.completed,callback:function(e){t.$set(t.session,"completed",e)},expression:"session.completed"}})],1)])],1),1===t.task_type?n("v-flex",{attrs:{cols:"12",sm:"12",md:"6"}},[n("v-card",[n("div",{staticClass:"pa-3 pb-0 text-h6 text--primary"},[t._v("Annotations to review")]),n("div",{staticClass:"pl-3 pr-3 text-center font-weight-thin card-description"},[t._v("\n                  List of user's annotations for this task that must be reviewed.\n                  Select the user's annotations you want to review at this time.\n                ")]),n("div",{staticClass:"pl-3 pr-3 pb-3"},[n("v-radio-group",{model:{value:t.revisingUserTask,callback:function(e){t.revisingUserTask=e},expression:"revisingUserTask"}},[n("v-radio",{attrs:{value:"none",label:"None"}}),t._l(t.revisions,(function(t){return n("v-radio",{key:t.id,attrs:{value:t.id,label:t.user}})}))],2)],1)])],1):t._e(),t.annotationImportingEnabled?n("v-flex",{attrs:{cols:"12",sm:"12",md:"6"}},[n("v-card",[n("div",{staticClass:"pa-3 pb-0 text-h6 text--primary"},[t._v("Import annotations")]),n("div",{staticClass:"pl-3 pr-3 text-center font-weight-thin card-description"},[t._v("\n                  Select a geojson file to import its annotations to the currently selected slide.\n                ")]),t.confirmingImportAnnotations?n("div",{staticClass:"pl-3 pr-3 pb-3"},[n("v-btn",{attrs:{text:""},on:{click:t.dismissAll}},[t._v("Cancel")]),n("v-btn",{attrs:{text:""},on:{click:t.importAll}},[t._v("Import all")])],1):n("div",{staticClass:"pl-3 pr-3 pb-3"},[n("input",{staticStyle:{display:"none"},attrs:{id:"file-importer-input",type:"file"}}),n("v-btn",{attrs:{block:"",text:""},on:{click:t.importAnnotations}},[t._v("Select file")])],1)])],1):t._e(),n("v-flex",{attrs:{cols:"12",sm:"12",md:"6"}},[n("MLPredictionsOverlapTool",{attrs:{"current-slide":t.currentSlide},on:{"clear-overlay":t.onClearOverlayAnnotations,annotations:t.onOverlayAnnotations,"style-changed":t.onOverlayStyleChanged}})],1)],1)],1)],1),null!=t.annotations[t.currentSlide.id]?n("v-tab-item",[n("v-container",{attrs:{fluid:"","grid-list-md":""}},[n("v-layout",{attrs:{row:"",wrap:"",id:"annotation-tab"}},[t._l(t.annotationsLister.pageMax,(function(e){return n("v-flex",{key:e,attrs:{cols:"12",sm:"12",md:"6"}},[n("annotation-card",{on:{"save-annotation":t.concludeEdit,"edit-annotation":t.editRegion,"cancel-edit":t.cancelEdit,"annotation-feedback":t.annotationFeedback,"import-annotation":t.onNewRegionDraw,"dismiss-annotation":t.dismissAnnotation,"annotation-peep":t.annotationPeep,"annotation-update":t.annotationUpdate},model:{value:t.annotations[t.currentSlide.id][t.annotationsListStart+e],callback:function(n){t.$set(t.annotations[t.currentSlide.id],t.annotationsListStart+e,n)},expression:"annotations[currentSlide.id][annotationsListStart + idx]"}})],1)})),n("v-flex",[n("v-pagination",{attrs:{length:t.annotationsLister.totalPages+1,circle:"","total-visible":4},model:{value:t.annotationsLister.page,callback:function(e){t.$set(t.annotationsLister,"page",e)},expression:"annotationsLister.page"}})],1)],2)],1)],1):t._e()],1)],1)],1)},X=[],Y=(n("d25f"),n("2909")),J=(n("6d67"),n("57e7"),n("f3e2"),n("167a")),K=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{attrs:{id:"seadragon-viewer"}}),n("div",{staticClass:"drawing-tool-container"},[n("div",{staticClass:"tool-item"},[0===t.task_type?n("div",{staticClass:"zoom-shortcuts"},[n("v-menu",{attrs:{top:"","close-on-click":!0,"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,i=e.attrs;return[n("v-btn",t._g(t._b({attrs:{text:""}},"v-btn",i,!1),a),[n("v-avatar",{staticClass:"mr-2",attrs:{color:"rgb("+t.selectedLabel.color[0]+","+t.selectedLabel.color[1]+","+t.selectedLabel.color[2]+")",size:"26"}}),t._v("\n              "+t._s(t.selectedLabel.name)+"\n            ")],1)]}}],null,!1,1061530642)},[n("v-list",{staticStyle:{overflow:"auto","max-height":"600px"}},t._l(t.labels,(function(e,a){return n("v-list-item",{key:a,on:{click:function(n){t.selectedLabel=e}}},[n("v-list-item-avatar",[n("v-avatar",{attrs:{color:"rgb("+e.color[0]+","+e.color[1]+","+e.color[2]+")",size:"26"}})],1),n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(e.name))])],1)],1)})),1)],1)],1):t._e(),t.drawer?n("v-divider"):t._e(),null!=t.annotationDrawer&&t.annotationDrawer.isDrawingEnabled&&null==t.editing.element?n("div",{staticClass:"zoom-shortcuts"},[n("v-btn",{attrs:{text:"",icon:"",color:"none"===t.annotationDrawer.tool?"primary":"grey"},on:{click:function(e){t.annotationDrawer.tool="none"}}},[n("v-icon",[t._v("mdi-cursor-default")])],1),t.drawer?n("v-btn",{attrs:{text:"",icon:"",color:"polygon"===t.annotationDrawer.tool?"primary":"grey"},on:{click:function(e){t.annotationDrawer.tool="polygon"}}},[n("v-icon",[t._v("mdi-vector-polygon")])],1):t._e(),t.drawer?n("v-btn",{attrs:{text:"",icon:"",color:"rect"===t.annotationDrawer.tool?"primary":"grey"},on:{click:function(e){t.annotationDrawer.tool="rect"}}},[n("v-icon",[t._v("mdi-vector-rectangle")])],1):t._e(),t.drawer?n("v-btn",{attrs:{text:"",icon:"",color:"circle"===t.annotationDrawer.tool?"primary":"grey"},on:{click:function(e){t.annotationDrawer.tool="circle"}}},[n("v-icon",[t._v("mdi-circle-outline")])],1):t._e(),n("v-btn",{attrs:{text:"",icon:"",color:"ruler"===t.annotationDrawer.tool?"primary":"grey"},on:{click:function(e){t.annotationDrawer.tool="ruler"}}},[n("v-icon",[t._v("mdi-ruler")])],1)],1):t._e()],1),t.stateRestorer.showing?n("div",{staticClass:"tool-item"},[n("v-slider",{attrs:{step:"1",dense:"","hide-details":"",max:t.stateRestorer.max_undo,label:"Undo"},model:{value:t.stateRestorer.undo,callback:function(e){t.$set(t.stateRestorer,"undo",e)},expression:"stateRestorer.undo"}})],1):t._e()]),n("div",{staticClass:"toolbox navigation-toolbox"},[n("v-slider",{attrs:{"hide-details":"","thumb-label":"",dense:"",max:40,min:"0.5",step:"0"},scopedSlots:t._u([{key:"thumb-label",fn:function(e){var n=e.value;return[t._v("\n        "+t._s(n.toFixed(2))+"\n      ")]}}]),model:{value:t.zoom,callback:function(e){t.zoom=e},expression:"zoom"}}),n("div",{staticClass:"zoom-shortcuts"},[n("v-btn",{attrs:{text:"",icon:""},on:{click:function(e){t.zoom=1}}},[t._v("1x")]),n("v-btn",{attrs:{text:"",icon:""},on:{click:function(e){t.zoom=2}}},[t._v("2x")]),n("v-btn",{attrs:{text:"",icon:""},on:{click:function(e){t.zoom=10}}},[t._v("10x")]),n("v-btn",{attrs:{text:"",icon:""},on:{click:function(e){t.zoom=20}}},[t._v("20x")]),n("v-btn",{attrs:{text:"",icon:""},on:{click:function(e){t.zoom=40}}},[t._v("40x")])],1)],1),n("div",{staticClass:"toolbox ruler transparent"},[n("SliceViewerRuler",{attrs:{value:t.viewportLocation,"pixel-density":t.pixel_density}})],1)])},Z=[],Q=n("aa78"),tt=n.n(Q),et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("canvas",{staticClass:"ruler-renderer",attrs:{id:"ruler-canvas",width:"80",height:"10"}}),n("div",{staticClass:"ruler-text"},[t._v(t._s((t.pixelDensity*this.bar_size).toFixed(2))+"Âµm")])])},nt=[],at=n("2ef0"),it=n.n(at),ot={name:"WSIViewerRuler",watch:{pixelDensity:{immediate:!0,handler:function(){this.updateRuler()}},bar_size:function(){this.updateRuler()}},computed:{},data:function(){return{bar_size:80}},methods:{updateRuler:it.a.debounce((function(){null!=this.ctx&&(this.ctx.clearRect(0,0,this.canvas.clientWidth,this.canvas.clientHeight),this.ctx.beginPath(),this.ctx.moveTo(80,5),this.ctx.lineTo(80-this.bar_size,5),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(80,0),this.ctx.lineTo(80,10),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(80-this.bar_size,0),this.ctx.lineTo(80-this.bar_size,10),this.ctx.stroke())}),0)},mounted:function(){var t=this;this.canvas=document.getElementById("ruler-canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.onwheel=function(e){var n=-.05*e.deltaY;t.bar_size=Math.max(Math.min(t.bar_size+n,80),10)}},props:["value","pixelDensity"]},st=ot,rt=(n("3a90"),Object(l["a"])(st,et,nt,!1,null,"7b171464",null)),lt=rt.exports,ct={name:"WSIViewer",components:{SliceViewerRuler:lt},computed:{task_type:function(){return this.$store.state.session.type},pixel_density:function(){if(null==this.viewportLocation||null==this.slideProperties)return 0;var t=this.viewportLocation.right-this.viewportLocation.left,e=t/this.annotationDrawer.ctx.canvas.width;return this.slideProperties.pixel_width*e*1.2}},data:function(){return{selectedLabel:null,zoom:0,viewportLocation:null,annotationDrawer:null,editing:{element:null,mode:"mover"},stateRestorer:{showing:!1,undo:0,max_undo:0},info:[]}},watch:{drawer:function(){null!=this.annotationDrawer&&(this.annotationDrawer.tool=null)},value:{immediate:!0,handler:function(t){var e=this;null!=this.annotationDrawer&&(this.annotationDrawer.annotationSet[0]=t,t.forEach((function(t){t.drawer=e.annotationDrawer})))}},task_type:{immediate:!0,handler:function(t){null!=this.annotationDrawer&&(this.annotationDrawer.isDrawingEnabled=0===t)}},labels:{immediate:!0,handler:function(t){this.selectedLabel=t[0]}},labelsVisibility:{immediate:!0,deep:!0,handler:function(t){null!=this.annotationDrawer&&(this.annotationDrawer.filtering=t,this.annotationDrawer.refresh())}},selectedLabel:{immediate:!0,handler:function(t){null!=this.annotationDrawer&&(this.annotationDrawer.label=t)}},zoom:function(t){var e=this.viewer;null==e||this.no_model_action||e.viewport.zoomTo(t),this.no_model_action=!1},drawingStyle:{deep:!0,immediate:!0,handler:function(t){null!=this.annotationDrawer&&(this.annotationDrawer.style=t,this.annotationDrawer.refresh())}},"stateRestorer.undo":function(t){this.no_model_action||null!=this.annotationDrawer.currentTool&&this.annotationDrawer.currentTool.stateRestorer.restoreToPoint(t),this.no_model_action=!1},tileSources:function(t){this.viewer.open(t)},slideProperties:{immediate:!0,deep:!0,handler:function(t){null!=this.annotationDrawer&&(this.annotationDrawer.pixelWidth=t.pixel_width)}}},methods:{loadOverlayAnnotations:function(t){var e=this;console.log("loadOverlayAnnotations",t),null!=this.annotationDrawer&&(1===this.annotationDrawer.annotationSet.length&&this.annotationDrawer.annotationSet.push({}),this.annotationDrawer.annotationSet[1]=t,t.forEach((function(t){t.drawer=e.annotationDrawer})),this.annotationDrawer.update())},clearOverlayAnnotations:function(){console.log("clearOverlayAnnotations","WSIViewer"),this.annotationDrawer.annotationSet.splice(1,1),this.annotationDrawer.update()},editElement:function(t){this.no_model_action=!0},concludeEdit:function(){this.annotationDrawer.concludeEdit()},cancelEdit:function(){this.annotationDrawer.cancelEdit()},peepAnnotation:function(t){this.annotationDrawer.peep(t)},update:function(){this.annotationDrawer.update()}},mounted:function(){var t=this;this.$nextTick((function(){var e=tt()({id:"seadragon-viewer",tileSources:t.tileSources,showNavigator:!0,navigatorPosition:"TOP_RIGHT",navigatorRight:"16px",navigatorBottom:"16px",navigatorHeight:"120px",navigatorWidth:"145px",showNavigationControl:!1,gestureSettingsMouse:{clickToZoom:!1}}),n=function(t){if(null!=t){for(var e=arguments.length,n=new Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];t.apply(void 0,n)}};t.viewer=e,t.annotationDrawer=new J["b"](e,{onViewportChanged:function(e){t.viewportLocation=e,n(t.drawEvents.onViewportChanged,e)},onHover:function(e){n(t.drawEvents.onHover,e)},onLeave:function(e){n(t.drawEvents.onLeave,e)},onClick:function(e){n(t.drawEvents.onClick,e)},onStateRestorerEvent:function(e){t.no_model_action=!0,null!=e?(t.stateRestorer.showing=!0,t.stateRestorer.max_undo=e.states.length-1,t.stateRestorer.undo=e.currentStatePoint):t.stateRestorer.showing=!1,n(t.drawEvents.onStateRestorerEvent,e)},onEditingEvent:function(){t.no_model_action=!0;var e=t.annotationDrawer.currently_editing.history.length-1;t.editing.max_undo=e,t.editing.undo=e,n(t.drawEvents.onEditingEvent)},onFinishNewDrawing:function(e){t.$emit("new-draw",e)},onInfoUpdate:function(e){t.info=e},onFinishedEditing:function(e,a){t.annotationDrawer.tool=null,e&&t.$emit("edit-draw",a),t.editing.element=null,n(t.drawEvents.onFinishedEditing,e,a)}});var a=t.annotationDrawer;null!=t.value&&t.value.forEach((function(t){t.drawer=a})),t.annotationDrawer.annotationSet[0]=t.value,t.annotationDrawer.tool="pointer",t.annotationDrawer.filtering=t.labelsVisibility,t.annotationDrawer.label=t.selectedLabel,t.annotationDrawer.pixelWidth=t.slideProperties.pixel_width,t.annotationDrawer.style=t.drawingStyle,t.annotationDrawer.update(),t.viewer.addHandler("zoom",(function(e){t.no_model_action=!0,t.zoom=e.zoom})),t.no_model_action=!1}))},props:{drawer:{type:Boolean,default:!0},labels:{type:Array},value:{type:Array},tileSources:{type:String},labelsVisibility:{type:Object},drawingStyle:{type:Array},drawEvents:{},slideProperties:{type:Object}}},ut=ct,dt=(n("e25d"),n("8212")),ht=n("8860"),vt=n("da13"),pt=n("8270"),ft=n("5d23"),mt=n("e449"),bt=n("ba0d"),gt=Object(l["a"])(ut,K,Z,!1,null,"70ecfa2c",null),kt=gt.exports;u()(gt,{VAvatar:dt["a"],VBtn:C["a"],VDivider:S["a"],VIcon:j["a"],VList:ht["a"],VListItem:vt["a"],VListItemAvatar:pt["a"],VListItemContent:ft["b"],VListItemTitle:ft["d"],VMenu:mt["a"],VSlider:bt["a"]});var wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-navigation-drawer",{ref:"side_window",attrs:{app:"",right:"",width:t.width},model:{value:t.shown,callback:function(e){t.shown=e},expression:"shown"}},[t._t("default")],2)},yt=[],_t={name:"SideWindow",data:function(){return{width:300,shown:!0,borderSize:3}},methods:{setBorderWidth:function(){var t=this.$refs.side_window.$el.querySelector(".v-navigation-drawer__border");t.style.width="".concat(this.borderSize,"px"),t.style.cursor="ew-resize"},setEvents:function(){var t=this.borderSize+300,e=this.$refs.side_window.$el,n=e.querySelector(".v-navigation-drawer__border"),a=this,i=e.classList.contains("v-navigation-drawer--right")?"right":"left";function o(t){document.body.style.cursor="ew-resize";var n="right"===i?document.body.scrollWidth-t.clientX:t.clientX;e.style.width="".concat(n,"px")}n.addEventListener("mousedown",(function(n){n.offsetX<t&&(e.style.transition="initial",document.addEventListener("mousemove",o,!1))}),!1),document.addEventListener("mouseup",(function(){e.style.transition="",a.width=e.style.width,document.body.style.cursor="",document.removeEventListener("mousemove",o,!1)}),!1)}},mounted:function(){this.setBorderWidth(),this.setEvents()}},xt=_t,Ct=n("f774"),Vt=Object(l["a"])(xt,wt,yt,!1,null,"12d46b9c",null),Tt=Vt.exports;u()(Vt,{VNavigationDrawer:Ct["a"]});var St=function(){var t=this,e=t.$createElement,n=t._self._c||e;return null!=t.value?n("v-card",{attrs:{id:"region-"+t.value.id,"min-width":"200",outlined:""}},["idle"===t.value.state?n("AnnotationIdleCard",{on:{peep:t.peep,"edit-annotation":t.editRegion,"dismiss-annotation":t.dismissAnnotation},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}):"editing"===t.value.state?n("AnnotationEditingCard",{on:{peep:t.peep,"cancel-edit":t.cancelEdit,"annotation-update":t.updateRender,"save-annotation":t.saveAnnotation},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}):"importing"===t.value.state?n("AnnotationImportingCard",{on:{peep:t.peep,"dismiss-annotation":t.dismissAnnotation,"annotation-update":t.updateRender,"import-annotation":t.importAnnotation},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}):"feedback"===t.value.state||"feedback-editing"===t.value.state?n("AnnotationFeedbackCard",{on:{peep:t.peep,"annotation-update":t.updateRender,"annotation-feedback":t.annotationFeedback},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}):t._e()],1):t._e()},jt=[],At=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-card-title",{staticClass:"title-nowrap"},[n("v-avatar",{staticClass:"mr-2",attrs:{size:"18",color:t.labelColor}}),n("span",[t._v(t._s(t.cardTitle))])],1),null!=t.value.description?n("v-card-text",[t._v("\n    "+t._s(t.value.description)+"\n  ")]):n("v-card-text",[n("a",{attrs:{href:"javascript:void(0)"},on:{click:t.editProperties}},[t._v("Edit properties")])]),n("v-divider"),n("v-card-actions",[n("v-btn",{attrs:{icon:""},on:{click:t.peep}},[n("v-icon",[t._v("mdi-eye")])],1),n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:t.dismissAnnotation}},[t._v("Remove")]),n("v-btn",{attrs:{text:""},on:{click:function(e){return t.editRegion(t.value)}}},[t._v("Edit")])],1)],1)},Pt=[],Lt={name:"AnnotationIdleCard",computed:{cardTitle:function(){return null!=this.value.title&&""!==this.value.title?this.value.title:this.value.label.name},labelColor:function(){var t=this.value.label.color;return"rgb(".concat(t[0],",").concat(t[1],",").concat(t[2],")")}},methods:{editRegion:function(t){this.updating_label=!0,J["c"].getInstance().editAnnotation(t)},dismissAnnotation:function(){this.updating_label=!1,this.$emit("dismiss-annotation",this.value)},peep:function(){J["c"].getInstance().peepAnnotation(this.value)},editProperties:function(){}},props:{value:{type:J["a"]}}},$t=Lt,Et=n("2fa4"),Ot=Object(l["a"])($t,At,Pt,!1,null,"75b186ef",null),It=Ot.exports;u()(Ot,{VAvatar:dt["a"],VBtn:C["a"],VCardActions:T["a"],VCardText:T["b"],VCardTitle:T["c"],VDivider:S["a"],VIcon:j["a"],VSpacer:Et["a"]});var Dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-card-title",{staticClass:"title-nowrap"},[n("v-avatar",{staticClass:"mr-2",attrs:{size:"18",color:t.genColor(t.value.label.color)}}),n("v-text-field",{attrs:{label:"Annotation title"},model:{value:t.value.title,callback:function(e){t.$set(t.value,"title",e)},expression:"value.title"}})],1),n("v-card-text",{on:{click:function(t){t.stopPropagation()}}},[n("v-text-field",{attrs:{label:"Description"},model:{value:t.value.description,callback:function(e){t.$set(t.value,"description",e)},expression:"value.description"}}),n("v-chip-group",{attrs:{mandatory:"",column:""},model:{value:t.selectedLabel,callback:function(e){t.selectedLabel=e},expression:"selectedLabel"}},t._l(t.projectLabels,(function(e){return n("v-chip",{key:e.id,attrs:{color:t.genColor(e.color),outlined:"",filter:"",value:e.id}},[t._v("\n        "+t._s(e.name)+"\n      ")])})),1)],1),n("v-divider"),n("v-card-actions",[n("v-btn",{attrs:{icon:""},on:{click:t.peep}},[n("v-icon",[t._v("mdi-eye")])],1),n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:t.cancelEdit}},[t._v("Cancel")]),n("v-btn",{attrs:{text:""},on:{click:t.saveRegion}},[t._v("Save")])],1)],1)},Ft=[],Rt={name:"AnnotationEditingCard",watch:{"value.label":{immediate:!0,handler:function(t){this.selectedLabel=t.id}},selectedLabel:function(t){this.value.label=this.projectLabels[t],this.updateRender()}},computed:{cardTitle:function(){return null!=this.value.title&&""!==this.value.title?this.value.title:this.value.label.name},projectLabels:function(){for(var t={},e=this.$store.state.session.task.project.labels,n=0;n<e.length;n+=1)t[e[n].id]=e[n];return t}},data:function(){return{selectedLabel:null}},methods:{genColor:function(t){return"rgb(".concat(t[0],",").concat(t[1],",").concat(t[2],")")},editRegion:function(){this.$emit("edit-annotation",this.value)},saveRegion:function(){this.$emit("save-annotation",this.value)},cancelEdit:function(){this.$emit("cancel-edit")},dismissAnnotation:function(){this.$emit("dismiss-annotation",this.value)},updateRender:function(){this.$emit("annotation-update")},peep:function(){this.$emit("peep",this.value)}},mounted:function(){},props:{value:{type:J["a"]}}},Ut=Rt,Mt=Object(l["a"])(Ut,Dt,Ft,!1,null,"7ab55195",null),Bt=Mt.exports;u()(Mt,{VAvatar:dt["a"],VBtn:C["a"],VCardActions:T["a"],VCardText:T["b"],VCardTitle:T["c"],VChip:D["a"],VChipGroup:F["a"],VDivider:S["a"],VIcon:j["a"],VSpacer:Et["a"],VTextField:H["a"]});var zt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-card-title",{staticClass:"title-nowrap"},[n("v-avatar",{staticClass:"mr-2",attrs:{size:"18",color:t.genColor(t.value.label.color)}}),n("span",[t._v(t._s(t.cardTitle))])],1),t.updatingLabel?n("v-card-text",{on:{click:function(t){t.stopPropagation()}}},[n("v-chip-group",{attrs:{mandatory:"",column:""},model:{value:t.feedbackLabelId,callback:function(e){t.feedbackLabelId=e},expression:"feedbackLabelId"}},t._l(t.projectLabels,(function(e){return n("v-chip",{key:e.id,attrs:{color:t.genColor(e.color),outlined:"",filter:"",value:e.id}},[t._v("\n        "+t._s(e.name)+"\n      ")])})),1)],1):t._e(),null!=t.value.feedback.id?n("v-card-text",[0===t.value.feedback.feedback?n("div",[n("v-icon",[t._v("mdi-check")]),t._v("\n      Correct annotation\n    ")],1):n("div",[n("p",{staticClass:"ma-0"},[t._v("\n        "+t._s(t.feedback[t.value.feedback.feedback])+"\n      ")]),n("p",{staticClass:"ma-0"},[t._v("Correct label:\n        "),n("v-avatar",{staticClass:"ml-2 mr-1",attrs:{size:"16",color:t.genColor(t.feedbackLabel.color)}}),t._v("\n        "+t._s(t.feedbackLabel.name)+"\n      ")],1),null!=t.value.feedback.geometry?n("p",{staticClass:"ma-0"},[n("v-checkbox",{staticClass:"ma-0",attrs:{label:"Show geometry correction","hide-details":""},on:{change:t.annotationUpdate},model:{value:t.value.drawFeedback,callback:function(e){t.$set(t.value,"drawFeedback",e)},expression:"value.drawFeedback"}})],1):t._e()])]):t._e(),n("v-divider"),n("v-card-actions",[n("v-btn",{attrs:{icon:""},on:{click:t.peep}},[n("v-icon",[t._v("mdi-eye")])],1),n("v-spacer"),t.updatingLabel?n("div",[n("v-btn",{attrs:{text:""},on:{click:t.cancelEdit}},[t._v("Cancel")]),n("v-btn",{attrs:{text:""},on:{click:t.saveFeedback}},[t._v("Save")])],1):null==t.value.feedback.id||t.undoing?n("div",[n("v-menu",{scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,i=e.attrs;return[n("v-btn",t._g(t._b({attrs:{text:""}},"v-btn",i,!1),a),[t._v("Incorrect")])]}}])},[n("v-list",t._l(t.incorrectOptions,(function(e,a){return n("v-list-item",{key:a,on:{click:e.func}},[n("v-list-item-title",[t._v(t._s(e.text))])],1)})),1)],1),n("v-btn",{attrs:{text:""},on:{click:t.feedbackCorrect}},[t._v("Correct")])],1):null!=t.value.feedback.id?n("div",[n("v-btn",{attrs:{text:""},on:{click:function(e){t.undoing=!0}}},[t._v("Undo")])],1):t._e()],1)],1)},Wt=[],Ht={name:"AnnotationFeedbackCard",watch:{value:{immediate:!0,handler:function(t){null!=t.feedback.label_id?this.feedbackLabelId=t.feedback.label_id:this.feedbackLabelId=t.label.id}},"value.state":function(t,e){"feedback-editing"===e&&"feedback"===t&&(this.updatingLabel=!1)},"value.feedback.label_id":function(){this.annotationUpdate()},feedbackLabelId:function(t){this.value.feedback.label_id=t,this.annotationUpdate()}},computed:{cardTitle:function(){return null!=this.value.title&&""!==this.value.title?this.value.title:this.value.label.name},projectLabels:function(){for(var t={},e=this.$store.state.session.task.project.labels,n=0;n<e.length;n+=1)t[e[n].id]=e[n];return t},feedbackLabel:function(){return null!=this.value.feedback&&null!=this.value.feedback.label_id?this.projectLabels[this.value.feedback.label_id]:this.projectLabels[this.value.label.id]}},data:function(){return{incorrectOptions:[{text:"Wrong label",func:this.feedbackWrongLabel},{text:"Wrong region",func:this.feedbackWrongRegion}],feedbackLabelId:null,updatingLabel:!1,currentFeedback:null,undoing:!1,feedback:["â Correct","â Wrong label","â Wrong region"]}},methods:{genColor:function(t){return"rgb(".concat(t[0],",").concat(t[1],",").concat(t[2],")")},annotationUpdate:function(){var t=this;this.$nextTick((function(){t.$emit("annotation-update")}))},editRegion:function(t){this.updatingLabel=!0,this.$emit("edit-region",t)},saveFeedback:function(){this.updatingLabel=!1,"wrong-label"===this.currentFeedback?this.value.feedback.feedback=1:"wrong-region"===this.currentFeedback&&(this.value.feedback.feedback=2),this.$emit("annotation-feedback",this.currentFeedback,this.value)},cancelEdit:function(){this.updatingLabel=!1,this.$emit("cancel-edit")},dismissAnnotation:function(){this.$emit("dismiss-annotation",this.value)},peep:function(){this.$emit("peep",this.value)},feedbackWrongLabel:function(){!1===this.updatingLabel&&(this.undoing=!1,this.currentFeedback="wrong-label",this.updatingLabel=!0,this.value.feedback.feedback=1)},feedbackWrongRegion:function(){!1===this.updatingLabel&&(this.undoing=!1,this.updatingLabel=!0,this.currentFeedback="wrong-region",this.$emit("annotation-feedback","edit-region",this.value))},feedbackCorrect:function(){this.undoing=!1,this.$emit("annotation-feedback","correct",this.value)}},props:{value:{type:J["a"]}}},Nt=Ht,Gt=Object(l["a"])(Nt,zt,Wt,!1,null,"3745115c",null),qt=Gt.exports;u()(Gt,{VAvatar:dt["a"],VBtn:C["a"],VCardActions:T["a"],VCardText:T["b"],VCardTitle:T["c"],VCheckbox:I["a"],VChip:D["a"],VChipGroup:F["a"],VDivider:S["a"],VIcon:j["a"],VList:ht["a"],VListItem:vt["a"],VListItemTitle:ft["d"],VMenu:mt["a"],VSpacer:Et["a"]});var Xt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.value.currentlyImporting?n("span",{staticClass:"importing-pending-warning"},[t._v("\n    Pending import\n\n  ")]):t._e(),n("v-card-title",{staticClass:"title-nowrap"},[n("v-avatar",{staticClass:"mr-2",attrs:{size:"18",color:t.genColor(t.value.label.color)}}),n("v-text-field",{attrs:{label:"Annotation title"},model:{value:t.value.title,callback:function(e){t.$set(t.value,"title",e)},expression:"value.title"}})],1),n("v-card-text",{on:{click:function(t){t.stopPropagation()}}},[n("v-text-field",{attrs:{label:"Description"},model:{value:t.value.description,callback:function(e){t.$set(t.value,"description",e)},expression:"value.description"}}),n("v-chip-group",{attrs:{mandatory:"",column:""},on:{change:t.annotationUpdate},model:{value:t.selectedLabel,callback:function(e){t.selectedLabel=e},expression:"selectedLabel"}},t._l(t.projectLabels,(function(e){return n("v-chip",{key:e.id,attrs:{color:t.genColor(e.color),outlined:"",filter:"",value:e.id}},[t._v("\n        "+t._s(e.name)+"\n      ")])})),1)],1),n("v-divider"),n("v-card-actions",[n("v-btn",{attrs:{icon:""},on:{click:t.peep}},[n("v-icon",[t._v("mdi-eye")])],1),n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:function(e){return e.preventDefault(),t.dismissAnnotation.apply(null,arguments)}}},[t._v("Dismiss")]),n("v-btn",{attrs:{text:""},on:{click:function(e){return e.preventDefault(),t.importAnnotation.apply(null,arguments)}}},[t._v("Import")])],1)],1)},Yt=[],Jt={name:"AnnotationIdleCard",watch:{"value.label":{immediate:!0,handler:function(t){this.selectedLabel=t.id}},selectedLabel:function(t){this.value.label=this.projectLabels[t],this.annotationUpdate()}},computed:{cardTitle:function(){return null!=this.value.title&&""!==this.value.title?this.value.title:this.value.label.name},projectLabels:function(){for(var t={},e=this.$store.state.session.task.project.labels,n=0;n<e.length;n+=1)t[e[n].id]=e[n];return t}},data:function(){return{selectedLabel:null}},methods:{genColor:function(t){return"rgb(".concat(t[0],",").concat(t[1],",").concat(t[2],")")},importAnnotation:function(){this.$emit("import-annotation",this.value)},dismissAnnotation:function(){this.$emit("dismiss-annotation",this.value)},annotationUpdate:function(){var t=this;this.$nextTick((function(){t.$emit("annotation-update")}))},peep:function(){this.$emit("peep",this.value)}},props:{value:{type:J["a"]}}},Kt=Jt,Zt=Object(l["a"])(Kt,Xt,Yt,!1,null,"4808784e",null),Qt=Zt.exports;u()(Zt,{VAvatar:dt["a"],VBtn:C["a"],VCardActions:T["a"],VCardText:T["b"],VCardTitle:T["c"],VChip:D["a"],VChipGroup:F["a"],VDivider:S["a"],VIcon:j["a"],VSpacer:Et["a"],VTextField:H["a"]});var te={name:"AnnotationCard",components:{AnnotationFeedbackCard:qt,AnnotationEditingCard:Bt,AnnotationImportingCard:Qt,AnnotationIdleCard:It},computed:{task_type:function(){return this.$store.state.session.type},project_labels:function(){for(var t={},e=this.$store.state.session.task.project.labels,n=0;n<e.length;n+=1)t[e[n].id]=e[n];return t}},watch:{value:{immediate:!0,handler:function(t){null!=t&&(this.originalLabel=it.a.cloneDeep(t.label),t.currentlyImporting&&(this.updating_label=!0))}},editing:{handler:function(t){null==t&&this.value.currentlyImporting&&(this.updating_label=!1)}}},data:function(){return{}},methods:{updateRender:function(){this.$emit("annotation-update")},peep:function(){this.$emit("annotation-peep",this.value)},undo:function(){this.drawing_swapped&&this.swapDrawings(),this.undoing_feedback=!0},annotationFeedback:function(t,e){this.$emit("annotation-feedback",t,e)},swapDrawings:function(){this.drawing_swapped?this.value.geometry=this.originalRegion:(this.originalRegion=this.value.geometry,this.value.geometry=this.value.feedback.geometry),this.drawing_swapped=!this.drawing_swapped,this.$emit("annotation-update")},genColor:function(t){return"rgb(".concat(t[0],",").concat(t[1],",").concat(t[2],")")},feedbackWrongLabel:function(){this.undoing_feedback=!1,this.$emit("annotation-feedback","wrong-label",this.value)},feedbackWrongRegion:function(){this.drawing_swapped&&(this.value.geometry=this.originalRegion,this.drawing_swapped=!1),this.$emit("annotation-feedback","wrong-region",this.value),this.undoing_feedback=!1},feedbackCorrect:function(){this.$emit("annotation-feedback","correct",this.value),this.undoing_feedback=!1},editRegion:function(t){this.updating_label=!0,this.$emit("edit-annotation",t)},saveAnnotation:function(t){this.updating_label=!1,this.$emit("save-annotation",t)},cancelEdit:function(){this.updating_label=!1,this.$emit("cancel-edit")},importAnnotation:function(){this.$emit("import-annotation",this.value)},dismissAnnotation:function(){this.updating_label=!1,this.$emit("dismiss-annotation",this.value)}},props:{editing:{type:Boolean},value:{type:J["a"]}}},ee=te,ne=(n("5739"),Object(l["a"])(ee,St,jt,!1,null,"581f2eed",null)),ae=ne.exports;u()(ne,{VCard:V["a"]});var ie=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-card-title",[t._v("Annotation stats")]),null!=t.stats?n("v-card-text",[n("div",{staticClass:"link-container"},[n("a",{class:"link "+("area"===t.stat?"selected":""),on:{click:function(e){return t.switchMode("area","area_perc")}}},[t._v("Area (all)")]),n("a",{class:"link "+("count"===t.stat?"selected":""),on:{click:function(e){return t.switchMode("count","count_perc")}}},[t._v("Count\n        (all)")]),n("a",{class:"link "+("desc"===t.stat?"selected":""),on:{click:function(e){return t.switchMode("desc","desc_perc")}}},[t._v("Count\n        (comments)")]),n("a",{class:"link "+("certain_area"===t.stat?"selected":""),on:{click:function(e){return t.switchMode("certain_area","certain_area_perc")}}},[t._v("Area (not including comments)")])]),t._l(Object.keys(t.stats),(function(e){return n("div",[n("span",[t._v(t._s(e)+" ("+t._s(t.stats[e][t.stat])+")")]),n("v-progress-linear",{attrs:{value:100*t.stats[e][t.statPerc],color:t.genColor(t.stats[e].color),readonly:!0}})],1)}))],2):n("v-card-text",[t._v("\n    Stats currently unavailable.\n  ")]),n("v-divider"),n("v-card-actions",[n("v-switch",{staticClass:"ma-0",attrs:{"hide-details":"",label:"Slide only stats"},model:{value:t.slideOnly,callback:function(e){t.slideOnly=e},expression:"slideOnly"}})],1)],1)},oe=[],se={name:"SessionClassBalance",watch:{sessionId:function(){this.refresh()},slideId:function(){this.slideOnly&&this.refresh()},slideOnly:function(){this.refresh()}},data:function(){return{stats:null,stat:"area",statPerc:"area_perc",slideOnly:!1}},methods:{genColor:function(t){return"rgb(".concat(t[0],", ").concat(t[1],", ").concat(t[2],")")},switchMode:function(t,e){this.stat=t,this.statPerc=e},refresh:function(){var t=this;this.$post("session/".concat(this.sessionId,"/").concat(this.slideOnly?this.slideId:"all","/class_balance")).then((function(e){t.stats=e})).catch((function(t){return alert(t)}))}},mounted:function(){this.refresh()},props:["sessionId","slideId"]},re=se,le=(n("2eea"),n("b73d")),ce=Object(l["a"])(re,ie,oe,!1,null,"04e5cff2",null),ue=ce.exports;u()(ce,{VCard:V["a"],VCardActions:T["a"],VCardText:T["b"],VCardTitle:T["c"],VDivider:S["a"],VProgressLinear:A["a"],VSwitch:le["a"]});var de=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("div",{staticClass:"pa-3 pb-0 text-h6 text--primary"},[t._v("ML annotations analysis")]),n("div",{staticClass:"pl-3 pr-3 text-center font-weight-thin card-description"},[t._v("\n    Overlay your annotations with ML-based predictions to improve your models.\n  ")]),t.usedBefore?n("div",{staticClass:"pl-3 pr-3 pb-3"},[n("div",{staticClass:"flex-container"},[n("v-slider",{staticClass:"pl-2 pr-2",staticStyle:{width:"50%"},attrs:{"hide-details":"","prepend-icon":"mdi-circle-opacity",step:"0","thumb-label":"",min:"0.0",max:"1"},scopedSlots:t._u([{key:"thumb-label",fn:function(e){var n=e.value;return[t._v("\n          "+t._s(n.toFixed(2))+"\n        ")]}}]),model:{value:t.drawingStyle.fillOpacity,callback:function(e){t.$set(t.drawingStyle,"fillOpacity",e)},expression:"drawingStyle.fillOpacity"}}),n("v-slider",{staticClass:"pl-2 pr-2",staticStyle:{width:"50%"},attrs:{"hide-details":"","prepend-icon":"mdi-format-line-weight",step:"1","thumb-label":"",min:"0",max:"5"},scopedSlots:t._u([{key:"thumb-label",fn:function(e){var n=e.value;return[t._v("\n          "+t._s(n.toFixed(2))+"\n        ")]}}]),model:{value:t.drawingStyle.lineWidth,callback:function(e){t.$set(t.drawingStyle,"lineWidth",e)},expression:"drawingStyle.lineWidth"}})],1),n("v-divider"),n("v-btn",{attrs:{block:"",text:""},on:{click:t.clearOverlay}},[t._v("Clear overlay")])],1):n("div",{staticClass:"pl-3 pr-3 pb-3"},[n("input",{staticStyle:{display:"none"},attrs:{id:"ml-file-importer-input",type:"file"}}),n("v-btn",{attrs:{block:"",text:""},on:{click:t.selectFile}},[t._v("Select .geojson file")])],1)])},he=[],ve={name:"MLPredictionsOverlapTool",watch:{drawingStyle:{deep:!0,handler:function(){this.$emit("style-changed",this.drawingStyle)}}},data:function(){return{usedBefore:!1,drawingStyle:{fillOpacity:.3,lineWidth:1,hoverOpacity:.3}}},methods:{clearOverlay:function(){this.$emit("clear-overlay",null),this.usedBefore=!1},selectFile:function(){var t=this,e=document.getElementById("ml-file-importer-input");e.onchange=function(e){var n=new FileReader;n.readAsText(e.target.files[0],"UTF-8"),n.onload=function(e){var n=JSON.parse(e.target.result),a=t.currentSlide.id,i=n.features.map((function(t,e){var n=t.geometry,i=null!=t.properties.label?t.properties.label:{color:[0,0,0],name:"ML Annotation"},o=null!=t.properties.description?t.properties.description:null;return{id:"ai-annotation-".concat(e),label:i,description:o,geometry:{type:"polygon",points:Object(J["e"])(n.coordinates[0].map((function(t){return{x:t[0],y:t[1]}})))},slide_id:a,layer:1,state:"overlay"}}));t.$emit("annotations",Object(J["d"])({0:i})[0]),t.usedBefore=!0}},e.click()}},props:["currentSlide"]},pe=ve,fe=(n("bbd4"),Object(l["a"])(pe,de,he,!1,null,"5d34e24f",null)),me=fe.exports;u()(fe,{VBtn:C["a"],VCard:V["a"],VDivider:S["a"],VSlider:bt["a"]});var be={name:"Session",computed:{annotationImportingEnabled:function(){return!this.completed&&(0===this.session.type||2===this.session.type)&&this.taskBelongsToUser},annotationTabVisible:function(){return null!=this.annotations[this.currentSlide.id]&&this.annotations[this.currentSlide.id].length>0},session_id:function(){return this.$route.params.session_id},tile_sources:function(){return"".concat("/api/","session/").concat(this.session_id,"/").concat(this.currentSlide.id,".dzi")},project_labels:function(){return this.$store.state.session.task.project.labels},session:function(){return this.$store.state.session},slides:function(){var t=this.$store.state.session;return 1!==t.type?t.task.slides:t.task.task.slides},revisions:function(){for(var t=[],e=this.$store.state.session.task.revisions,n=this.$store.state.session.revision,a=0;a<e.length;a+=1)t.push({id:e[a].id,user:null!=e[a].user?e[a].user.name:e[a].app.name,annotations:n[e[a].id],selected:!1});return t},taskBelongsToUser:function(){return 2===this.task_type?this.session.app.owner.id===this.$store.state.user.id:this.session.user.id===this.$store.state.user.id},task_type:function(){return this.$store.state.session.type},annotationsListStart:function(){return(this.annotationsLister.page-1)*this.annotationsLister.max}},watch:{session:{immediate:!0,handler:function(t){0===t.task.type||2===t.task.type?(this.annotations=Object(J["d"])(t.labelled),this.currentSlide=t.task.slides[0],this.calculatePagination()):1===t.task.type&&(this.annotations={},this.currentSlide=t.task.task.slides[0])}},project_labels:{immediate:!0,deep:!0,handler:function(t){for(var e=0;e<t.length;e+=1)this.$set(this.labelsVisible,t[e].name,!0)}},"annotationsLister.page":function(t){var e=this.annotations[this.currentSlide.id].length,n=e-(t-1)*this.annotationsLister.max;this.annotationsLister.pageMax=Math.min(this.annotationsLister.max,n)},"session.completed":function(t){var e=this;this.$get("task/completed?id=".concat(this.session.id,"&completed=").concat(t)).catch((function(t){e.session.completed=!e.session.completed,alert(t)}))},revisingUserTask:{handler:function(t){var e=this;if("none"!==t){var n=this.$store.state.session.revision[t];this.annotations=Object(J["d"])(n),this.calculatePagination()}else{var a={};this.slides.forEach((function(t){a[t.id]=[]})),this.annotations=a,this.calculatePagination()}this.$nextTick((function(){e.annotationUpdate()}))}},currentSlide:function(){this.calculatePagination()}},data:function(){var t=this;return{currentSlide:null,annotations:{},selectedTab:0,labelsVisible:{},annotationsLister:{page:1,totalPages:1,pageMax:10,max:10},drawingStyle:[{fillOpacity:.2,lineWidth:2,hoverOpacity:.5,showImporting:!0},{fillOpacity:.2,lineWidth:2}],revisingUserTask:"none",highlightOnTab:!1,confirmingImportAnnotations:!1,draw_events:{onHover:t.onRegionHover,onLeave:t.onRegionLeave,onClick:t.regionClicked}}},methods:{onOverlayAnnotations:function(t){this.$refs.slice_viewer.loadOverlayAnnotations(t)},onClearOverlayAnnotations:function(){console.log("onClearOverlayAnnotations","Session"),this.$refs.slice_viewer.clearOverlayAnnotations()},onOverlayStyleChanged:function(t){this.drawingStyle[1]=t},labelAnnotationsVisibility:function(t){var e=this;this.project_labels.forEach((function(n){e.labelsVisible[n.name]=t}))},calculatePagination:function(){if(this.currentSlide.id in this.annotations){var t=this.annotations[this.currentSlide.id].length;this.annotationsLister.totalPages=Math.floor(t/this.annotationsLister.max),1!==this.annotationsLister.page&&(this.annotationsLister.page=1)}else this.annotationsLister.totalPages=0,this.annotationsLister.page=0},saveFeedback:function(t){this.$post("session/".concat(this.session_id,"/annotation_feedback"),t.serialize()).then((function(e){t.feedback.id=e.feedback.id})).catch((function(t){return alert(t)}))},onRegionHover:function(t){if(this.highlightOnTab){var e=document.getElementById("region-".concat(t.id));if(null==e)return;this.selectedTab=1,e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("hovered")}},onRegionLeave:function(t){var e=document.getElementById("region-".concat(t.id));null!=e&&e.classList.remove("hovered")},genColor:function(t){return"rgb(".concat(t[0],",").concat(t[1],",").concat(t[2],")")},onNewRegionDraw:function(t){var e=this;t.id=null,t.slideId=this.currentSlide.id;var n=this;this.$post("session/".concat(this.session_id,"/add_region"),t.serialize()).then((function(a){t.id=a.id,t.state="idle",t.updateImageLocation(),n.annotations[n.currentSlide.id].push(t),n.annotationUpdate(),e.$refs.classBalance.refresh(),e.calculatePagination(),e.$toast("Successfully saved annotation",{timeout:1e3})})).catch((function(t){alert("Error while saving region: ".concat(t))}))},onEditRegionDraw:function(t){var e=this;0===this.task_type?(this.editing=null,this.$post("session/".concat(this.session_id,"/edit_region"),t.serialize()).then((function(){e.$refs.classBalance.refresh()})).catch((function(t){alert("Error while saving region: ".concat(t))}))):1===this.task_type&&(t.feedback.feedback=2,this.saveFeedback(t),this.calculatePagination())},regionClicked:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.selectedTab=1;var a=this.navigateAnnotationPage(t);if(a&&0===this.attempted)this.attempted=1,this.$nextTick((function(){e.regionClicked(t,n)}));else{this.attempted=0;var i=document.getElementById("region-".concat(t.id));null==i?setTimeout((function(){document.getElementById("region-".concat(t.id)).scrollIntoView({behavior:"smooth",block:"center"})}),250):(i.scrollIntoView({behavior:"smooth",block:"center"}),i.classList.add("highlighted"),n&&i.classList.add("short"),setTimeout((function(){i.classList.remove("highlighted"),i.classList.remove("short")}),n?250:3e3))}},navigateAnnotationPage:function(t){var e=this.annotations[this.currentSlide.id].indexOf(t),n=Math.ceil(e/this.annotationsLister.max);return n!==this.annotationsLister.page&&(this.annotationsLister.page=n,!0)},importAnnotations:function(){var t=this,e=document.getElementById("file-importer-input");e.onchange=function(e){var n=new FileReader;n.readAsText(e.target.files[0],"UTF-8"),n.onload=function(e){var n,a=JSON.parse(e.target.result),i=t.currentSlide.id,o=a.features.map((function(t,e){var n=t.geometry,a=null!=t.properties.label?t.properties.label:{color:[0,0,0],name:"Imported annotation"},o=null!=t.properties.description?t.properties.description:null;return{id:"import-".concat(e),label:a,description:o,geometry:{type:"polygon",points:Object(J["e"])(n.coordinates[0].map((function(t){return{x:t[0],y:t[1]}})))},slide_id:i,state:"importing"}}));t.confirmingImportAnnotations=!0;var s=Object(J["d"])({0:o})[0];(n=t.annotations[i]).push.apply(n,Object(Y["a"])(s)),t.calculatePagination(),t.annotationUpdate()}},e.click()},importAll:function(){var t=this.annotations[this.currentSlide.id].filter((function(t){return"importing"===t.state&&null!=t.label.id})).map((function(t){return t.serialize()}));this.$post("session/".concat(this.session_id,"/").concat(this.currentSlide.id,"/importing"),t).then((function(t){alert(t)})).catch((function(t){return alert(t)}))},dismissAll:function(){this.annotations[this.currentSlide.id]=this.annotations[this.currentSlide.id].filter((function(t){return"importing"!==t.state})),this.confirmingImportAnnotations=!1},editRegion:function(t){},concludeEdit:function(t){this.$refs.slice_viewer.concludeEdit(t)},cancelEdit:function(){this.$refs.slice_viewer.cancelEdit(),this.editing=null},annotationPeep:function(t){},annotationUpdate:function(){this.$refs.slice_viewer.update()},annotationFeedback:function(t,e){switch(t){case"correct":e.feedback.feedback=0,e.feedback.geometry=null,e.feedback.label_id=null,this.saveFeedback(e);break;case"wrong-label":this.saveFeedback(e);break;case"edit-region":this.editRegion(e);break;case"wrong-region":this.concludeEdit(e);break;default:break}},dismissAnnotation:function(t){var e=this;"importing"===t.state?this.annotations[this.currentSlide.id]=this.annotations[this.currentSlide.id].filter((function(e){return e!==t})):confirm("Are you sure you want to remove this annotation?")&&this.$post("session/".concat(this.session_id,"/remove_annotation"),t.serialize()).then((function(){e.annotations[e.currentSlide.id]=e.annotations[e.currentSlide.id].filter((function(e){return e.id!==t.id})),e.annotationUpdate(),e.calculatePagination()})).catch((function(t){return alert(t)}))}},mounted:function(){var t=this;J["c"].getInstance().register("session",{annotationClicked:function(t){},peepAnnotation:function(e){console.log("Receive event for peeping annotation",e),t.$refs.slice_viewer.peepAnnotation(e)},editAnnotation:function(e){console.log("Received event for editing annotation",e),t.editing=e}})},components:{MLPredictionsOverlapTool:me,SessionClassBalance:ue,AnnotationCard:ae,SideWindow:Tt,SliceViewer:kt}},ge=be,ke=(n("1c7c"),n("0e8f")),we=n("a722"),ye=n("1baa"),_e=n("891e"),xe=n("67b6"),Ce=n("43a6"),Ve=n("71a3"),Te=n("c671"),Se=n("fe57"),je=n("aac8"),Ae=n("71d9"),Pe=n("2a7f"),Le=Object(l["a"])(ge,q,X,!1,null,"279921cc",null),$e=Le.exports;u()(Le,{VBtn:C["a"],VCard:V["a"],VCardTitle:T["c"],VContainer:U["a"],VDivider:S["a"],VFlex:ke["a"],VLayout:we["a"],VList:ht["a"],VListItem:vt["a"],VListItemContent:ft["b"],VListItemGroup:ye["a"],VListItemSubtitle:ft["c"],VListItemTitle:ft["d"],VPagination:_e["a"],VRadio:xe["a"],VRadioGroup:Ce["a"],VSlider:bt["a"],VSwitch:le["a"],VTab:Ve["a"],VTabItem:Te["a"],VTabs:Se["a"],VTabsItems:je["a"],VToolbar:Ae["a"],VToolbarTitle:Pe["b"]});var Ee=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",[n("v-expansion-panels",{attrs:{multiple:""}},[n("v-row",[t.user.manages_tasks?n("v-col",{attrs:{sm:"12"}},[n("v-expansion-panel",[n("v-expansion-panel-header",[n("v-toolbar-title",{staticClass:"title"},[t._v("Tasks")])],1),n("v-expansion-panel-content",[n("v-data-table",{attrs:{headers:t.tasksHeader,items:t.tasks[t.task_type],"items-per-page":5,search:t.taskFilter.name,"custom-filter":t.annotationTaskFiltering},scopedSlots:t._u([{key:"top",fn:function(){return[n("v-row",{staticClass:"ma-0 pa-0"},[n("v-col",{staticClass:"ma-0 pa-0",attrs:{md:"4"}},[n("v-text-field",{staticClass:"mx-4",attrs:{label:"Search for slide's name"},model:{value:t.taskFilter.name,callback:function(e){t.$set(t.taskFilter,"name",e)},expression:"taskFilter.name"}})],1),null!=t.projects?n("v-col",{staticClass:"ma-0",attrs:{md:"8"}},[n("v-chip-group",{staticClass:"mr-2 ml-2",attrs:{column:""},model:{value:t.taskFilter.project,callback:function(e){t.$set(t.taskFilter,"project",e)},expression:"taskFilter.project"}},[n("v-chip",{attrs:{filter:"",value:null,color:"orange"}},[t._v("\n                        All projects\n                      ")]),t._l(t.projects,(function(e){return n("v-chip",{key:e.id,attrs:{filter:"",value:e.name}},[t._v("\n                        "+t._s(e.name)+"\n                      ")])}))],2)],1):t._e()],1),n("v-row",{staticClass:"mt-0"},[n("v-col",{staticClass:"pt-0 pb-0",attrs:{md:"12"}},[n("v-chip-group",{staticClass:"mr-2 ml-2 mb-2",attrs:{column:""},model:{value:t.taskFilter.user,callback:function(e){t.$set(t.taskFilter,"user",e)},expression:"taskFilter.user"}},[n("v-chip",{attrs:{filter:"",value:null,color:"orange"}},[t._v("\n                        Anyone\n                      ")]),t._l(t.users,(function(e){return n("v-chip",{key:e.id,attrs:{filter:"",value:e.name}},[t._v("\n                        "+t._s(e.name)+"\n                      ")])}))],2)],1)],1),n("v-tabs",{model:{value:t.task_type,callback:function(e){t.task_type=e},expression:"task_type"}},[n("v-tab",[t._v("Annotations")]),n("v-tab",[t._v("Revisions")])],1)]},proxy:!0},{key:"item.slides",fn:function(e){var a=e.item;return[n("v-chip-group",{attrs:{column:"","show-arrows":""}},t._l(a.slides,(function(e){return n("v-chip",{staticStyle:{"pointer-events":"none"},attrs:{outlined:"",readonly:!0}},[t._v("\n                    "+t._s(e.name)+"\n                  ")])})),1)]}},{key:"item.task",fn:function(e){var a=e.item;return[n("v-chip-group",{attrs:{column:"","show-arrows":""}},t._l(a.task.slides,(function(e){return n("v-chip",{staticStyle:{"pointer-events":"none"},attrs:{outlined:"",readonly:!0}},[t._v("\n                    "+t._s(e.name)+"\n                  ")])})),1)]}},{key:"item.user_tasks",fn:function(e){var a=e.item;return[n("v-chip-group",{attrs:{column:"","show-arrows":""}},t._l(a.user_tasks,(function(e){return n("v-chip",{attrs:{readonly:!0,outlined:null==e.user,color:"primary"},on:{click:function(n){return t.openTask(e)}}},[e.completed?n("v-icon",[t._v("mdi-check")]):t._e(),t._v("\n                    "+t._s(null!=e.user?e.user.name:e.app.name)+"\n                  ")],1)})),1)]}},{key:"item.revisions",fn:function(e){var a=e.item;return[n("v-chip-group",{attrs:{"active-class":"primary--text",column:"","show-arrows":""}},t._l(a.revisions,(function(e){return n("v-chip",{attrs:{readonly:!0,dark:""},on:{click:function(n){return t.openTask(e)}}},[t._v("\n                    "+t._s(null!=e.user?e.user.name:e.app.name)+"\n                  ")])})),1)]}},{key:"item.actions",fn:function(e){var a=e.item;return[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.editTask(a)}}},[t._v("mdi-pencil")]),n("v-icon",{attrs:{small:"",disabled:a.completed},on:{click:function(e){return t.removeTask(a)}}},[t._v("\n                  mdi-delete\n                ")])]}}],null,!1,39264554)}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:t.newTask}},[t._v("New task")]),n("v-btn",{attrs:{text:""},on:{click:t.newBatch}},[t._v("New batch")])],1)],1)],1)],1):t._e(),t.user.manages_users?n("v-col",{attrs:{sm:"12"}},[n("v-expansion-panel",[n("v-expansion-panel-header",[n("v-toolbar-title",{staticClass:"title"},[t._v("Users")])],1),n("v-expansion-panel-content",[n("v-data-table",{attrs:{headers:t.config.user_headers,items:t.users,"items-per-page":5},scopedSlots:t._u([{key:"item.actions",fn:function(e){var a=e.item;return[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.editUser(a)}}},[t._v("\n                  mdi-pencil\n                ")]),n("v-icon",{attrs:{small:""},on:{click:function(e){return t.removeUser(a)}}},[t._v("mdi-delete")])]}}],null,!1,1381973006)}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:t.newUser}},[t._v("New user")])],1)],1)],1)],1):t._e(),t.user.manages_projects?n("v-col",{attrs:{sm:"12"}},[n("v-expansion-panel",[n("v-expansion-panel-header",[n("v-toolbar-title",{staticClass:"title"},[t._v("Projects")])],1),n("v-expansion-panel-content",[n("v-data-table",{attrs:{headers:t.config.project_header,items:t.projects,"items-per-page":5},scopedSlots:t._u([{key:"item.labels",fn:function(e){var a=e.item;return[n("v-chip-group",{attrs:{"show-arrows":"",column:""}},t._l(a.labels,(function(e){return n("v-chip",{staticStyle:{"pointer-events":"none"},attrs:{outlined:"",color:"rgb("+e.color[0]+", "+e.color[1]+","+e.color[2]+")",readonly:!0,dark:""}},[t._v("\n                    "+t._s(e.name)+"\n                  ")])})),1)]}},{key:"item.actions",fn:function(e){var a=e.item;return[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,o=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.showLabelData(a)}}},"v-icon",o,!1),i),[t._v("\n                      mdi-label\n                    ")])]}}],null,!0)},[n("span",[t._v("Copy label data to clipboard")])]),n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.editProject(a)}}},[t._v("\n                  mdi-pencil\n                ")]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,i=e.attrs;return[n("v-icon",t._g(t._b({attrs:{small:""}},"v-icon",i,!1),a),[t._v("mdi-delete")])]}}],null,!0)},[n("span",[t._v("Not implemented")])])]}}],null,!1,740187087)}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:t.newProject}},[t._v("New project")])],1)],1)],1)],1):t._e()],1)],1),t.drawer?n("v-navigation-drawer",{attrs:{app:"",temporary:"",stateless:"",right:"",width:"500px"},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[n("v-toolbar",[n("v-toolbar-title",[n("v-icon",{staticClass:"mr-1",attrs:{large:""},on:{click:function(e){t.drawer=!1}}},[t._v("mdi-close")]),t._v("\n        Information editor\n      ")],1)],1),n("v-container",["user"===t.mode?n("user-editor",{on:{done:t.done},model:{value:t.editing,callback:function(e){t.editing=e},expression:"editing"}}):"batch"===t.mode?n("task-batch",{on:{done:t.done},model:{value:t.editing,callback:function(e){t.editing=e},expression:"editing"}}):"project"===t.mode?n("project-editor",{on:{done:t.done},model:{value:t.editing,callback:function(e){t.editing=e},expression:"editing"}}):"task"===t.mode?n("task-editor",{on:{done:t.done},model:{value:t.editing,callback:function(e){t.editing=e},expression:"editing"}}):t._e()],1)],1):t._e()],1)},Oe=[],Ie=(n("0cd8"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-text-field",{attrs:{label:"Name"},model:{value:t.user.name,callback:function(e){t.$set(t.user,"name",e)},expression:"user.name"}}),n("v-text-field",{attrs:{label:"Username"},model:{value:t.user.username,callback:function(e){t.$set(t.user,"username",e)},expression:"user.username"}}),n("v-text-field",{attrs:{label:"Password",type:"password"},model:{value:t.user.password,callback:function(e){t.$set(t.user,"password",e)},expression:"user.password"}}),n("v-checkbox",{attrs:{label:"Is user admin?"},model:{value:t.user.is_admin,callback:function(e){t.$set(t.user,"is_admin",e)},expression:"user.is_admin"}}),n("span",{staticClass:"title"},[t._v("User permissions")]),n("div",{staticClass:"chip-group"},[n("v-check-chip",{model:{value:t.user.manages_apps,callback:function(e){t.$set(t.user,"manages_apps",e)},expression:"user.manages_apps"}},[t._v("Manage apps")]),n("v-check-chip",{model:{value:t.user.manages_users,callback:function(e){t.$set(t.user,"manages_users",e)},expression:"user.manages_users"}},[t._v("Manage users")]),n("v-check-chip",{model:{value:t.user.manages_tasks,callback:function(e){t.$set(t.user,"manages_tasks",e)},expression:"user.manages_tasks"}},[t._v("Manage tasks")]),n("v-check-chip",{model:{value:t.user.manages_projects,callback:function(e){t.$set(t.user,"manages_projects",e)},expression:"user.manages_projects"}},[t._v("Manage projects")]),n("v-check-chip",{model:{value:t.user.can_export,callback:function(e){t.$set(t.user,"can_export",e)},expression:"user.can_export"}},[t._v("Can export annotations")]),n("v-check-chip",{model:{value:t.user.access_overview,callback:function(e){t.$set(t.user,"access_overview",e)},expression:"user.access_overview"}},[t._v("Access overview")])],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{outlined:""},on:{click:t.save}},[t._v("Save")])],1)],1)}),De=[],Fe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-chip",{attrs:{filter:"",color:t.color},on:{click:function(e){return t.$emit("input",!t.value)}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[t._t("default")],2)},Re=[],Ue={name:"VCheckChip",props:["value","color"]},Me=Ue,Be=Object(l["a"])(Me,Fe,Re,!1,null,"3d2e1610",null),ze=Be.exports;u()(Be,{VChip:D["a"]});var We={name:"UserEditor",components:{VCheckChip:ze},watch:{value:{immediate:!0,handler:function(t){this.user=it.a.cloneDeep(t)}}},data:function(){return{user:null,test:[]}},methods:{save:function(){var t=this;null!=this.user.id?this.$post("user/edit",this.user).then((function(e){t.user=e,t.$emit("input",t.user),t.$emit("done","user")})).catch((function(t){alert(t)})):this.$post("user/new",this.user).then((function(e){t.user=e,t.$emit("input",t.user),t.$emit("done","user")})).catch((function(t){alert(t)}))}},props:["value"]},He=We,Ne=(n("2a1d"),Object(l["a"])(He,Ie,De,!1,null,"d75e2dd4",null)),Ge=Ne.exports;u()(Ne,{VBtn:C["a"],VCardActions:T["a"],VCheckbox:I["a"],VSpacer:Et["a"],VTextField:H["a"]});var qe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-text-field",{attrs:{label:"Project name"},model:{value:t.project.name,callback:function(e){t.$set(t.project,"name",e)},expression:"project.name"}}),n("v-textarea",{attrs:{label:"Project description"},model:{value:t.project.description,callback:function(e){t.$set(t.project,"description",e)},expression:"project.description"}}),n("v-text-field",{attrs:{label:"Files location","error-messages":t.path_errors},on:{input:t.check_path},model:{value:t.project.folder,callback:function(e){t.$set(t.project,"folder",e)},expression:"project.folder"}}),n("v-data-table",{attrs:{headers:t.header,items:t.project.labels,"items-per-page":5},scopedSlots:t._u([{key:"item.name",fn:function(e){return[n("v-edit-dialog",{attrs:{"return-value":e.item.name},on:{"update:returnValue":function(n){return t.$set(e.item,"name",n)},"update:return-value":function(n){return t.$set(e.item,"name",n)}},scopedSlots:t._u([{key:"input",fn:function(){return[n("v-text-field",{attrs:{label:"Edit","single-line":"",counter:""},model:{value:e.item.name,callback:function(n){t.$set(e.item,"name",n)},expression:"props.item.name"}})]},proxy:!0}],null,!0)},[t._v("\n        "+t._s(e.item.name)+"\n        ")])]}},{key:"item.color",fn:function(e){var a=e.item;e.idx;return[n("v-menu",{attrs:{"offset-y":"","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,o=e.attrs;return[n("div",t._g(t._b({staticClass:"color-box",style:t.gen_color(a),on:{click:function(e){return t.change_color(a)}}},"div",o,!1),i))]}}],null,!0),model:{value:t.color_menu[a.name],callback:function(e){t.$set(t.color_menu,a.name,e)},expression:"color_menu[item.name]"}},[n("v-card",[n("v-color-picker",{attrs:{"hide-inputs":"","swatches-max-height":100,"show-swatches":""},model:{value:t.color_picked,callback:function(e){t.color_picked=e},expression:"color_picked"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){return t.closeColorPicker(a.name)}}},[t._v("Done")])],1)],1)],1)]}},{key:"item.actions",fn:function(e){var a=e.item;return[n("v-icon",{attrs:{small:""},on:{click:function(e){return t.remove_label(a)}}},[t._v("\n        mdi-delete\n      ")])]}}])}),n("v-text-field",{attrs:{filled:"",label:"New label","append-outer-icon":"add"},on:{"click:append-outer":t.add_label},model:{value:t.new_label,callback:function(e){t.new_label=e},expression:"new_label"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{outlined:""},on:{click:t.save}},[t._v("Save")])],1)],1)},Xe=[],Ye={name:"ProjectEditor",watch:{value:{immediate:!0,handler:function(t){this.project=it.a.cloneDeep(t)}},color_picked:function(t){null!=this.editing_label&&(this.editing_label.color=[t.rgba.r,t.rgba.g,t.rgba.b])}},data:function(){return{project:null,color_picked:null,color_menu:[],header:[{text:"Label",value:"name"},{text:"Color",value:"color",sortable:!1},{text:"Actions",value:"actions"}],path_errors:[],editing_label:null,new_label:null}},methods:{closeColorPicker:function(t){this.color_menu[t]=!1,this.editing_label=null,this.color_picked=null},check_path:function(t){var e=this;""===t?this.path_errors=["Path required"]:this.$post("project/valid_path",{path:t}).then((function(t){t.valid_path?e.path_errors=[]:e.path_errors=["Path not found on environment"]})).catch((function(t){return alert(t)}))},add_label:function(){null==this.project&&(this.project={labels:[]}),null==this.project.labels&&(this.project.labels=[]),this.project.labels.push({name:this.new_label,color:[255,255,255]}),this.new_label=""},change_color:function(t){this.editing_label=t},gen_color:function(t){var e=t.color;return"background-color: rgba(".concat(e[0],",").concat(e[1],",").concat(e[2],", 1)")},save:function(){var t=this;this.path_errors.length>0?alert("You need to fix the project's path before continuing."):confirm("Are you sure you want to continue?")&&(null==this.project.id?this.$post("/project/new",this.project).then((function(e){t.project=e,t.$emit("input",t.project),t.$emit("done","project")})).catch((function(t){alert(t)})):this.$post("/project/edit",this.project).then((function(e){t.project=e,t.$emit("input",t.project),t.$emit("done","project")})).catch((function(t){alert(t)})))},remove_label:function(t){var e=this;null==t.id?this.project.labels=this.project.labels.filter((function(e){return e!==t})):this.$post("/project/remove_label",t).then((function(){e.project.labels=e.project.labels.filter((function(e){return e.id!==t.id})),e.$emit("input",e.project)})).catch((function(t){return alert(t)}))}},mounted:function(){},props:["value"]},Je=Ye,Ke=(n("0eec"),n("03a4")),Ze=n("7679"),Qe=n("a844"),tn=Object(l["a"])(Je,qe,Xe,!1,null,"1aa8f24e",null),en=tn.exports;u()(tn,{VBtn:C["a"],VCard:V["a"],VCardActions:T["a"],VColorPicker:Ke["a"],VDataTable:M["a"],VEditDialog:Ze["a"],VIcon:j["a"],VMenu:mt["a"],VSpacer:Et["a"],VTextField:H["a"],VTextarea:Qe["a"]});var nn=n("7607"),an=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-text-field",{attrs:{label:"Task name"},model:{value:t.task.name,callback:function(e){t.$set(t.task,"name",e)},expression:"task.name"}}),n("v-select",{attrs:{label:"Project",chips:"",items:t.projects,"item-text":"name","item-value":"id"},model:{value:t.task.project_id,callback:function(e){t.$set(t.task,"project_id",e)},expression:"task.project_id"}}),t.folders.length>0?n("span",{staticClass:"grey--text text--darken-2 text-body-2",staticStyle:{"font-size":"10px"}},[t._v("Files from:")]):t._e(),n("v-treeview",{staticStyle:{"max-height":"300px","overflow-y":"auto"},attrs:{items:t.folders,selectable:"",dense:"","open-all":"","item-text":"name","item-value":"id","return-object":"",readonly:null==t.task.project_id,shaped:"",hoverable:"","selection-type":"independent"},scopedSlots:t._u([{key:"label",fn:function(e){var a=e.item;return[n("div",[t._v(t._s(a.name)+" ("+t._s(a.total)+" file(s), "+t._s(a.new)+" new files)")])]}}]),model:{value:t.task.folders,callback:function(e){t.$set(t.task,"folders",e)},expression:"task.folders"}}),t.folders.length>0?n("v-checkbox",{attrs:{label:"Only include new files"},model:{value:t.task.only_new,callback:function(e){t.$set(t.task,"only_new",e)},expression:"task.only_new"}}):t._e(),n("v-checkbox",{attrs:{label:"Group slides by name"},model:{value:t.task.group_slides,callback:function(e){t.$set(t.task,"group_slides",e)},expression:"task.group_slides"}}),n("v-select",{attrs:{label:"Divide between",chips:"",multiple:"",items:t.users,"item-text":"username","return-object":""},model:{value:t.task.assigned,callback:function(e){t.$set(t.task,"assigned",e)},expression:"task.assigned"}}),n("span",{staticClass:"grey--text text--darken-2 text-body-2",staticStyle:{"font-size":"10px"}},[t._v("Intersection: how many people should annotate each slide?")]),n("v-slider",{attrs:{label:"Intersection",min:1,max:t.totalIntersection,step:"1","thumb-label":"",ticks:"always","tick-size":"5"},model:{value:t.task.concurrent,callback:function(e){t.$set(t.task,"concurrent",e)},expression:"task.concurrent"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{outlined:""},on:{click:t.save}},[t._v("Continue")])],1)],1)},on=[],sn=n("3835"),rn=(n("ffc1"),{name:"TaskBatch",watch:{"task.project_id":function(t){null!=t&&this.load_folders(t)}},computed:{totalIntersection:function(){var t=this;return this.$nextTick((function(){t.task.concurrent=1})),null!=this.task.assigned?this.task.assigned.length:0}},data:function(){return{projects:null,users:null,folders:[],task:{name:"",project_id:null,assigned:[],folders:[],concurrent:1,only_new:!0,group_slides:!0}}},methods:{save:function(){var t=this;this.$post("task/new_batch",this.task).then((function(e){var n="";Object.entries(e.user_tasks).forEach((function(t){var e=Object(sn["a"])(t,2),a=e[0],i=e[1];n+="".concat(a," has ").concat(i," new tasks.\n")})),alert("Successfully created ".concat(e.new_tasks," new tasks.\n").concat(n)),t.$emit("done","task")})).catch((function(t){return alert(t)}))},load_projects:function(){var t=this;this.$get("project/list").then((function(e){t.projects=e})).catch((function(t){return alert(t)}))},load_users:function(){var t=this;this.$get("user/list").then((function(e){t.users=e})).catch((function(t){return alert(t)}))},load_folders:function(t){var e=this;this.$get("task/folders?project_id=".concat(t)).then((function(t){e.folders=t})).catch((function(){alert("Unable to locate the project's folder. Make sure the project is properly setup for the current environment.")}))}},mounted:function(){this.load_projects(),this.load_users()}}),ln=rn,cn=n("b974"),un=n("eb2a"),dn=Object(l["a"])(ln,an,on,!1,null,"1852a872",null),hn=dn.exports;u()(dn,{VBtn:C["a"],VCardActions:T["a"],VCheckbox:I["a"],VSelect:cn["a"],VSlider:bt["a"],VSpacer:Et["a"],VTextField:H["a"],VTreeview:un["a"]});var vn={name:"Admin",components:{TaskBatch:hn,TaskEditor:nn["a"],ProjectEditor:en,UserEditor:Ge},computed:{user:function(){return this.$store.state.user},tasksHeader:function(){var t=this;return[{text:"id",align:"start",sortable:!1,value:"id"},{text:"Slides",value:"slides"},{text:"Project",value:"project.name",filter:function(e){return null==t.taskFilter.project||0===t.taskFilter.project||e===t.taskFilter.project}},{text:"Annotators",value:"user_tasks",filter:function(e){return null==t.taskFilter.user||0===t.taskFilter.user||e.reduce((function(e,n){return null!=n.user?e||n.user.name===t.taskFilter.user:e||!1}),!1)}},{text:"Actions",value:"actions"}]}},data:function(){return{drawer:!1,mode:"user",is_editing:!1,editing:null,users:[],projects:[],tasks:[],taskFilter:{name:"",project:null,user:null},task_type:"annotations",config:{task_headers:{1:[{text:"id",align:"start",sortable:!1,value:"id"},{text:"Original task",value:"task"},{text:"To review",value:"revisions"},{text:"Users",value:"usertasks"},{text:"Actions",value:"actions"}]},user_headers:[{text:"id",align:"start",sortable:!1,value:"id"},{text:"Name",value:"name"},{text:"Username (login)",value:"username"},{text:"Is admin?",value:"is_admin"},{text:"Actions",value:"actions"}],project_header:[{text:"Project name",align:"start",sortable:!1,value:"name"},{text:"Description",value:"description"},{text:"Labels",value:"labels"},{text:"Actions",value:"actions"}]}}},methods:{done:function(t){switch(this.drawer=!1,this.editing=null,t){case"user":this.loadUsers();break;case"project":this.loadProjects();break;case"task":this.loadTasks();break;default:break}},openTask:function(t){var e=this;this.$post("session/create",t).then((function(t){e.$store.commit("set_session",t),e.$router.push("/session/".concat(t.id))})).catch((function(t){e.$toast.error("Oops, something went wrong:\n".concat(t.response.data.msg))}))},newUser:function(){this.editing={username:"",is_admin:!1,manages_apps:!1,manages_users:!1,manages_tasks:!1,manages_projects:!1,can_export:!1,access_overview:!1},this.mode="user",this.drawer=!0},newBatch:function(){this.mode="batch",this.drawer=!0},editUser:function(t){this.is_editing=!0,this.editing=t,this.mode="user",this.drawer=!0},removeUser:function(t){var e=this;confirm("Are sure you want to remove this user?")&&this.$get("user/remove?user_id=".concat(t.id)).then((function(){e.loadUsers()})).catch((function(t){return alert(t)}))},newProject:function(){this.editing={name:"",description:"",folder:"",labels:[]},this.mode="project",this.drawer=!0},editProject:function(t){this.is_editing=!0,this.editing=t,this.mode="project",this.drawer=!0},showLabelData:function(t){navigator.clipboard.writeText(JSON.stringify(t.labels))},newTask:function(){this.editing={name:"",type:0,slides:[],assigned:[]},this.mode="task",this.drawer=!0},editTask:function(t){this.is_editing=!0,this.editing=t,this.mode="task",this.drawer=!0},removeTask:function(t){var e=this;confirm("Are you sure you want to remove this task? Annotations may be lost.")&&this.$post("task/remove",t).then((function(t){console.log(t),e.loadTasks()})).catch((function(t){alert(t)}))},loadUsers:function(){var t=this;this.user.manages_users&&this.$get("user/list").then((function(e){console.log(e),t.users=e})).catch((function(t){alert(t)}))},loadProjects:function(){var t=this;this.user.manages_projects&&this.$get("project/list").then((function(e){console.log(e),t.projects=e})).catch((function(t){alert(t)}))},loadTasks:function(){var t=this;this.user.manages_tasks&&this.$get("task/management_list").then((function(e){t.tasks=e})).catch((function(t){return alert(t)}))},annotationTaskFiltering:function(t,e){return null!=t&&null!=e&&Array.isArray(t)&&t.some((function(t){return t.name.includes(e)}))}},mounted:function(){this.loadUsers(),this.loadProjects(),this.loadTasks()}},pn=vn,fn=n("cd55"),mn=n("49e2"),bn=n("c865"),gn=n("0393"),kn=n("3a2f"),wn=Object(l["a"])(pn,Ee,Oe,!1,null,"3cdf7b94",null),yn=wn.exports;u()(wn,{VBtn:C["a"],VCardActions:T["a"],VChip:D["a"],VChipGroup:F["a"],VCol:R["a"],VContainer:U["a"],VDataTable:M["a"],VExpansionPanel:fn["a"],VExpansionPanelContent:mn["a"],VExpansionPanelHeader:bn["a"],VExpansionPanels:gn["a"],VIcon:j["a"],VNavigationDrawer:Ct["a"],VRow:B["a"],VSpacer:Et["a"],VTab:Ve["a"],VTabs:Se["a"],VTextField:H["a"],VToolbar:Ae["a"],VToolbarTitle:Pe["b"],VTooltip:kn["a"]});var _n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app-bar",{attrs:{app:"",color:"primary",dark:"",dense:""}},["session"===t.$route.name?n("v-btn",{staticClass:"hidden-xs-only",attrs:{icon:""},on:{click:function(e){return t.$router.go(-1)}}},[n("v-icon",[t._v("mdi-arrow-left")])],1):t._e(),n("div",{staticClass:"d-flex align-center"},[n("v-img",{staticClass:"shrink mr-2",attrs:{alt:"Vuetify Logo",contain:"",src:"",transition:"scale-transition",width:"40"}}),n("v-toolbar-title",[t._v("WSI Annotation Tool")])],1),n("v-spacer")],1)},xn=[],Cn={name:"AppBar"},Vn=Cn,Tn=n("40dc"),Sn=n("adda"),jn=Object(l["a"])(Vn,_n,xn,!1,null,"2530140e",null),An=jn.exports;u()(jn,{VAppBar:Tn["a"],VBtn:C["a"],VIcon:j["a"],VImg:Sn["a"],VSpacer:Et["a"],VToolbarTitle:Pe["b"]});var Pn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app-bar",{attrs:{app:"",color:"primary",dark:""},scopedSlots:t._u([{key:"extension",fn:function(){return[n("v-tabs",{attrs:{"align-with-title":""}},[t.access_overview?n("v-tab",{attrs:{to:"/overview"}},[n("span",{staticStyle:{"font-weight":"300"}},[t._v("Overview")])]):t._e(),n("v-tab",{attrs:{to:"/tasks"}},[t._v("Tasks")]),t.manage_apps?n("v-tab",{attrs:{to:"/apps"}},[t._v("Apps")]):t._e(),t.can_export?n("v-tab",{attrs:{to:"/export"}},[t._v("Export")]):t._e(),t.is_admin?n("v-tab",{attrs:{to:"/admin"}},[t._v("Management")]):t._e()],1)]},proxy:!0}])},[n("v-toolbar-title",[t._v("WSI Annotation Tool")]),n("v-spacer"),n("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,i=e.attrs;return[n("v-card",t._g(t._b({staticClass:"user-card",attrs:{dark:"",flat:"",outlined:"",color:"primary lighten-1"}},"v-card",i,!1),a),[n("v-card-text",[n("v-icon",{staticClass:"mr-1"},[t._v("mdi-dots-vertical-circle")]),t._v("\n          "+t._s(t.user_name)+"\n        ")],1)],1)]}}])},[n("v-list",[n("v-list-item",{on:{click:function(e){t.changePassword=!0}}},[n("v-list-item-title",[t._v("Change password")])],1),n("v-divider"),n("v-list-item",{on:{click:t.logout}},[n("v-list-item-title",[t._v("Logout")])],1)],1)],1),t.changePassword?n("ChangePassword",{model:{value:t.changePassword,callback:function(e){t.changePassword=e},expression:"changePassword"}}):t._e()],1)},Ln=[],$n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{width:"300"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[n("v-card",[n("v-card-title",{staticClass:"text-h5 grey lighten-2"},[t._v("\n      Change password\n    ")]),n("v-card-text",[n("v-text-field",{attrs:{label:"New password",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:t.close}},[t._v("Cancel")]),n("v-btn",{attrs:{color:"primary",text:""},on:{click:t.submit}},[t._v("\n        Change password\n      ")])],1)],1)],1)},En=[],On={name:"ChangePassword",watch:{},data:function(){return{password:null}},methods:{close:function(){this.$emit("input",!1)},submit:function(){var t=this;this.$post("user/change_password",{password:this.password}).then((function(e){t.$emit("input",!1)})).catch((function(t){return alert(t)}))}},props:["value"]},In=On,Dn=n("169a"),Fn=Object(l["a"])(In,$n,En,!1,null,"a5269396",null),Rn=Fn.exports;u()(Fn,{VBtn:C["a"],VCard:V["a"],VCardActions:T["a"],VCardText:T["b"],VCardTitle:T["c"],VDialog:Dn["a"],VDivider:S["a"],VSpacer:Et["a"],VTextField:H["a"]});var Un={name:"AppBar",components:{ChangePassword:Rn},data:function(){return{changePassword:!1}},computed:{is_admin:function(){var t=this.$store.state.user;return t.manages_apps||t.manages_users||t.manages_tasks||t.manages_projects},can_export:function(){var t=this.$store.state.user;return t.can_export},access_overview:function(){var t=this.$store.state.user;return t.access_overview},manage_apps:function(){var t=this.$store.state.user;return t.manages_apps},user_name:function(){return this.$store.state.user.name}},methods:{logout:function(){this.$store.commit("logout"),this.$router.push("/login")}}},Mn=Un,Bn=(n("5310"),Object(l["a"])(Mn,Pn,Ln,!1,null,"73d20e91",null)),zn=Bn.exports;u()(Bn,{VAppBar:Tn["a"],VCard:V["a"],VCardText:T["b"],VDivider:S["a"],VIcon:j["a"],VList:ht["a"],VListItem:vt["a"],VListItemTitle:ft["d"],VMenu:mt["a"],VSpacer:Et["a"],VTab:Ve["a"],VTabs:Se["a"],VToolbarTitle:Pe["b"]}),a["a"].use(f["a"]);var Wn=new f["a"]({routes:[{path:"/",name:"home",component:function(){return n.e("chunk-3ea9ad1b").then(n.bind(null,"a55b"))}},{path:"/main",name:"main",components:{default:G,app_bar:zn},meta:{auth:!0}},{path:"/tasks",name:"tasks",components:{default:G,app_bar:zn},meta:{auth:!0}},{path:"/session/:session_id",name:"session",components:{default:$e,app_bar:An},meta:{auth:!0}},{path:"/admin",name:"admin",components:{default:yn,app_bar:zn},meta:{auth:!0,is_admin:!1}},{path:"/export",name:"export",components:{default:function(){return n.e("chunk-4e90b011").then(n.bind(null,"a415"))},app_bar:zn},meta:{auth:!0,is_admin:!1}},{path:"/overview",name:"overview",components:{default:function(){return n.e("chunk-47ab8f2f").then(n.bind(null,"959a"))},app_bar:zn},meta:{auth:!0}},{path:"/apps",name:"apps",components:{default:function(){return n.e("chunk-81d5d9f4").then(n.bind(null,"e082"))},app_bar:zn},meta:{auth:!0}},{path:"/login",name:"login",component:function(){return n.e("chunk-3ea9ad1b").then(n.bind(null,"a55b"))}}]});Wn.beforeEach((function(t,e,n){t.matched.some((function(t){return t.meta.auth}))?null==b.state.token?n({path:"/login",params:{nextUrl:t.fullPath}}):t.matched.some((function(t){return t.meta.is_admin}))?b.state.user.is_admin?n():n({name:"login"}):n():n()}));var Hn=Wn,Nn=n("f309"),Gn=n("fcf4");n("5363");a["a"].use(Nn["a"]);var qn=new Nn["a"]({theme:{icons:{iconfont:"mdi"},themes:{light:{primary:Gn["a"].blueGrey.darken3,secondary:Gn["a"].grey.darken1,accent:Gn["a"].orange.accent4,error:Gn["a"].red.accent3},dark:{primary:Gn["a"].blue.lighten3}}}}),Xn=n("0987"),Yn=n("bc3a"),Jn=n.n(Yn);a["a"].use(Xn["a"],{axios:Jn.a,config:{baseURL:"/api/"},interceptors:{beforeRequest:function(t,e){if(null!=b.state.token){var n=b.state.token;n&&(t.headers.Authorization="Bearer ".concat(n))}return t},beforeResponse:function(t,e){},beforeResponseError:function(t,e){t.statusCode}}});var Kn=Jn.a,Zn=n("9b40"),Qn=n.n(Zn);a["a"].use(Qn.a);var ta=Qn.a,ea=n("6c42"),na=(n("da96"),{position:ea["a"].BOTTOM_LEFT});a["a"].use(ea["b"],na),a["a"].config.productionTip=!1,new a["a"]({router:Hn,store:b,vuetify:qn,axios:Kn,split:ta,toast:void 0,render:function(t){return t(p)}}).$mount("#app")},5739:function(t,e,n){"use strict";n("b02f")},"5d15":function(t,e,n){},"73f3":function(t,e,n){},7607:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-text-field",{attrs:{label:"Task name"},model:{value:t.task.name,callback:function(e){t.$set(t.task,"name",e)},expression:"task.name"}}),n("v-select",{attrs:{label:"Project",chips:"",items:t.projects,"item-text":"name","item-value":"id"},model:{value:t.task.project_id,callback:function(e){t.$set(t.task,"project_id",e)},expression:"task.project_id"}}),n("v-tabs",{model:{value:t.task.type,callback:function(e){t.$set(t.task,"type",e)},expression:"task.type"}},[n("v-tab",{attrs:{disabled:null!=t.task.id||t.isAppContext}},[n("v-simple-checkbox",{attrs:{disabled:"",value:0===t.task.type}}),t._v("\n      User annotation\n    ")],1),n("v-tab",{attrs:{disabled:null!=t.task.id||t.isAppContext}},[n("v-simple-checkbox",{attrs:{disabled:"",value:1===t.task.type}}),t._v("\n      Revision\n    ")],1),n("v-tab",{attrs:{disabled:null!=t.task.id}},[n("v-simple-checkbox",{attrs:{disabled:"",value:2===t.task.type}}),t._v("\n      App annotation\n    ")],1)],1),null==t.task.id?n("v-tabs-items",{model:{value:t.taskType,callback:function(e){t.taskType=e},expression:"taskType"}},[n("v-tab-item",{attrs:{value:"annotation"}},[n("div",{staticStyle:{"overflow-y":"auto"}},[n("v-scroll-x-transition",{attrs:{group:"","hide-on-leave":""}},t._l(t.task.slides,(function(e,a){return n("v-chip",{key:a,staticClass:"ma-1",attrs:{color:"grey",dark:"",small:""}},[n("v-icon",{attrs:{left:"",small:""}},[t._v("\n              mdi-file\n            ")]),t._v("\n            "+t._s(e.name)+"\n          ")],1)})),1)],1),n("v-treeview",{staticStyle:{"max-height":"300px","overflow-y":"auto"},attrs:{items:t.files,selectable:"",dense:"","open-on-click":"","item-text":"name",readonly:null==t.task.project_id,"return-object":"",shaped:"",hoverable:"","selection-type":"leaf"},model:{value:t.task.slides,callback:function(e){t.$set(t.task,"slides",e)},expression:"task.slides"}})],1),n("v-tab-item",{attrs:{value:"revision"}},[n("v-select",{attrs:{label:"Tasks",items:t.reviewTaskList,"item-value":"id","item-text":"name","return-object":""},scopedSlots:t._u([{key:"item",fn:function(e){var a=e.item,i=e.on,o=e.attrs;return[n("v-list-item",t._g(t._b({staticClass:"fit-window",attrs:{"three-line":""}},"v-list-item",o,!1),i),[n("v-list-item-content",[""!==a.name?n("v-list-item-title",[t._v(t._s(a.name))]):n("v-list-item-title",[t._v("Annotation task number #"+t._s(a.id))]),n("v-list-item-subtitle",[t._v("Created: "+t._s(a.created))]),n("v-list-item-action-text",t._l(a.slides,(function(e){return n("span",{key:e.id,staticClass:"fake-chip"},[t._v(t._s(e.name))])})),0)],1),n("v-list-item-action",[n("v-simple-checkbox",{attrs:{disabled:"",value:o.inputValue,ripple:!1}})],1)],1)]}}],null,!1,742255232),model:{value:t.review_task,callback:function(e){t.review_task=e},expression:"review_task"}}),null!=t.task.task_id?n("v-select",{attrs:{label:"Annotator",items:t.review_task.user_tasks,"item-value":"id","item-text":"app.name",multiple:""},scopedSlots:t._u([{key:"item",fn:function(e){var a=e.item,i=e.on,o=e.attrs;return[n("v-list-item",t._g(t._b({staticClass:"fit-window",attrs:{"two-line":""}},"v-list-item",o,!1),i),[n("v-list-item-content",[n("v-list-item-title","app"in a?[t._v(t._s(a.app.name))]:[t._v(t._s(a.user.name))]),n("v-list-item-subtitle",[t._v(t._s(t.taskLabel[a.task.type])+" â¦ Created: "+t._s(a.created)+"\n              ")])],1),n("v-list-item-action",[n("v-simple-checkbox",{attrs:{disabled:"",value:o.inputValue,ripple:!1}})],1)],1)]}}],null,!1,1733673949),model:{value:t.task.revision,callback:function(e){t.$set(t.task,"revision",e)},expression:"task.revision"}}):t._e()],1)],1):t._e(),2===t.value.type?n("v-select",{attrs:{label:"Apps assigned",chips:"",multiple:"",items:t.apps,"item-text":"name","return-object":""},model:{value:t.task.assigned,callback:function(e){t.$set(t.task,"assigned",e)},expression:"task.assigned"}}):n("v-select",{attrs:{label:"Users assigned",chips:"",multiple:"",items:t.users,"item-text":"username","return-object":""},model:{value:t.task.assigned,callback:function(e){t.$set(t.task,"assigned",e)},expression:"task.assigned"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{outlined:""},on:{click:t.save}},[t._v("Continue")])],1)],1)},i=[],o=n("2ef0"),s=n.n(o),r={name:"TaskEditor",watch:{value:{immediate:!0,handler:function(t){this.task=s.a.cloneDeep(t)}},color_picked:function(t){this.editing_label.color=[t.rgba.r,t.rgba.g,t.rgba.b]},"task.project_id":function(t){null!=t&&(1===this.task.type?this.loadReviewTasks(t):this.loadFiles(t))},"task.type":function(t){1===t&&0===this.reviewTaskList.length&&this.loadReviewTasks(this.task.project_id)},review_task:function(t){this.task.task_id=t.id}},computed:{currentUser:function(){return this.$store.state.user},taskType:function(){return 0===this.task.type||2===this.task.type?"annotation":"revision"},isAppContext:function(){return 2===this.value.type}},data:function(){return{task:null,editing_label:null,new_label:null,users:[],apps:[],projects:[],files:[],reviewTaskList:[],review_task:[],taskLabel:{0:"Human annotation",2:"App annotation"}}},methods:{loadUsers:function(){var t=this;this.$get("user/list").then((function(e){t.users=e})).catch((function(t){return alert(t)}))},loadApps:function(){var t=this;this.$get("app/list").then((function(e){t.apps=e})).catch((function(t){return alert(t)}))},loadProjects:function(){var t=this;this.$get("project/list").then((function(e){return t.projects=e})).catch((function(t){return alert(t)}))},loadReviewTasks:function(t){var e=this;null!=t&&this.$get("project/tasks?project_id=".concat(t)).then((function(t){e.reviewTaskList=t})).catch((function(t){return alert(t)}))},save:function(){var t=this;null==this.task.id?this.$post("task/new",this.task).then((function(e){t.task=e,t.$emit("input",e),t.$emit("done","task")})).catch((function(t){alert(t)})):this.$post("task/edit",this.task).then((function(e){t.task=e,t.$emit("input",e),t.$emit("done","task")})).catch((function(t){alert(t)}))},loadFiles:function(t){var e=this;this.$get("task/files?project_id=".concat(t)).then((function(t){e.files=t})).catch((function(){alert("Unable to locate the project's folder. Make sure the project is properly setup for the current environment.")}))}},mounted:function(){this.loadProjects(),this.isAppContext?this.loadApps():this.loadUsers(),null!=this.task.project&&this.loadFiles(this.task.project.id)},props:["value"]},l=r,c=(n("e512"),n("2877")),u=n("6544"),d=n.n(u),h=n("8336"),v=n("99d9"),p=n("cc20"),f=n("132d"),m=n("da13"),b=n("1800"),g=n("5d23"),k=n("0789"),w=n("b974"),y=n("9e88"),_=n("2fa4"),x=n("71a3"),C=n("c671"),V=n("fe57"),T=n("aac8"),S=n("8654"),j=n("eb2a"),A=Object(c["a"])(l,a,i,!1,null,"20cb6312",null);e["a"]=A.exports;d()(A,{VBtn:h["a"],VCardActions:v["a"],VChip:p["a"],VIcon:f["a"],VListItem:m["a"],VListItemAction:b["a"],VListItemActionText:g["a"],VListItemContent:g["b"],VListItemSubtitle:g["c"],VListItemTitle:g["d"],VScrollXTransition:k["f"],VSelect:w["a"],VSimpleCheckbox:y["a"],VSpacer:_["a"],VTab:x["a"],VTabItem:C["a"],VTabs:V["a"],VTabsItems:T["a"],VTextField:S["a"],VTreeview:j["a"]})},"9d34":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isLoading?n("div",[n("v-progress-circular",{staticClass:"loading",attrs:{indeterminate:!0,size:"52"}})],1):n("div",[n("v-fade-transition",[t._t("default")],2)],1)])},i=[],o={name:"LoadingContent",watch:{loading:function(){}},props:["isLoading"]},s=o,r=(n("a500"),n("2877")),l=n("6544"),c=n.n(l),u=n("0789"),d=n("490a"),h=Object(r["a"])(s,a,i,!1,null,"320d1016",null);e["a"]=h.exports;c()(h,{VFadeTransition:u["d"],VProgressCircular:d["a"]})},a2b5:function(t,e,n){},a500:function(t,e,n){"use strict";n("edb9")},a522:function(t,e,n){},b02f:function(t,e,n){},bbd4:function(t,e,n){"use strict";n("5d15")},d611:function(t,e,n){},e25d:function(t,e,n){"use strict";n("73f3")},e512:function(t,e,n){"use strict";n("374d")},edb9:function(t,e,n){}});
//# sourceMappingURL=app.4f4e464b.js.map